[
    {
        "id": "2c4527dad914ec1c",
        "type": "tab",
        "label": "Flow 4",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "fca036ab5aa23301",
        "type": "subflow",
        "name": "Retrieve Settings",
        "info": "Retrieve an automation configuartaion object attachment from vault, or from Redis if alread exist, if not existing, it will be stored in Redis. \r\n\r\n### Node information\r\n:Initial Release (string): With building blocks version x.x.x\r\n:Description (string): Retrieve an automation configuartaion object attachment from vault, or from Redis if alread exist, if not existing, it will be stored in Redis. \r\n\r\n### Inputs\r\n: args.settings_name (string) : *(optional)* the name of the automation configuartaion object in vault, if not provided, the name '-client_id-__settings' will be used. \r\n: args.attachment_name (string) : *(optional)* the name of the object attachment in vault, it has to be a .json file, defaults to 'settings.json'. \r\n: args.keep (boolean) : *(optional)* If **false**, delete the args object. Defaults to **false**.\r\n: args.expire (integer): *(optional)* Number of seconds after redis deletes the topic automatically. Default is 24h.\r\n\r\n### Outputs\r\n1. Success\r\n: payload (object): attachment converted to an object/array\r\n\r\n1. Failure\r\n: payload (object): Error message on channel 2\r\n",
        "category": "Veeva Vault",
        "in": [
            {
                "x": 140,
                "y": 40,
                "wires": [
                    {
                        "id": "641eac4e6a3a1072"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 1800,
                "y": 480,
                "wires": [
                    {
                        "id": "9ffbd2aa8e3b35c4",
                        "port": 0
                    },
                    {
                        "id": "2fa9a7a10b10782e",
                        "port": 0
                    }
                ]
            },
            {
                "x": 1410,
                "y": 380,
                "wires": [
                    {
                        "id": "434ac0347080cde9",
                        "port": 0
                    },
                    {
                        "id": "80dbe2c3859434ef",
                        "port": 1
                    },
                    {
                        "id": "74e13d47f28fa1de",
                        "port": 1
                    },
                    {
                        "id": "bd54ec6a24f9d859",
                        "port": 1
                    },
                    {
                        "id": "e20436251156a60f",
                        "port": 1
                    }
                ]
            }
        ],
        "env": [],
        "meta": {},
        "color": "#ff0000",
        "inputLabels": [
            "get settings"
        ],
        "outputLabels": [
            "Success",
            "Error"
        ],
        "icon": "node-red/white-globe.svg"
    },
    {
        "id": "281da2542719f7ce",
        "type": "group",
        "z": "fca036ab5aa23301",
        "name": "get settings from vault",
        "style": {
            "fill": "#ffcf3f",
            "label": true,
            "color": "#777777",
            "label-position": "n"
        },
        "nodes": [
            "f2e66c06b9a9ba35",
            "3cba36dbc4be0431",
            "781204f40703ed7f",
            "bd54ec6a24f9d859",
            "74e13d47f28fa1de",
            "80dbe2c3859434ef",
            "862007a1a92de19b"
        ],
        "x": 154,
        "y": 339
    },
    {
        "id": "65512d829ddbe85d",
        "type": "group",
        "z": "fca036ab5aa23301",
        "name": "get settings from Redis",
        "style": {
            "fill": "#ffcf3f",
            "label": true,
            "label-position": "n",
            "color": "#777777"
        },
        "nodes": [
            "e20436251156a60f",
            "6adaa8b423a4321e",
            "78aa02b86a2d9b5f"
        ],
        "x": 1414,
        "y": 99
    },
    {
        "id": "a6858237518cf424",
        "type": "group",
        "z": "fca036ab5aa23301",
        "name": "get settings from Redis",
        "style": {
            "fill": "#ffcf3f",
            "label": true,
            "label-position": "n",
            "color": "#777777"
        },
        "nodes": [
            "be87b21f1e94e2d6",
            "c0e33d0da64adf97"
        ],
        "x": 354,
        "y": 599
    },
    {
        "id": "5cb21f050c83cc23",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "name": "Check validity of clinical study",
        "style": {
            "fill": "#bfdbef",
            "label": true
        },
        "nodes": [
            "a517c1b0a121cedf",
            "693756c6498c6064",
            "49eb745f3bb556d7",
            "3b9b516158e5b5ca",
            "ebb6d32d70665548",
            "b1e1d0d513bdc894",
            "fcbe9239c8f72a8e",
            "0127f053a5094720",
            "85e16222f1b56109",
            "dd5017ae345409f1",
            "043679803e3a392d",
            "98dd3ac1f755be79",
            "335fcea11de055ae",
            "8e5e730adeea5aeb",
            "51eb3208af5c0b09",
            "89a16e05d4f19578",
            "368b275432ecdd54",
            "2dc749a6c210d478",
            "813577ca6cd07706",
            "7774dedcb5b66602",
            "352fd2a78633d9f0",
            "2d2764e208e07b3f",
            "de90f54e9cfbe425",
            "5c9328793e731c8d",
            "eb06ff6916e786d3",
            "5425c39838e432cb",
            "a4a20ebaa9e237b1"
        ],
        "x": 74,
        "y": 439,
        "w": 2752,
        "h": 282
    },
    {
        "id": "cc69f3c6d7a0efd8",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "name": "Show a generic error message",
        "style": {
            "fill": "#ffbfbf",
            "label": true
        },
        "nodes": [
            "a1d7e010334dfdd3",
            "9bf2c6f4a4bfc009",
            "436ac70a6529bbc6",
            "f0446d193facd28b"
        ],
        "x": 4464,
        "y": 419,
        "w": 402,
        "h": 122
    },
    {
        "id": "3b39a3f38c602820",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "name": "Show success message",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "ca194580f21c446e",
            "5acffab548a35a4a",
            "48174a72055dc276"
        ],
        "x": 4464,
        "y": 579,
        "w": 402,
        "h": 82
    },
    {
        "id": "8ffde65bf97cdec9",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "name": "Prepare the result page",
        "style": {
            "fill": "#bfdbef",
            "label": true
        },
        "nodes": [
            "0d4182935183bc90",
            "2c2566f1bea190a3",
            "86ee4f73d33b2cca",
            "1ae64553ab7b98e3",
            "259cfda023e9be5c",
            "866360cc841435a0",
            "076fced8d83c5435",
            "5aa39461a59b8a2f",
            "fa6ada68c3d3e566",
            "77f5ccfb8132526a",
            "fd26333c22246f71",
            "de414146dc5df955",
            "40d3110f8d98116f",
            "84a715c3efb3a6de",
            "e20de456532ccc89",
            "e46f1d0bcbc89a13",
            "68fbeedcf9e499c6",
            "2709756b3f657fa4"
        ],
        "x": 3074,
        "y": 199,
        "w": 1292,
        "h": 322
    },
    {
        "id": "b75f5f55f3053983",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "name": "Amendment Event",
        "style": {
            "label": true
        },
        "nodes": [
            "9a07594d93225bc8",
            "3b470881f25ba564",
            "5efd74cfedb4bd1b",
            "bc189a0f67043a81",
            "5ea516a7f15262e5"
        ],
        "x": 68,
        "y": 2339,
        "w": 1138,
        "h": 1108
    },
    {
        "id": "d938d1252258762c",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "name": "Initial Event",
        "style": {
            "label": true
        },
        "nodes": [
            "e4dc8a0d3b3cb6f8",
            "29b43c9507b8a9bc"
        ],
        "x": 68,
        "y": 993,
        "w": 1024,
        "h": 994
    },
    {
        "id": "ca1016782fddaa02",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "name": "Application",
        "style": {
            "label": true
        },
        "nodes": [
            "7352d6de44d315d8",
            "2e5e59eac091f6b6",
            "44e871b1bae7c620",
            "418698a9468db53e",
            "60c0de94d312a065",
            "d022bdeaa8a97155",
            "f976c52a47cce42e"
        ],
        "x": 1268,
        "y": 993,
        "w": 1764,
        "h": 2594
    },
    {
        "id": "4cdbc47d14deae5f",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "name": "Records",
        "style": {
            "label": true
        },
        "nodes": [
            "f518aa9a70a561ce",
            "0df38016a1f72175",
            "eae4020013fd9b1d",
            "afea13b5e3ace5ed",
            "09f07fe60c2f6cb9",
            "71f7e671c4f7b57b",
            "af1996fdf68f3807",
            "035c0891e0dd692a",
            "84672330f380c95e",
            "7a3d292b917621ed"
        ],
        "x": 3088,
        "y": 753,
        "w": 1164,
        "h": 2608
    },
    {
        "id": "49afa798aa000027",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "name": "Main stem",
        "style": {
            "fill": "#bfdbef",
            "label": true
        },
        "nodes": [
            "7522c7b5aec3a9ef",
            "01e20530c1d676df",
            "cf3a900eaa9fb293",
            "53b94d493d8aebd4",
            "176b5b4f886480f6",
            "c48a56058ff8c72f",
            "85e74d8cb43654c6",
            "492708f4a2a8a23b",
            "d93fbd5a33448866",
            "fbcefa411dd50a96",
            "d06919b14c6d2aa7",
            "a533a86988712f6d",
            "ea5cf472d18d5375",
            "de9853d067d8ce97",
            "ca49939d7d804fb3",
            "0b9aad679584a3b8",
            "808d87219cabb093",
            "91bbab557e0bc067",
            "bcd13a4e57099bd1",
            "df6e3632b0e19e34",
            "8cf33d612efacd67",
            "42678083ebcac3d6"
        ],
        "x": 74,
        "y": 739,
        "w": 2952,
        "h": 222
    },
    {
        "id": "9a07594d93225bc8",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "g": "b75f5f55f3053983",
        "name": "Create new clinical study event",
        "style": {
            "fill": "#ffffbf",
            "label": true,
            "stroke": "#6f2fa0"
        },
        "nodes": [
            "7bdbda2743cdc6b5",
            "7975a53c4a64c4da",
            "5e4ca652c9e4bf6b",
            "327f99f807c82926",
            "9bfc6b2d877fd930",
            "a1297a352376667d",
            "489e682a3e118466",
            "45fc8bba6e75e18b",
            "4664de213928f6b8",
            "aa587593b012a0d6",
            "df24c6a33ef0144c",
            "a24a9fbdc9572faf",
            "071f93addb1baef2",
            "2491f8f69e4cd706",
            "fb8967fe1e37119e",
            "48d5f5daef40767e",
            "31951ddedb788c4a",
            "6c0b1489b79ec564",
            "a190aec9e9613a5f",
            "be22f772ce8a3b54",
            "341d47cf0b2b0cce",
            "121f746a467d7985",
            "34a488a3f7a19293",
            "ea4a5eff2a90f692",
            "2c3f6e2ddb32d519",
            "b6b8561265ea31aa",
            "6067cc6e280611b2",
            "63f8ad143cc0ddef",
            "62ade5ae7fc90b87",
            "7743178ec513f855",
            "a9fd5e372d44bf21",
            "873c396f5e7b7dad",
            "01db86a06b72aa5d",
            "ec3bd062de3892df",
            "4caa4b440eecd699",
            "1044ed1feb065477",
            "f38c2e7c333e26c6",
            "87365503757eef58",
            "40cc101214fab216",
            "c6a48fc906ea7961",
            "aff0aca1f43e6a27",
            "7ffc6c3c390efdf3",
            "947f65204f9bce09",
            "0721deac26607746",
            "5a7cadee10bd1fd2"
        ],
        "x": 94,
        "y": 2639,
        "w": 1072,
        "h": 782
    },
    {
        "id": "3b470881f25ba564",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "g": "b75f5f55f3053983",
        "name": "Select Event Keyword",
        "style": {
            "fill": "#ffffbf",
            "label": true,
            "stroke": "#6f2fa0"
        },
        "nodes": [
            "ee4366403c02b6ed",
            "d22e8bdb48ca67c9",
            "7824fdd12ef9b926",
            "912a8a51ff9bea31"
        ],
        "x": 94,
        "y": 2379,
        "w": 662,
        "h": 82
    },
    {
        "id": "5efd74cfedb4bd1b",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "g": "b75f5f55f3053983",
        "name": "Provide Event information",
        "style": {
            "stroke": "#6f2fa0",
            "fill": "#ffffbf",
            "label": true
        },
        "nodes": [
            "2d28b95c057acbd6",
            "16a15a22a3ecac4f",
            "5d11ec05b66d8579",
            "b056ee42124d34cb",
            "7d376e89c7e53d97",
            "af4d16bd22a40964",
            "6b76d854d26061fe",
            "822cec06c5fb841a",
            "5b5a5ba5cb51ccd9",
            "50f1ed09b27bed3a"
        ],
        "x": 94,
        "y": 2479,
        "w": 972,
        "h": 142
    },
    {
        "id": "e4dc8a0d3b3cb6f8",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "g": "d938d1252258762c",
        "name": "Create new clinical study event",
        "style": {
            "fill": "#ffffbf",
            "label": true
        },
        "nodes": [
            "1565440b12069ef1",
            "a0c278bd43c9d392",
            "16dd3361eb7ce0d4",
            "9adfccf7b2b56294",
            "a29d31f087a5e74f",
            "b87bf7a4c50d663b",
            "e610822d0af072be",
            "31e1f21fd3dbad06",
            "65ae0fe8fc738277",
            "4dac18d979dde774",
            "dc369b349e727f46",
            "704b19538a23bbbb",
            "646de72917b2e936",
            "275ebe4c83353954",
            "937cbb9741f463b9",
            "610d6bcf4d082900",
            "7bc4c9683b8274bc",
            "4838544d636b8126",
            "ae93614e24ba3a56",
            "6a93ae39ab073d95",
            "d5d703ab75216ed7",
            "9003a9eb57a9aa3d",
            "d021c864dee5eecb",
            "9a46815ed62743f5",
            "ce48537993842d01",
            "487be070f2dc5c9a",
            "eedb0e85cc43d225",
            "cc2dec68746a7c48",
            "d890c02a1874a2e0",
            "7dcf8f4baa80652e",
            "823a1fc8bdd1a3e5",
            "346e9d801d1ffa8d",
            "adee49dc044bbea2",
            "93a845c0a3f44c59",
            "19b50a4a81355f3d",
            "7773a63cbb806d65",
            "30c274e5bbd50f08",
            "38b9bfcbd809e815",
            "37fc862475dbce73"
        ],
        "x": 94,
        "y": 1239,
        "w": 972,
        "h": 722
    },
    {
        "id": "29b43c9507b8a9bc",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "g": "d938d1252258762c",
        "name": "Check for existing CTA Application Event",
        "style": {
            "fill": "#ffffbf",
            "label": true
        },
        "nodes": [
            "e7d6fc8ca841fa9a",
            "70ab23a321437933",
            "56e9c9847f31a328",
            "f78035f60f3dfdc7",
            "f75af9837491f17f",
            "327e267911d56ed7",
            "d246955bc53f98dd",
            "2661afcec2409879",
            "f82b3ab5ecb10577",
            "b33b1728cfa4f937"
        ],
        "x": 94,
        "y": 1019,
        "w": 952,
        "h": 182
    },
    {
        "id": "7352d6de44d315d8",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "g": "ca1016782fddaa02",
        "name": "Create Applications",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "79dc00f87e370be6",
            "a3ca3e44e6958337",
            "1b36f753f30929bb",
            "bf78181027710cc5",
            "fce32955635296b4",
            "9715c1f72c64ad49",
            "a21a1989e6a49e7e",
            "163b00cb684085db",
            "a81a36e30b94e259",
            "c6b211f4e9d6c341",
            "32afb23ea52e48e9",
            "1ec6cfe34db7d431",
            "27b2616ea773d52f",
            "8ab0417a5926e9fd",
            "3b7cad86dd37a146",
            "3d7304f437ac546e",
            "3a8ebaf7d483bbd4",
            "23738ff3d5c6de63",
            "193a81253fe4730e",
            "eead4d84f542e524",
            "42452a39b395d8e8"
        ],
        "x": 1294,
        "y": 2899,
        "w": 972,
        "h": 382
    },
    {
        "id": "2e5e59eac091f6b6",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "g": "ca1016782fddaa02",
        "name": "Checking if include EU CTR",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "c4148dbf29ced4c0",
            "598037ac92ad64cd",
            "23bdf07343944511"
        ],
        "x": 1294,
        "y": 1019,
        "w": 412,
        "h": 82
    },
    {
        "id": "44e871b1bae7c620",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "g": "ca1016782fddaa02",
        "name": "Collect Information",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "63be4dd09ce5c341",
            "b0fc88afbb33c1a0",
            "0315c803b9a7cf50",
            "72026368a96a09a2",
            "3206f3c1f1e0735a",
            "b40c9dba22cbc868",
            "308ce12f61ee6030",
            "4cae53dc94434e4e",
            "2d0f771410e3e36a",
            "cae06e1193aaaf99",
            "fcf74b442ee22766",
            "2bd9708f4077eae8",
            "814b7282a5575644",
            "0afe761b64cbb329",
            "a2e04219e8b4b9cb",
            "3da61cdc6873fd1f",
            "36dc00761631f425",
            "f40586315f069e51",
            "639144debba161a8",
            "ac3c2bcf8dcd4883",
            "aaf9d1d169a58400",
            "c51f3bb8d2848e6b",
            "a1af548a44f34861",
            "45d0215e41dff0ab",
            "e7f0fb926f966d3e",
            "60b9429f386a55ca",
            "095f93b72d3bf820",
            "d304a0fb3ea8a5d8",
            "1d26e25a22ede841",
            "4fb49a8801532b08",
            "e34086576e2a64ad",
            "692cec66a76c12c1",
            "235a0c53b800fc4a",
            "97b21bfa8be4c5b6"
        ],
        "x": 1294,
        "y": 2339,
        "w": 1712,
        "h": 522
    },
    {
        "id": "418698a9468db53e",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "g": "ca1016782fddaa02",
        "name": "CTR process - Select non-CTR countries",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "c3b45f5d98bdac5d",
            "07ba54e9b76ea2dd",
            "5033a94f248d3ec6",
            "cb792cb3a882cf6d",
            "5323f5fa282e6d4b",
            "fd754c253fa76273",
            "2c718837889be13f",
            "35dad220fe453b94",
            "916991213130f0b6",
            "c4a455daa0eea8b3",
            "9f8e098d2849aa2f",
            "489f4664c01b7352",
            "687bcf3e9aa2c2a3",
            "027533d7f1212d3e",
            "dbb7083b5406891f",
            "10480a94b49c21f4",
            "e521a704d9bac1ab",
            "af1cd65bf3bafe37",
            "f1fb0ef678bfce17",
            "728887161d445a67",
            "679b90afc5ef4d8b",
            "1a581b37f886fe19",
            "690a1796de0e6d1c",
            "92e9f14f2867eaf7",
            "00dd4fbe51c029e6",
            "7f713bd2df926ab1",
            "d7314dc8efb4b0a3",
            "e810c2f13748f253",
            "a62e4b4d64a2b9b2",
            "ade26af0922ee143",
            "2e23ebd064472974",
            "b351bb84c353b4f3",
            "6d6502cd1def83cd",
            "d87f178a0e39e5be",
            "278b0710d6e4d674",
            "a1d0dd4eb8365192",
            "9a6e0cbda2147e1e",
            "dfb12041a0a66a3c",
            "c99b838874d141cd",
            "dd550a90dd0aabaf",
            "7c371cb10c3dab09"
        ],
        "x": 1294,
        "y": 1739,
        "w": 1492,
        "h": 562
    },
    {
        "id": "60c0de94d312a065",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "g": "ca1016782fddaa02",
        "name": "CTR process - Select CMS Countries",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "18d6266e97652570",
            "2e16cd83e26cf93b",
            "2ff139f4915e9a83",
            "7a194ad4e9fa1f04",
            "a59b352152a16d6f",
            "304f15172a2493b6",
            "988426700c3ab4eb",
            "57b954a69cdbd921",
            "663e76bf01799be3",
            "4f9b3e39b40d256e",
            "0e71c22f3b4b309f",
            "356e2e4aa54252a7",
            "b2c64e99abb28c30",
            "2d30c6c52c634f2a",
            "3d0d6dbcadc450d6",
            "5872a89cd3958fcb",
            "66c25bf8b0a1edfb",
            "1acfb51d07c7fe8e",
            "d202e1e3c2ad80ff",
            "9f4f0222088f8ec7",
            "ffcfb0bd8992cab7",
            "e08539a4baec5868",
            "7c0dc3c51543f672",
            "d1d77c14b8aa7c78",
            "310f410bd28e250a",
            "1e7595e74b058c3c",
            "8201c8fc8cfddd57",
            "1e058dc04b758acf",
            "dd8842491a14509c",
            "13ad1b3d246764f1",
            "89c781ac52c22d3d",
            "2fb8da2f7b5e1265",
            "a3128ebd4788fce9"
        ],
        "x": 1294,
        "y": 1139,
        "w": 972,
        "h": 562
    },
    {
        "id": "d022bdeaa8a97155",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "g": "ca1016782fddaa02",
        "name": "Create Application Country",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "a68c76b15e9cc5dc",
            "2095eca2c9c73c2f",
            "c20b83ab768b1d3d",
            "2ebc5c6d445f1138",
            "d3669aac99d1ad97",
            "494215724b71c2d7",
            "0f1be22b10561660",
            "31d9f9d15f809871",
            "e2f80f1e3a501d9e",
            "84d87af5ca62f986",
            "bc49ae6168ab21da",
            "4a2521f6e1a32aa0",
            "f3538e4adcf2f613",
            "107176c9638961b0",
            "766d56d483547360"
        ],
        "x": 1294,
        "y": 3299,
        "w": 1312,
        "h": 262
    },
    {
        "id": "f518aa9a70a561ce",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "g": "4cdbc47d14deae5f",
        "name": "Create Submission",
        "style": {
            "fill": "#ffefbf",
            "label": true
        },
        "nodes": [
            "baa39c9826af5348",
            "180f74906abb7521",
            "db38931e34bfc13a",
            "09a3f28a35c4d5e6",
            "74be9745ad928e34",
            "ad1b1ab7c19ca46d",
            "e1cecc09636022ad",
            "db85d39043815280",
            "6e735561c94ccedb",
            "2a42318059e84be7",
            "6561ba05eaa91b22",
            "ef9e020dec7062f3",
            "5bda67103104bddb",
            "ec17eea9c45882f3",
            "eeb32648b97425e0",
            "3ad0cdaa497c315c",
            "8a04922b90e546e5",
            "faa088213b8d2f54",
            "10d4268fac032ef1",
            "73fa0facac6f8e60",
            "e5249b72892316bd",
            "02b89b06ff195d34",
            "9b5b756c6ca7dc41",
            "4b560aeae3c9a651",
            "d18d6a3d80664269",
            "375b947dcc80bda2",
            "2aef3a8d44b39a07",
            "cbbe0423aa35ad06",
            "53ec9ab2b97056b3",
            "92969b844dd98f0b",
            "fe469cda521e677d",
            "afb83f43f91551d8",
            "1cbce160e8451deb",
            "9b5bae8c51d70c5a",
            "edc809786ffa0b67",
            "0767c20240345f23",
            "6f018798efc57d12",
            "cf91e0058e911558",
            "329af6459c29bdd3",
            "b723c70ffd5fc20e"
        ],
        "x": 3134,
        "y": 1999,
        "w": 912,
        "h": 702
    },
    {
        "id": "0df38016a1f72175",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "g": "4cdbc47d14deae5f",
        "name": "Select Applications",
        "style": {
            "fill": "#ffefbf",
            "label": true,
            "stroke": "#a4a4a4"
        },
        "nodes": [
            "815b898da7348084",
            "5f5d749dad848b0c",
            "745032eae74c14c6",
            "712ffb860c3a2037",
            "909b262a20993c68",
            "d45c685b21e8a671",
            "a2e99079f9ca0f1b",
            "f0176fb78a6cd5e9",
            "1687742a6fc86431",
            "088e67f8e8199ab2",
            "6c5cc9ddbed9c5b0",
            "7556bdfbf0946221",
            "6d25602125fc0b18",
            "87df2f5923908545",
            "2e3e4bf8b0f2a1b8",
            "731bc14a2469e6c6",
            "c18fb9326edc6329",
            "6a4f3e9952067b39",
            "4b3c6d71655f890e",
            "5d39cd3c146c924a",
            "621d2ba2e014840a",
            "949d5ad057e1e261",
            "e42a0766e2bc818b",
            "f3e585d38bc8703d",
            "13116165a53789dd",
            "279388131d7257e3",
            "9e1fc759e2fe5655"
        ],
        "x": 3114,
        "y": 1399,
        "w": 982,
        "h": 522
    },
    {
        "id": "eae4020013fd9b1d",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "g": "4cdbc47d14deae5f",
        "name": "Select Event",
        "style": {
            "fill": "#ffefbf",
            "label": true,
            "stroke": "#a4a4a4"
        },
        "nodes": [
            "be24b3c797804fe1",
            "fe308079eefb7a9b",
            "75c51310d6a882bf",
            "8f63b44e74d15330",
            "48f15fdaeaa7032b",
            "7b8c39ac1a2cccea",
            "94f0820b14a9161b",
            "37b555ad14ef12a6",
            "559064536dec3b73",
            "4acf0be56211cf62",
            "ec65684c71962ec3",
            "b6f857a48f7b4794",
            "a06de76f609e4c23",
            "4f9a931fc37b7bd0",
            "5679cefc989d62b5",
            "3fcec1e30ff78f0a",
            "bbc02f3b1ab31c1d",
            "1c04bc0a1b81ef45"
        ],
        "x": 3114,
        "y": 779,
        "w": 1112,
        "h": 282
    },
    {
        "id": "afea13b5e3ace5ed",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "g": "4cdbc47d14deae5f",
        "name": "Select RO Type",
        "style": {
            "fill": "#ffefbf",
            "label": true,
            "stroke": "#a4a4a4"
        },
        "nodes": [
            "ee42cdd847608b8e",
            "5e739d5310677788",
            "d212fd55d6eb1f45",
            "3ad05764e71aaecd",
            "2f7502d21fcdd942",
            "9ddf0b394c30ebf5",
            "df3121b89215a09c",
            "1b6e37da8454b220",
            "7886df4b5fe256f2",
            "b156a7d9df56630a",
            "96a581392456dd7e",
            "dcdcab2d3a93e4dd",
            "34829d07d935abec",
            "3adece1ebc8ee643",
            "4478fbc938fa0963"
        ],
        "x": 3114,
        "y": 1099,
        "w": 1072,
        "h": 242
    },
    {
        "id": "af1996fdf68f3807",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "g": "4cdbc47d14deae5f",
        "name": "Create Regulatory Objective",
        "style": {
            "fill": "#ffefbf",
            "label": true
        },
        "nodes": [
            "9de4de9264b9a65d",
            "acd4cce99dbe8a5c",
            "3b26a3db4270484e",
            "153a78ac51558834",
            "d8af64ecc1be1919",
            "a9d63e694c8d9d4c",
            "c0f85b4e811b690d",
            "7dc55a7434381ac6",
            "615be9c29aeb9f2a",
            "776056a1428904bd",
            "43289b9ac83571d2",
            "659c0e50730e044a",
            "e974785e628c969c",
            "e4385ff11def9dd6",
            "f09971b834b30d9b",
            "e47135f7f278a7aa",
            "5fae1149cd1a09ff",
            "bcf54a7297050edb",
            "13d22eaf8330299c",
            "a4b95f67c34a39d5",
            "be22b1d3f5feb681",
            "9cebbaf0235b3380",
            "37ab62b5076f66a9",
            "b4ad71faf47753af",
            "6ac114583415268d",
            "54b51c9ab87013f5",
            "b7477ad69b72790b",
            "4528b12e1949518c"
        ],
        "x": 3134,
        "y": 2739,
        "w": 872,
        "h": 502
    },
    {
        "id": "f2e66c06b9a9ba35",
        "type": "change",
        "z": "fca036ab5aa23301",
        "g": "281da2542719f7ce",
        "name": "get automation configuration settings object id",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"SELECT id, name__v\"\t&\" FROM automation_configuration__c\" \t&\" WHERE name__v = '\"\t& args_sub.settings_name\t&\"' AND status__v = 'active__v'\"\t",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 360,
        "y": 380,
        "wires": [
            [
                "bd54ec6a24f9d859"
            ]
        ]
    },
    {
        "id": "3cba36dbc4be0431",
        "type": "change",
        "z": "fca036ab5aa23301",
        "g": "281da2542719f7ce",
        "name": "prepare request attachments",
        "rules": [
            {
                "t": "set",
                "p": "args.object_name",
                "pt": "msg",
                "to": "automation_configuration__c",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "args.object_record_id",
                "pt": "msg",
                "to": "payload.data[0].id",
                "tot": "msg",
                "dc": true
            },
            {
                "t": "set",
                "p": "args.keep",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 300,
        "y": 440,
        "wires": [
            [
                "74e13d47f28fa1de"
            ]
        ]
    },
    {
        "id": "781204f40703ed7f",
        "type": "change",
        "z": "fca036ab5aa23301",
        "g": "281da2542719f7ce",
        "name": "Set attachments to attachment_name",
        "rules": [
            {
                "t": "set",
                "p": "args.attachment_id",
                "pt": "msg",
                "to": "payload.data[filename__v=$$.args_sub.attachment_name].id",
                "tot": "jsonata",
                "dc": true
            },
            {
                "t": "set",
                "p": "args.keep",
                "pt": "msg",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 330,
        "y": 500,
        "wires": [
            [
                "80dbe2c3859434ef"
            ]
        ]
    },
    {
        "id": "bd54ec6a24f9d859",
        "type": "brave-vql-query",
        "z": "fca036ab5aa23301",
        "g": "281da2542719f7ce",
        "name": "",
        "x": 830,
        "y": 380,
        "wires": [
            [
                "3cba36dbc4be0431"
            ],
            []
        ]
    },
    {
        "id": "74e13d47f28fa1de",
        "type": "brave-retrieve-object-record-attachments",
        "z": "fca036ab5aa23301",
        "g": "281da2542719f7ce",
        "name": "",
        "x": 900,
        "y": 440,
        "wires": [
            [
                "781204f40703ed7f"
            ],
            []
        ]
    },
    {
        "id": "80dbe2c3859434ef",
        "type": "brave-download-object-record-attachment-file",
        "z": "fca036ab5aa23301",
        "g": "281da2542719f7ce",
        "name": "",
        "x": 920,
        "y": 500,
        "wires": [
            [
                "862007a1a92de19b"
            ],
            []
        ]
    },
    {
        "id": "862007a1a92de19b",
        "type": "json",
        "z": "fca036ab5aa23301",
        "g": "281da2542719f7ce",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1250,
        "y": 500,
        "wires": [
            [
                "60f4ee43b8ea1811",
                "c0e33d0da64adf97"
            ]
        ]
    },
    {
        "id": "66f404ec026a1e86",
        "type": "change",
        "z": "fca036ab5aa23301",
        "name": "settings_name",
        "rules": [
            {
                "t": "set",
                "p": "args_sub.settings_name",
                "pt": "msg",
                "to": "client_id & \"__settings\"\t",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 960,
        "y": 160,
        "wires": [
            [
                "d74f82f3ec519f0b"
            ]
        ]
    },
    {
        "id": "3a7756d9fa7a0bfd",
        "type": "switch",
        "z": "fca036ab5aa23301",
        "name": "",
        "property": "true",
        "propertyType": "jsonata",
        "rules": [
            {
                "t": "eq",
                "v": "$exists(args_sub.settings_name)and $exists(vault_api)and $exists(session_id)",
                "vt": "jsonata"
            },
            {
                "t": "eq",
                "v": "$exists(client_id) and $exists(vault_api)and $exists(session_id)",
                "vt": "jsonata"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 3,
        "x": 790,
        "y": 140,
        "wires": [
            [
                "d74f82f3ec519f0b",
                "93b92ac848544187"
            ],
            [
                "66f404ec026a1e86"
            ],
            [
                "434ac0347080cde9"
            ]
        ]
    },
    {
        "id": "434ac0347080cde9",
        "type": "change",
        "z": "fca036ab5aa23301",
        "name": "Error message",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "ERROR not enough input parameter",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 960,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "641eac4e6a3a1072",
        "type": "change",
        "z": "fca036ab5aa23301",
        "name": "mask args",
        "rules": [
            {
                "t": "set",
                "p": "args_sub",
                "pt": "msg",
                "to": "args",
                "tot": "msg",
                "dc": true
            },
            {
                "t": "move",
                "p": "args",
                "pt": "msg",
                "to": "args_in",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 290,
        "y": 40,
        "wires": [
            [
                "2b82d1df4e595d8b"
            ]
        ]
    },
    {
        "id": "60f4ee43b8ea1811",
        "type": "switch",
        "z": "fca036ab5aa23301",
        "name": "",
        "property": "args_sub.keep = true",
        "propertyType": "jsonata",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 1470,
        "y": 500,
        "wires": [
            [
                "9ffbd2aa8e3b35c4"
            ],
            [
                "2fa9a7a10b10782e"
            ]
        ]
    },
    {
        "id": "2b82d1df4e595d8b",
        "type": "switch",
        "z": "fca036ab5aa23301",
        "name": "",
        "property": "$type(args_sub.expire)=\"number\"",
        "propertyType": "jsonata",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 110,
        "y": 140,
        "wires": [
            [
                "ffd96ba83772ca58"
            ],
            [
                "8cabfa8f5e73b072"
            ]
        ]
    },
    {
        "id": "9ffbd2aa8e3b35c4",
        "type": "change",
        "z": "fca036ab5aa23301",
        "name": "reset args",
        "rules": [
            {
                "t": "move",
                "p": "args_in",
                "pt": "msg",
                "to": "args",
                "tot": "msg"
            },
            {
                "t": "delete",
                "p": "args_sub",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1620,
        "y": 460,
        "wires": [
            []
        ]
    },
    {
        "id": "8cabfa8f5e73b072",
        "type": "change",
        "z": "fca036ab5aa23301",
        "name": "set expire",
        "rules": [
            {
                "t": "set",
                "p": "args_sub.expire",
                "pt": "msg",
                "to": "24*60*60",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 260,
        "y": 220,
        "wires": [
            [
                "ffd96ba83772ca58"
            ]
        ]
    },
    {
        "id": "e20436251156a60f",
        "type": "brave-redis-queue",
        "z": "fca036ab5aa23301",
        "g": "65512d829ddbe85d",
        "name": "",
        "x": 1810,
        "y": 140,
        "wires": [
            [
                "78aa02b86a2d9b5f",
                "e1068dc03fd73659"
            ],
            [
                "92b6319ddcc5179b"
            ]
        ]
    },
    {
        "id": "6adaa8b423a4321e",
        "type": "change",
        "z": "fca036ab5aa23301",
        "g": "65512d829ddbe85d",
        "name": "Try to read settings from Redis",
        "rules": [
            {
                "t": "set",
                "p": "args.topic",
                "pt": "msg",
                "to": "$substringBefore($substring(vault_api,8),\"/\")\t& \"__\" & args_sub.settings_name",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "args.method",
                "pt": "msg",
                "to": "GET",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "args.keep_queue",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            },
            {
                "t": "delete",
                "p": "payload",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1570,
        "y": 140,
        "wires": [
            [
                "e20436251156a60f",
                "2d89d68958642caa"
            ]
        ]
    },
    {
        "id": "2fa9a7a10b10782e",
        "type": "change",
        "z": "fca036ab5aa23301",
        "name": "delete args",
        "rules": [
            {
                "t": "delete",
                "p": "args_in",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "args_sub",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "args",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1630,
        "y": 520,
        "wires": [
            []
        ]
    },
    {
        "id": "78aa02b86a2d9b5f",
        "type": "switch",
        "z": "fca036ab5aa23301",
        "g": "65512d829ddbe85d",
        "name": "",
        "property": "payload?true:false",
        "propertyType": "jsonata",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 1990,
        "y": 140,
        "wires": [
            [
                "60f4ee43b8ea1811"
            ],
            [
                "f2e66c06b9a9ba35"
            ]
        ]
    },
    {
        "id": "be87b21f1e94e2d6",
        "type": "brave-redis-queue",
        "z": "fca036ab5aa23301",
        "g": "a6858237518cf424",
        "name": "",
        "x": 750,
        "y": 640,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "c0e33d0da64adf97",
        "type": "change",
        "z": "fca036ab5aa23301",
        "g": "a6858237518cf424",
        "name": "Write settings to Redis",
        "rules": [
            {
                "t": "set",
                "p": "args.topic",
                "pt": "msg",
                "to": "$substringBefore($substring(vault_api,8),\"/\")\t& \"__\" & args_sub.settings_name",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "args.method",
                "pt": "msg",
                "to": "SET",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "args.expire",
                "pt": "msg",
                "to": "args_sub.expire",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 480,
        "y": 640,
        "wires": [
            [
                "be87b21f1e94e2d6"
            ]
        ]
    },
    {
        "id": "ffd96ba83772ca58",
        "type": "switch",
        "z": "fca036ab5aa23301",
        "name": "",
        "property": "$type(args_sub.attachment_name) = \"string\" and\t$length($trim(args_sub.attachment_name))",
        "propertyType": "jsonata",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 430,
        "y": 140,
        "wires": [
            [
                "22eea11a1ec723a4"
            ],
            [
                "506d0aa9dcef77b4"
            ]
        ]
    },
    {
        "id": "506d0aa9dcef77b4",
        "type": "change",
        "z": "fca036ab5aa23301",
        "name": "set attachment",
        "rules": [
            {
                "t": "set",
                "p": "args_sub.attachment_name",
                "pt": "msg",
                "to": "settings.json",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 598.6666259765625,
        "y": 186.66665649414062,
        "wires": [
            [
                "3a7756d9fa7a0bfd"
            ]
        ]
    },
    {
        "id": "22eea11a1ec723a4",
        "type": "change",
        "z": "fca036ab5aa23301",
        "name": "append extension",
        "rules": [
            {
                "t": "set",
                "p": "args_sub.attachment_name",
                "pt": "msg",
                "to": "$substring(args_sub.attachment_name,-5)=\".json\"?\targs_sub.attachment_name:\targs_sub.attachment_name & \".json\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 610,
        "y": 100,
        "wires": [
            [
                "3a7756d9fa7a0bfd"
            ]
        ]
    },
    {
        "id": "d74f82f3ec519f0b",
        "type": "switch",
        "z": "fca036ab5aa23301",
        "name": "",
        "property": "args_sub.forced_renewal=true",
        "propertyType": "jsonata",
        "rules": [
            {
                "t": "false"
            },
            {
                "t": "true"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1170,
        "y": 140,
        "wires": [
            [
                "6adaa8b423a4321e"
            ],
            [
                "f2e66c06b9a9ba35"
            ]
        ]
    },
    {
        "id": "92b6319ddcc5179b",
        "type": "debug",
        "z": "fca036ab5aa23301",
        "name": "debug 160",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2090,
        "y": 60,
        "wires": []
    },
    {
        "id": "e1068dc03fd73659",
        "type": "debug",
        "z": "fca036ab5aa23301",
        "name": "debug 159",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1890,
        "y": 60,
        "wires": []
    },
    {
        "id": "bc35d3238047c6e4",
        "type": "debug",
        "z": "fca036ab5aa23301",
        "name": "debug 167",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1350,
        "y": 60,
        "wires": []
    },
    {
        "id": "7a6610a61178baf0",
        "type": "debug",
        "z": "fca036ab5aa23301",
        "name": "debug 165",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 987.22216796875,
        "y": 63.888877868652344,
        "wires": []
    },
    {
        "id": "93b92ac848544187",
        "type": "debug",
        "z": "fca036ab5aa23301",
        "name": "debug 158",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1170,
        "y": 100,
        "wires": []
    },
    {
        "id": "1c57d76c42e831f6",
        "type": "debug",
        "z": "fca036ab5aa23301",
        "name": "debug 163",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1430,
        "y": 600,
        "wires": []
    },
    {
        "id": "fdda318a7828b65d",
        "type": "debug",
        "z": "fca036ab5aa23301",
        "name": "debug 162",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1430,
        "y": 660,
        "wires": []
    },
    {
        "id": "b865262b1cb56950",
        "type": "debug",
        "z": "fca036ab5aa23301",
        "name": "debug 161",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1687.8887939453125,
        "y": 638.5555038452148,
        "wires": []
    },
    {
        "id": "2d89d68958642caa",
        "type": "debug",
        "z": "fca036ab5aa23301",
        "name": "debug 267",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1710,
        "y": 60,
        "wires": []
    },
    {
        "id": "6bdfd468d182560b",
        "type": "comment",
        "z": "2c4527dad914ec1c",
        "name": "testing in scratchbox 01",
        "info": "",
        "x": 180,
        "y": 60,
        "wires": []
    },
    {
        "id": "fefdf06d43eeebc2",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "name": "debug 268",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3710,
        "y": 3420,
        "wires": []
    },
    {
        "id": "e7423c8fd54b772d",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "RO_type",
                "pt": "msg",
                "to": "payload[0].ro_type",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 4390,
        "y": 1240,
        "wires": [
            [
                "2f7502d21fcdd942",
                "e94148e1f0dbc635"
            ]
        ]
    },
    {
        "id": "4832d0381e80370c",
        "type": "brave-login",
        "z": "2c4527dad914ec1c",
        "name": "",
        "x": 4350,
        "y": 1160,
        "wires": [
            [
                "f141912993d78d52"
            ],
            []
        ]
    },
    {
        "id": "07668747f053c633",
        "type": "subflow:fca036ab5aa23301",
        "z": "2c4527dad914ec1c",
        "name": "",
        "x": 530,
        "y": 2220,
        "wires": [
            [
                "c004104ce2cf68f1"
            ],
            []
        ]
    },
    {
        "id": "c004104ce2cf68f1",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "Event_Keywords",
                "pt": "msg",
                "to": "payload[0].event_keywords",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 250,
        "y": 2280,
        "wires": [
            [
                "43c3c451c473bb2d",
                "7824fdd12ef9b926"
            ]
        ]
    },
    {
        "id": "0155cf65fdd39e3a",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "name": "Retrieve configs in BRAVE",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t    \"settings_name\":\"cta_record_creation\",\t    \"attachment_name\":\"cta_creation_config.json\"\t}",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 260,
        "y": 2220,
        "wires": [
            [
                "07668747f053c633"
            ]
        ]
    },
    {
        "id": "43c3c451c473bb2d",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "name": "debug 269",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 510,
        "y": 2280,
        "wires": []
    },
    {
        "id": "ad9866d35eecc9de",
        "type": "subflow:fca036ab5aa23301",
        "z": "2c4527dad914ec1c",
        "name": "",
        "x": 4690,
        "y": 1200,
        "wires": [
            [
                "e7423c8fd54b772d"
            ],
            []
        ]
    },
    {
        "id": "f141912993d78d52",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "name": "Retrieve configs in BRAVE",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t    \"settings_name\":\"cta_record_creation\",\t    \"attachment_name\":\"cta_creation_config.json\"\t}",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 4420,
        "y": 1200,
        "wires": [
            [
                "ad9866d35eecc9de"
            ]
        ]
    },
    {
        "id": "e94148e1f0dbc635",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "name": "debug 270",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 4670,
        "y": 1240,
        "wires": []
    },
    {
        "id": "51a6656c283ea43b",
        "type": "subflow:fca036ab5aa23301",
        "z": "2c4527dad914ec1c",
        "name": "",
        "x": 3690,
        "y": 640,
        "wires": [
            [
                "733d347185817d94"
            ],
            []
        ]
    },
    {
        "id": "733d347185817d94",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "event_keyword",
                "pt": "msg",
                "to": "payload[0].event_keywords",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3410,
        "y": 700,
        "wires": [
            [
                "103604aa3b654e5b",
                "5679cefc989d62b5"
            ]
        ]
    },
    {
        "id": "afcf9e517dd2b57d",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "name": "Retrieve configs in BRAVE",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t    \"settings_name\":\"cta_record_creation\",\t    \"attachment_name\":\"cta_creation_config.json\"\t}",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3420,
        "y": 640,
        "wires": [
            [
                "51a6656c283ea43b"
            ]
        ]
    },
    {
        "id": "103604aa3b654e5b",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "name": "debug 271",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3670,
        "y": 700,
        "wires": []
    },
    {
        "id": "a517c1b0a121cedf",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "5cb21f050c83cc23",
        "name": "",
        "mode": "link",
        "links": [
            "a1d7e010334dfdd3"
        ],
        "x": 2775,
        "y": 480,
        "wires": []
    },
    {
        "id": "693756c6498c6064",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "5cb21f050c83cc23",
        "name": "query study",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, study_alias__c, product__v, product__vr.name__v, (select id, name__v, product__c, product__cr.name__v, product_family__c, product_family__cr.name__v, product_variant__c, product_variant__cr.name__v from clinical_study_products__cr), (select id, project__cr.name__v from project_clinical_studies__cr), (select id, name__v, therapeutic_indication__c, therapeutic_indication__cr.name__v from therapeutic_indication_clinical_studies__cr) from clinical_study__v where id='\" & study_id & \"'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 710,
        "y": 580,
        "wires": [
            [
                "ebb6d32d70665548"
            ]
        ]
    },
    {
        "id": "49eb745f3bb556d7",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "5cb21f050c83cc23",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "study",
                "pt": "msg",
                "to": "payload.data[0]",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1100,
        "y": 580,
        "wires": [
            [
                "3b9b516158e5b5ca",
                "b1e1d0d513bdc894"
            ]
        ]
    },
    {
        "id": "3b9b516158e5b5ca",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "5cb21f050c83cc23",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1290,
        "y": 540,
        "wires": []
    },
    {
        "id": "ebb6d32d70665548",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "5cb21f050c83cc23",
        "name": "",
        "x": 890,
        "y": 580,
        "wires": [
            [
                "49eb745f3bb556d7"
            ],
            [
                "a517c1b0a121cedf"
            ]
        ]
    },
    {
        "id": "b1e1d0d513bdc894",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "5cb21f050c83cc23",
        "name": "check study data",
        "property": "study",
        "propertyType": "msg",
        "rules": [
            {
                "t": "jsonata_exp",
                "v": "study.product__v = null",
                "vt": "jsonata"
            },
            {
                "t": "jsonata_exp",
                "v": "$count(study.clinical_study_products__cr.data) = 0",
                "vt": "jsonata"
            },
            {
                "t": "jsonata_exp",
                "v": "$distinct(study.clinical_study_products__cr.data.product_family__c) != study.product__v /* some products do not match primary product familiy */",
                "vt": "jsonata"
            },
            {
                "t": "jsonata_exp",
                "v": "$count(study.project_clinical_studies__cr.data) > 1",
                "vt": "jsonata"
            },
            {
                "t": "jsonata_exp",
                "v": "$count(study.therapeutic_indication_clinical_studies__cr.data) = 0",
                "vt": "jsonata"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 6,
        "x": 1510,
        "y": 580,
        "wires": [
            [
                "0127f053a5094720"
            ],
            [
                "fcbe9239c8f72a8e"
            ],
            [
                "85e16222f1b56109"
            ],
            [
                "2d2764e208e07b3f"
            ],
            [
                "352fd2a78633d9f0"
            ],
            [
                "335fcea11de055ae"
            ]
        ]
    },
    {
        "id": "fcbe9239c8f72a8e",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "5cb21f050c83cc23",
        "name": "no products",
        "rules": [
            {
                "t": "set",
                "p": "description",
                "pt": "msg",
                "to": "\"Study \" & study.name__v & \" \" & study.study_alias__c & \" is invalid.\"",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload.errors",
                "pt": "msg",
                "to": "[{\"type\":\"Incomplete Data\",\"message\":\"The study has no products\"}]",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1710,
        "y": 520,
        "wires": [
            [
                "a517c1b0a121cedf",
                "043679803e3a392d"
            ]
        ]
    },
    {
        "id": "0127f053a5094720",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "5cb21f050c83cc23",
        "name": "no product family",
        "rules": [
            {
                "t": "set",
                "p": "description",
                "pt": "msg",
                "to": "\"Study \" & study.name__v & \" \" & study.study_alias__c & \" is invalid.\"",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload.errors",
                "pt": "msg",
                "to": "[{\"type\":\"Incomplete Data\",\"message\":\"The study has no primary product family\"}]",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1730,
        "y": 480,
        "wires": [
            [
                "a517c1b0a121cedf",
                "98dd3ac1f755be79"
            ]
        ]
    },
    {
        "id": "85e16222f1b56109",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "5cb21f050c83cc23",
        "name": "products don't match pf",
        "rules": [
            {
                "t": "set",
                "p": "description",
                "pt": "msg",
                "to": "\"Study \" & study.name__v & \" \" & study.study_alias__c & \" is invalid.\"",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload.errors",
                "pt": "msg",
                "to": "[{\"type\":\"Inconsistent Data\",\"message\":\"The product family of the products do not match the primary product family of the study\"}]",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1750,
        "y": 560,
        "wires": [
            [
                "a517c1b0a121cedf",
                "dd5017ae345409f1"
            ]
        ]
    },
    {
        "id": "dd5017ae345409f1",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "5cb21f050c83cc23",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1950,
        "y": 560,
        "wires": []
    },
    {
        "id": "043679803e3a392d",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "5cb21f050c83cc23",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1950,
        "y": 520,
        "wires": []
    },
    {
        "id": "98dd3ac1f755be79",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "5cb21f050c83cc23",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1950,
        "y": 480,
        "wires": []
    },
    {
        "id": "335fcea11de055ae",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "5cb21f050c83cc23",
        "name": "query product family indications",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select therapeutic_indication__c, therapeutic_indication__cr.name__v from product_family_indication__c where status__v='active__v' and product_family__c='\" & study.product__v & \"'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1770,
        "y": 680,
        "wires": [
            [
                "8e5e730adeea5aeb"
            ]
        ]
    },
    {
        "id": "8e5e730adeea5aeb",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "5cb21f050c83cc23",
        "name": "",
        "x": 2010,
        "y": 680,
        "wires": [
            [
                "51eb3208af5c0b09"
            ],
            [
                "a517c1b0a121cedf"
            ]
        ]
    },
    {
        "id": "51eb3208af5c0b09",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "5cb21f050c83cc23",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "indications",
                "pt": "msg",
                "to": "payload.data",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2210,
        "y": 680,
        "wires": [
            [
                "89a16e05d4f19578"
            ]
        ]
    },
    {
        "id": "89a16e05d4f19578",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "5cb21f050c83cc23",
        "name": "check indications",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "jsonata_exp",
                "v": "$reduce(\t   study.therapeutic_indication_clinical_studies__cr.data.therapeutic_indication__c,\t   function($a, $v) {\t       $a and $v in indications.therapeutic_indication__c\t   },\t   true\t)",
                "vt": "jsonata"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 2430,
        "y": 680,
        "wires": [
            [
                "2dc749a6c210d478"
            ],
            [
                "368b275432ecdd54"
            ]
        ]
    },
    {
        "id": "368b275432ecdd54",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "5cb21f050c83cc23",
        "name": "indications don't match pf",
        "rules": [
            {
                "t": "set",
                "p": "description",
                "pt": "msg",
                "to": "\"Study \" & study.name__v & \" \" & study.study_alias__c & \" is invalid.\"",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload.errors",
                "pt": "msg",
                "to": "[{\"type\":\"Inconsistent Data\",\"message\":\"At least one indication of the clinical study is not valid for the primary product family.\"}]",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2670,
        "y": 680,
        "wires": [
            [
                "a517c1b0a121cedf"
            ]
        ]
    },
    {
        "id": "2dc749a6c210d478",
        "type": "template",
        "z": "2c4527dad914ec1c",
        "g": "5cb21f050c83cc23",
        "name": "application type selection",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "<!DOCTYPE html>\n\n<html lang=\"en\">\n\n    <head>\n\n        <meta charset=\"UTF-8\">\n\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n\n        <meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\">\n\n        <title>{{title}}</title>\n\n        <link  href=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css\" rel=\"stylesheet\" id=\"bootstrap-css\">\n\n        <script src=\"https://code.jquery.com/jquery-1.11.1.min.js\"></script>\n\n        <script src=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js\"></script>\n\n\n\n\n        <style>\n\n           .tabs {\n\n                width: 400px;\n\n                margin: 30px auto;\n\n                background-color: #FFF;\n\n               /* border: 500px solid #C0DCC0;\n\n                /*box-sizing: border-box;*/\n\n                display: inline;\n\n                }\n\n           \n\n            .tabs nav {\n\n                width:400px;\n\n                height: 40px;\n\n                text-align: center;\n\n                line-height: 40px;\n\n                overflow: hidden;\n\n                background-color: #C0DCC0;\n\n                /* 伸缩盒模型 */\n\n                display: flex;\n\n                }\n\n\n\n\n            nav a {\n\n                display: block;\n\n                width: 400px;\n\n                border-right: 1px solid #FFF;\n\n                color: #000;\n\n                text-decoration: none;\n\n                }\n\n           \n\n            nav a:last-child {\n\n                border-right: none;\n\n                }\n\n\n\n\n            nav a.active {\n\n                background-color: #9BAF9B;\n\n                }\n\n\n\n\n            .cont {\n\n                overflow: hidden;\n\n                display: none;\n\n                }\n\n\n\n\n            .cont ol {\n\n                line-height: 300px;\n\n                }\n\n            p#back-to-top{\n\n                cursor:pointer;\n\n                position:fixed;\n\n                display:none;\n\n                bottom:100px;\n\n                right:40px;\n\n            }\n\n            #myBtn {\n\n                display: none; /* Hidden by default */\n\n                position: fixed; /* Fixed/sticky position */\n\n                bottom: 20px; /* Place the button at the bottom of the page */\n\n                right: 30px; /* Place the button 30px from the right */\n\n                z-index: 99; /* Make sure it does not overlap */\n\n                border: none; /* Remove borders */\n\n                outline: none; /* Remove outline */\n\n                background-color: #33D1FF; /* Set a background color */\n\n                color: white; /* Text color */\n\n                cursor: pointer; /* Add a mouse pointer on hover */\n\n                padding: 15px; /* Some padding */\n\n                border-radius: 10px; /* Rounded corners */\n\n                font-size: 18px; /* Increase font size */\n\n            }\n\n\n\n\n            #myBtn:hover {\n\n                background-color: #555; /* Add a dark-grey background on hover */\n\n                }\n\n\n\n\n            .searchTerm {\n\n                width: 25%;\n\n                border: 3px solid #00B4CC;\n\n                padding: 5px;\n\n                height: 30px;\n\n                border-radius: 5px 5px 5px 5px;\n\n                outline: none;\n\n                color: #9DBFAF;\n\n            }\n\n\n\n\n            .searchTerm:focus{\n\n                color: #00B4CC;\n\n                }\n\n\n\n\n                /*Resize the wrap to see the search bar change!*/\n\n            .wrap{\n\n                width: 30%;\n\n                position: absolute;\n\n                top: 50%;\n\n                left: 50%;\n\n                right:50%;\n\n                transform: translate(-50%, -50%);\n\n                }\n\n    </style>\n\n   \n\n    </head>\n\n    <body>\n\n   \n\n    <div class=\"container\">\n\n        <div class=\"row\">\n\n            <div class=\"col-md-12\">\n\n                <h2>Please define scope of the request for study</h2>\n\n                <p>{{ study.name__v  }}  {{ study.study_alias__c  }}</p>\n\n           \n\n            <div class=\"tabs\">\n\n                   <nav id=\"tab\">\n\n                       <a id=\"tabCTA\" href=\"javascript:;\"  style=\"text-decoration: none;\" data-cont=\"CTA\" class=\"active\">CTA Application</a>\n\n                    <a id=\"tabCTD\" href=\"javascript:;\" style=\"text-decoration: none;\" data-cont=\"CTAD\">CTA Amendment</a>\n\n                  </nav>\n\n                    <br/>\n\n \n\n                    <section class=\"cont\" id =\"CTA\" style=\"display:block\">\n\n                        <div class=\"table-responsive\">\n\n                            <form method=\"post\" action=\"/nodes/cta/execute\">\n\n                            <input type=\"hidden\" id=\"applicationType\" name=\"job_scope\" value=\"\" />\n\n                            <input type=\"hidden\" id=\"jobType\" name=\"job_type\" value=\"0\" />\n\n                       {{#hiddenfields}}\n\n                            <input type=\"hidden\" name=\"{{name}}\" value=\"{{value}}\" />\n\n                        {{/hiddenfields}}\n\n                              <tr>\n\n                                    <td>\n\n                                     <input id=\"submitCTA\" type=\"submit\" style=\"width:70px;height:30px\" value=\"Next\" class=\"btn btn-primary\" disabled=\"true\">\n\n                                 </td>\n\n\n\n\n                                        <td>\n\n                                     <button id=\"cancelCTA\" onclick=\"window.history.go(-{{ . }})\" class=\"btn btn-primary\" style=\"width:70px;height:30px\" value=\"Cancel\">Cancel</button>\n\n                                 </td>\n\n\n\n\n                              </tr>\n\n                                <br/>\n\n                                <tr> CTA Application: </tr>\n\n                                <br/>\n\n                                <div>\n\n                                    <tr>&nbsp;&nbsp;&nbsp;\n\n                                       <td><input type=\"checkbox\" value=\"CreateEvent\" name=\"CreateEvent\" class=\"CreateEvent\">&nbsp;Planning phase – Create Event and CTA Content Plan <span style=\"color:blue\"> (The first step to create tracking objects for a CTA is the creation of Event(s). When IMPD information is available or At time of document collection, the Event and Content Plan can be created)</span></td>\n\n                                    </tr>\n\n                                    <br/> <br/>\n\n                                     <tr>&nbsp;&nbsp;&nbsp;\n\n                                       <td><input type=\"checkbox\" value=\"CreateCountry\" name=\"CreateCountry\" class=\"CreateCountry\">&nbsp;Preparation phase – Create Country Application(s) <span style=\"color:blue\"> (Applications would only be created if not yet available. Therefore, it is strongly recommended to  <span style=\"font-weight:bold;\">first conduct a search for already existing applications. The corresponding CTA Amendment Event is needed to perform this action.</span>)</span></td>\n\n                                    </tr>\n\n                                     <br/> <br/>\n\n                                     <tr>&nbsp;&nbsp;&nbsp;\n\n                                       <td><input type=\"checkbox\" value=\"CreateRelated\" name=\"CreateRelated\" class=\"CreateRelated\">&nbsp;Preparation phase – Create Related Records <span style=\"color:blue\"> (When the final core package is ready for dispatch, Regulatory Objective and Submission records must be created to track the submission process. <span style=\"font-weight:bold;\">The corresponding CTA Amendment Event and Application(s) of the involved countries are needed to perform this action.</span>)</span></td>\n\n                                    </tr>\n\n                                </div>\n\n                                 <br/>\n\n                            </form>\n\n                        </div>\n\n                    </section>\n\n                    <section class=\"cont\" id=\"CTAD\">\n\n                        <div class=\"table-responsive\">\n\n                        <form method=\"post\" action=\"/nodes/cta/execute\">\n\n                         <input type=\"hidden\" id=\"applicationADType\" name=\"job_scope\" value=\"\" />\n\n                         <input type=\"hidden\" id=\"jobADType\" name=\"job_type\" value=\"0\" />\n\n                         {{#hiddenfields}}\n\n                         <input type=\"hidden\" name=\"{{name}}\" value=\"{{value}}\" />\n\n                         {{/hiddenfields}}\n\n                              <tr>\n\n                                    <td>\n\n                                     <input id=\"submitCTAD\" type=\"submit\" style=\"width:70px;height:30px\" value=\"Next\" class=\"btn btn-primary\" disabled=\"true\">\n\n                                 </td>\n\n\n\n\n                                        <td>\n\n                                     <button id=\"cancelCTAD\" onclick=\"window.history.go(-{{ . }})\" class=\"btn btn-primary\" style=\"width:70px;height:30px\" value=\"Cancel\">Cancel</button>\n\n                                 </td>\n\n\n\n\n                              </tr>\n\n                                <br/>\n\n                                <tr> CTA Amendment: </tr>\n\n                                <br/>\n\n                                <div>\n\n                                    <tr>&nbsp;&nbsp;&nbsp;\n\n                                       <td><input type=\"checkbox\" value=\"CreateADEvent\" name=\"CreateADEvent\" class=\"CreateADEvent\">&nbsp;Planning phase – Create Event and CTA Content Plan <span style=\"color:blue\"> (The first step to create tracking objects for a CTA is the creation of Event(s). Under Event you can set the scope of the to be changed details for all impacted countries.)</span></td>\n\n                                    </tr>\n\n                                    <br/> <br/>\n\n                                     <tr>&nbsp;&nbsp;&nbsp;\n\n                                       <td><input type=\"checkbox\" value=\"CreateADCountry\" name=\"CreateADCountry\" class=\"CreateADCountry\">&nbsp;Preparation phase – Create Country Application(s)  <span style=\"color:blue\"> (Usually the applications are only needed when first CTA application and only need to be created if not ye available. Therefore, it is strongly recommended to  <span style=\"font-weight:bold;\">first conduct a search for already existing applications. The corresponding CTA Application Event is needed to perform this action.</span>)</span></td>\n\n                                    </tr>\n\n                                     <br/> <br/>\n\n                                     <tr>&nbsp;&nbsp;&nbsp;\n\n                                       <td><input type=\"checkbox\" value=\"CreateADRelated\" name=\"CreateADRelated\" class=\"CreateADRelated\">&nbsp;Preparation phase – Create Related Records  <span style=\"color:blue\"> (When the final core package is ready for dispatch, Regulatory Objective and Submission records have to be created to track the submission process. <span style=\"font-weight:bold;\">The corresponding CTA Amendment Event and Application(s) of the involved countries are needed to perform this action.</span>)</span></td>\n\n                                    </tr>\n\n                                </div>\n\n                                 <br/>\n\n                            </form>\n\n                        </div>\n\n                       </section>\n\n                </div>\n\n            </div>\n\n        </div>\n\n    </div>\n\n    </body>\n\n</html>\n\n\n\n\n<script>\n\n    $(function(){\n\n          var aArr=document.querySelectorAll('a');\n\n          for(var i=0;i<aArr.length;i++){\n\n          aArr[i].onclick=function(){\n\n        var active=document.querySelector(\".active\");\n\n        active.classList.remove(\"active\");\n\n        this.classList.add(\"active\");\n\n        var name=this.getAttribute(\"data-cont\");\n\n        var section=document.getElementById(name);\n\n        var cont = document.getElementsByClassName(\"cont\");\n\n        for(var i=0;i<cont.length;i++){\n\n        cont[i].style.display=\"none\";\n\n\n\n\n        }\n\n        section.style.display=\"block\";\n\n\n\n\n\n          }\n\n      }\n\n    })\n\n</script>\n\n<script>\n\n    $(\"#CTAD\").change(function(){\n\n        var createEvent = document.getElementsByClassName('CreateADEvent');\n\n        var createCountry = document.getElementsByClassName('CreateADCountry');\n\n        var createRelated = document.getElementsByClassName('CreateADRelated');\n\n        var applicationType = document.getElementById('applicationADType').value.toString();\n\n           if(applicationType.startsWith('_'))\n\n            applicationType = applicationType.substring(1);\n\n     \n\n        var checkedcta = 0\n\n        for(let i=0; i<createEvent.length; i++){\n\n            if(createEvent[i].checked){\n\n               checkedcta = 1\n\n                 if(!applicationType.includes(\"CreateADEvent\"))\n\n                  applicationType=applicationType+'_CreateADEvent'\n\n               document.getElementById('applicationADType').value = applicationType\n\n            } else {\n\n                newType = applicationType.replace(\"CreateADEvent\", \"\")\n\n                newType = newType.replace(\"__\", \"_\")\n\n\n\n\n                applicationType = newType\n\n                document.getElementById('applicationADType').value = newType\n\n            }\n\n        }\n\n\n\n\n        for(let i=0; i<createCountry.length; i++){\n\n            if(createCountry[i].checked){\n\n               checkedcta = 1\n\n            if(!applicationType.includes(\"CreateADCountry\"))\n\n                  applicationType=applicationType+'_CreateADCountry'\n\n               document.getElementById('applicationADType').value = applicationType\n\n            } else {\n\n                newType = applicationType.replace(\"CreateADCountry\", \"\")\n\n                newType = newType.replace(\"__\", \"_\")\n\n\n\n\n                applicationType = newType\n\n                document.getElementById('applicationADType').value = newType\n\n            }\n\n        }\n\n\n\n\n        for(let i=0; i<createRelated.length; i++){\n\n            if(createRelated[i].checked){\n\n               checkedcta = 1\n\n                if(!applicationType.includes(\"CreateADRelated\"))\n\n                   applicationType=applicationType+'_CreateADRelated'\n\n               document.getElementById('applicationADType').value = applicationType\n\n            } else {\n\n                newType = applicationType.replace(\"CreateADRelated\", \"\")\n\n                newType = newType.replace(\"__\", \"_\")\n\n\n\n\n                applicationType = newType\n\n                document.getElementById('applicationADType').value = newType\n\n            }\n\n        }\n\n        if(checkedcta == 0){\n\n            document.getElementById('submitCTAD').disabled= true\n\n            document.getElementById('tabCTA').style = \"text-decoration: none;\"\n\n        }\n\n        if(checkedcta !== 0){\n\n           document.getElementById('submitCTAD').disabled= false\n\n           document.getElementById('tabCTA').style = \"pointer-events: none;\"\n\n           document.getElementById('jobADType').value = 2\n\n        }\n\n        console.log(checkedcta)\n\n    })\n\n</script>\n\n<script>\n\n    $(\"#CTA\").change(function(){\n\n        var createEvent = document.getElementsByClassName('CreateEvent');\n\n        var createCountry = document.getElementsByClassName('CreateCountry');\n\n        var createRelated = document.getElementsByClassName('CreateRelated');\n\n        var applicationType = document.getElementById('applicationType').value.toString();\n\n\n\n\n        if(applicationType.startsWith('_'))\n\n            applicationType = applicationType.substring(1);\n\n           \n\n\n\n\n        var checkedcta = 0\n\n        for(let i=0; i<createEvent.length; i++){\n\n            if(createEvent[i].checked){\n\n                console.log(\"--- clicked\")\n\n               checkedcta = 1\n\n               if(!applicationType.includes(\"CreateEvent\"))\n\n                  applicationType=applicationType+'_CreateEvent'\n\n               document.getElementById('applicationType').value = applicationType\n\n            } else {\n\n                newType = applicationType.replace(\"CreateEvent\", \"\")\n\n                newType = newType.replace(\"__\", \"_\")\n\n\n\n\n                applicationType = newType\n\n                document.getElementById('applicationType').value = newType\n\n            }\n\n        }\n\n\n\n\n        for(let i=0; i<createCountry.length; i++){\n\n            if(createCountry[i].checked){\n\n               checkedcta = 1\n\n               if(!applicationType.includes(\"CreateCountry\"))\n\n                  applicationType=applicationType+'_CreateCountry'\n\n               document.getElementById('applicationType').value = applicationType\n\n            } else {\n\n                newType = applicationType.replace(\"CreateCountry\", \"\")\n\n                newType = newType.replace(\"__\", \"_\")\n\n\n\n\n                applicationType = newType\n\n\n\n\n                document.getElementById('applicationType').value = newType\n\n            }\n\n        }\n\n\n\n\n        for(let i=0; i<createRelated.length; i++){\n\n            if(createRelated[i].checked){\n\n               checkedcta = 1\n\n               if(!applicationType.includes(\"createRelated\"))\n\n                   applicationType=applicationType+'_createRelated'\n\n               document.getElementById('applicationType').value = applicationType\n\n            } else {\n\n                newType = applicationType.replace(\"createRelated\", \"\")\n\n                newType = newType.replace(\"__\", \"_\")\n\n\n\n\n                applicationType = newType\n\n                document.getElementById('applicationType').value = newType\n\n            }\n\n        }\n\n        if(checkedcta == 0){\n\n            //document.getElementById('submitCTA').style.display='none'\n\n            document.getElementById('submitCTA').disabled= true\n\n            document.getElementById('tabCTD').style = \"text-decoration: none;\"\n\n           \n\n        }\n\n        if(checkedcta !== 0){\n\n           document.getElementById('submitCTA').disabled= false\n\n           document.getElementById('tabCTD').style = \"pointer-events: none;\"\n\n           document.getElementById('jobType').value = 1\n\n        }\n\n        console.log(checkedcta)\n\n    })\n\n</script>",
        "output": "str",
        "x": 2450,
        "y": 620,
        "wires": [
            [
                "7774dedcb5b66602",
                "813577ca6cd07706"
            ]
        ]
    },
    {
        "id": "813577ca6cd07706",
        "type": "http response",
        "z": "2c4527dad914ec1c",
        "g": "5cb21f050c83cc23",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 2690,
        "y": 620,
        "wires": []
    },
    {
        "id": "7774dedcb5b66602",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "5cb21f050c83cc23",
        "name": "debug 272",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2710,
        "y": 560,
        "wires": []
    },
    {
        "id": "352fd2a78633d9f0",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "5cb21f050c83cc23",
        "name": "No Indication",
        "rules": [
            {
                "t": "set",
                "p": "hiddenfields",
                "pt": "msg",
                "to": "[\t   {\t       \"name\": \"study_id\",\t       \"value\": study_id    \t   },\t   {\t       \"name\": \"client_id\",\t       \"value\": \"cta-automation\"    \t   },\t   {\t       \"name\": \"vault_domain_url\",\t       \"value\": vault_domain_url\t   },\t   {\t       \"name\": \"session_id\",\t       \"value\": session_id\t   }\t]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1710,
        "y": 640,
        "wires": [
            [
                "2dc749a6c210d478"
            ]
        ]
    },
    {
        "id": "2d2764e208e07b3f",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "5cb21f050c83cc23",
        "name": "more than one Project",
        "rules": [
            {
                "t": "set",
                "p": "description",
                "pt": "msg",
                "to": "\"Study \" & study.name__v & \" \" & study.study_alias__c & \" is invalid.\"",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload.errors",
                "pt": "msg",
                "to": "[{\"type\":\"Inconsistent Data\",\"message\":\"There are more than one Project connected with the study\"}]",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1740,
        "y": 600,
        "wires": [
            [
                "de90f54e9cfbe425",
                "a517c1b0a121cedf"
            ]
        ]
    },
    {
        "id": "de90f54e9cfbe425",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "5cb21f050c83cc23",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1950,
        "y": 600,
        "wires": []
    },
    {
        "id": "5c9328793e731c8d",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "5cb21f050c83cc23",
        "name": "debug 273",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 490,
        "y": 560,
        "wires": []
    },
    {
        "id": "eb06ff6916e786d3",
        "type": "brave-login",
        "z": "2c4527dad914ec1c",
        "g": "5cb21f050c83cc23",
        "name": "",
        "x": 550,
        "y": 500,
        "wires": [
            [
                "693756c6498c6064"
            ],
            [
                "a517c1b0a121cedf"
            ]
        ]
    },
    {
        "id": "5425c39838e432cb",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "5cb21f050c83cc23",
        "name": "Set basic parameters",
        "rules": [
            {
                "t": "set",
                "p": "study_id",
                "pt": "msg",
                "to": "payload.study_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "starttime",
                "pt": "msg",
                "to": "$now()",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "client_id",
                "pt": "msg",
                "to": "cta-automation",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "vault_domain_url",
                "pt": "msg",
                "to": "\"https://\" & payload.vault_domain",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 500,
        "wires": [
            [
                "eb06ff6916e786d3",
                "5c9328793e731c8d"
            ]
        ]
    },
    {
        "id": "a4a20ebaa9e237b1",
        "type": "http in",
        "z": "2c4527dad914ec1c",
        "g": "5cb21f050c83cc23",
        "name": "",
        "url": "ctad",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 180,
        "y": 500,
        "wires": [
            [
                "5425c39838e432cb"
            ]
        ]
    },
    {
        "id": "a1d7e010334dfdd3",
        "type": "link in",
        "z": "2c4527dad914ec1c",
        "g": "cc69f3c6d7a0efd8",
        "name": "Error",
        "links": [
            "2e21230765d562c0",
            "db9944eb60fbc49d",
            "c6b53c4a2748f542",
            "9256c6065eae30bf",
            "814b7282a5575644",
            "27b2616ea773d52f",
            "ed40e4afb8f69bb1",
            "a517c1b0a121cedf",
            "275ebe4c83353954",
            "ec17eea9c45882f3",
            "be22b1d3f5feb681",
            "6a8e4f7d0f114240",
            "0b31058c8431fa69",
            "b751e69c46e6c849",
            "f75af9837491f17f",
            "3e3e53986fc68011",
            "b5b267266e9c190a",
            "19f4967b796f2e9f",
            "e14e7058d20493e2",
            "dd8842491a14509c",
            "fc751c16e3989a80",
            "b351bb84c353b4f3",
            "bc49ae6168ab21da",
            "6dab2b9614b7b3f7",
            "af93e42bb2063079",
            "2491f8f69e4cd706",
            "42424a203fc5231c",
            "91bbab557e0bc067",
            "621d2ba2e014840a",
            "b6f857a48f7b4794",
            "4cddeead6c64cd6b"
        ],
        "x": 4505,
        "y": 460,
        "wires": [
            [
                "9bf2c6f4a4bfc009",
                "f0446d193facd28b"
            ]
        ]
    },
    {
        "id": "9bf2c6f4a4bfc009",
        "type": "template",
        "z": "2c4527dad914ec1c",
        "g": "cc69f3c6d7a0efd8",
        "name": "error",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "<!doctype html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"utf-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n    <title>Error</title>\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css\"\n        integrity=\"sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu\" crossorigin=\"anonymous\">\n    <script src=\"https://code.jquery.com/jquery-1.12.4.min.js\"\n        integrity=\"sha384-nvAa0+6Qg9clwYCGGPpDQLVpLNn0fRaROjHqs13t4Ggj3Ez50XnGQqc/r8MhnRDZ\"\n        crossorigin=\"anonymous\"></script>\n    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js\"\n        integrity=\"sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd\"\n        crossorigin=\"anonymous\"></script>\n</head>\n\n<body>\n    <div class=\"container\">\n        <h2>The operation failed</h2>\n        <p>{{description}}</p>\n\n        <div class=\"table-responsive\">\n            <table id=\"selectiontable\" class=\"table table-striped table-hover\">\n                <thead>\n                    <th>Error Type</th>\n                    <th>Message</th>\n                </thead>\n                <tbody>\n                    {{#payload.errors}}\n                        <tr>\n                            <td>{{type}}</td>\n                            <td>{{message}}</td>\n                        </tr>\n                    {{/payload.errors}}\n                    {{#payload.data.errors}}\n                        <tr>\n                            <td>{{type}}</td>\n                            <td>{{message}}</td>\n                        </tr>\n                    {{/payload.data.errors}}\n                </tbody>\n            </table>\n        </div>\n    </div>\n</body>\n\n</html>",
        "output": "str",
        "x": 4630,
        "y": 460,
        "wires": [
            [
                "436ac70a6529bbc6"
            ]
        ]
    },
    {
        "id": "436ac70a6529bbc6",
        "type": "http response",
        "z": "2c4527dad914ec1c",
        "g": "cc69f3c6d7a0efd8",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 4790,
        "y": 460,
        "wires": []
    },
    {
        "id": "f0446d193facd28b",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "cc69f3c6d7a0efd8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 4630,
        "y": 500,
        "wires": []
    },
    {
        "id": "ca194580f21c446e",
        "type": "http response",
        "z": "2c4527dad914ec1c",
        "g": "3b39a3f38c602820",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 4790,
        "y": 620,
        "wires": []
    },
    {
        "id": "5acffab548a35a4a",
        "type": "link in",
        "z": "2c4527dad914ec1c",
        "g": "3b39a3f38c602820",
        "name": "success",
        "links": [
            "def796fcf8b7ba68",
            "6610faf99d69fa98",
            "0d4182935183bc90"
        ],
        "x": 4505,
        "y": 620,
        "wires": [
            [
                "48174a72055dc276"
            ]
        ]
    },
    {
        "id": "48174a72055dc276",
        "type": "brave-input-form",
        "z": "2c4527dad914ec1c",
        "g": "3b39a3f38c602820",
        "name": "",
        "x": 4630,
        "y": 620,
        "wires": [
            [
                "ca194580f21c446e"
            ]
        ]
    },
    {
        "id": "0d4182935183bc90",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "8ffde65bf97cdec9",
        "name": "link out 1",
        "mode": "link",
        "links": [
            "5acffab548a35a4a"
        ],
        "x": 4065,
        "y": 420,
        "wires": []
    },
    {
        "id": "2c2566f1bea190a3",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "8ffde65bf97cdec9",
        "name": "Set the result page",
        "rules": [
            {
                "t": "set",
                "p": "applications",
                "pt": "msg",
                "to": "$append(ctrapplications,applications)",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "ros",
                "pt": "msg",
                "to": "$append(ctrros,ros)",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "submissions",
                "pt": "msg",
                "to": "$append(ctrsubmissions,submissions)",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "title",
                "pt": "msg",
                "to": "The operation was successful",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "description",
                "pt": "msg",
                "to": "\"<h5>The following Vault objects are now available for study \" & \"<a href=\\\"https://\" & req.cookies.vault_domain & \"/ui/#t/0TB000000000B26/0CT/\" & study_id & \"\\\" target=\\\"_blank\\\"\"&\"\\\">\" & study.name__v & \"</a><br><br></h5> It would take a while for the Submission Content Plan to be created and there would be a BRAVE notification after the completion.\"",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "unescaped",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "httpcalls",
                "pt": "msg",
                "to": "3",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "dataarray",
                "pt": "msg",
                "to": "[\t    {\t       \"selection\": created_event,\t       \"columns\": [\t           \"Event\",\t           \"<a href=\\\"https://\" & req.cookies.vault_domain & \"/ui/#t/0TB000000000B03/A0Z/\" &\t          created_event.id & \"\\\" target=\\\"_blank\\\"\"&\"\\\">\"& created_event.name__v & \"</a>\"\t        ]\t    },\t    created_applications@$vl. {\t        \"selection\": \"n/a\",\t         \"columns\": [\t            \"Application\",\t            \"<a href=\\\"https://\" & req.cookies.vault_domain & \"/ui/#t/0TB000000000B21/00A/\" & $vl.id & \"\\\" target=\\\"_blank\\\"\"&\"\\\">\"& $vl.name__v & \"</a>\"\t        ]\t    },\t    ros@$vl. {\t        \"selection\": \"n/a\",\t         \"columns\": [\t            \"Regulatory Objective\",\t            \"<a href=\\\"https://\" & req.cookies.vault_domain & \"/ui/#t/0TB000000000K01/OBH/\" & $vl.id & \"\\\" target=\\\"_blank\\\"\"&\"\\\">\"& $vl.name__v & \"</a>\"\t        ]\t    },\t    submissions@$vl. {\t        \"selection\": \"n/a\",\t         \"columns\": [\t            \"Submission\",\t            \"<a href=\\\"https://\" & req.cookies.vault_domain & \"/ui/#t/0TB000000000B22/00S/\" & $vl.id & \"\\\" target=\\\"_blank\\\"\"&\"\\\">\"& $vl.name__v & \"</a>\"\t        ]\t    }\t]\t\t",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "tableheader",
                "pt": "msg",
                "to": "{\t   \"columns\": \t    [\t        \"Type\",\t        \"Name\"\t    ]\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "flow",
                "pt": "msg",
                "to": "nodes/cta",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3920,
        "y": 420,
        "wires": [
            [
                "0d4182935183bc90",
                "e20de456532ccc89"
            ]
        ]
    },
    {
        "id": "86ee4f73d33b2cca",
        "type": "link in",
        "z": "2c4527dad914ec1c",
        "g": "8ffde65bf97cdec9",
        "name": "link in 1",
        "links": [
            "035c0891e0dd692a",
            "42678083ebcac3d6"
        ],
        "x": 3115,
        "y": 300,
        "wires": [
            [
                "68fbeedcf9e499c6"
            ]
        ]
    },
    {
        "id": "1ae64553ab7b98e3",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "8ffde65bf97cdec9",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "query_ids",
                "pt": "msg",
                "to": "created_application_ids ~> $map(function($v) {\"id='\" & $v & \"'\"}) ~> $join(\" OR \")",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3440,
        "y": 300,
        "wires": [
            [
                "fd26333c22246f71",
                "259cfda023e9be5c"
            ]
        ]
    },
    {
        "id": "259cfda023e9be5c",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "8ffde65bf97cdec9",
        "name": "query created applications",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v from application__v where \" & query_ids",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3670,
        "y": 300,
        "wires": [
            [
                "866360cc841435a0",
                "de414146dc5df955"
            ]
        ]
    },
    {
        "id": "866360cc841435a0",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "8ffde65bf97cdec9",
        "name": "",
        "x": 3890,
        "y": 300,
        "wires": [
            [
                "076fced8d83c5435"
            ],
            [
                "b6f857a48f7b4794"
            ]
        ]
    },
    {
        "id": "076fced8d83c5435",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "8ffde65bf97cdec9",
        "name": "store result",
        "rules": [
            {
                "t": "set",
                "p": "created_applications",
                "pt": "msg",
                "to": "payload.data",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 4070,
        "y": 300,
        "wires": [
            [
                "40d3110f8d98116f",
                "2709756b3f657fa4"
            ]
        ]
    },
    {
        "id": "5aa39461a59b8a2f",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "8ffde65bf97cdec9",
        "name": "query created event",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v from event__rim where id='\" & created_event_id & \"'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3660,
        "y": 360,
        "wires": [
            [
                "fa6ada68c3d3e566",
                "e46f1d0bcbc89a13"
            ]
        ]
    },
    {
        "id": "fa6ada68c3d3e566",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "8ffde65bf97cdec9",
        "name": "",
        "x": 3890,
        "y": 360,
        "wires": [
            [
                "77f5ccfb8132526a"
            ],
            [
                "b6f857a48f7b4794"
            ]
        ]
    },
    {
        "id": "77f5ccfb8132526a",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "8ffde65bf97cdec9",
        "name": "store result",
        "rules": [
            {
                "t": "set",
                "p": "created_event",
                "pt": "msg",
                "to": "payload.data",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 4070,
        "y": 360,
        "wires": [
            [
                "84a715c3efb3a6de",
                "2c2566f1bea190a3"
            ]
        ]
    },
    {
        "id": "fd26333c22246f71",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "8ffde65bf97cdec9",
        "name": "debug 274",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3870,
        "y": 240,
        "wires": []
    },
    {
        "id": "de414146dc5df955",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "8ffde65bf97cdec9",
        "name": "debug 275",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 4250,
        "y": 240,
        "wires": []
    },
    {
        "id": "40d3110f8d98116f",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "8ffde65bf97cdec9",
        "name": "debug 276",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 4250,
        "y": 300,
        "wires": []
    },
    {
        "id": "84a715c3efb3a6de",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "8ffde65bf97cdec9",
        "name": "debug 277",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 4250,
        "y": 360,
        "wires": []
    },
    {
        "id": "e20de456532ccc89",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "8ffde65bf97cdec9",
        "name": "debug 278",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 4250,
        "y": 480,
        "wires": []
    },
    {
        "id": "e46f1d0bcbc89a13",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "8ffde65bf97cdec9",
        "name": "debug 279",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 4250,
        "y": 420,
        "wires": []
    },
    {
        "id": "68fbeedcf9e499c6",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "8ffde65bf97cdec9",
        "name": "",
        "property": "created_application_ids",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nnull"
            },
            {
                "t": "null"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 3250,
        "y": 300,
        "wires": [
            [
                "1ae64553ab7b98e3"
            ],
            [
                "2709756b3f657fa4"
            ]
        ]
    },
    {
        "id": "2709756b3f657fa4",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "8ffde65bf97cdec9",
        "name": "",
        "property": "created_event_id",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nnull"
            },
            {
                "t": "null"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 3390,
        "y": 360,
        "wires": [
            [
                "5aa39461a59b8a2f"
            ],
            [
                "2c2566f1bea190a3"
            ]
        ]
    },
    {
        "id": "7bdbda2743cdc6b5",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "create event",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"event__rim\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t   {\t       \"object_type__vr.api_name__v\": \"clinical_study_event__c\",\t       \"applicable_product_type__v\": \"drug__v\",\t       \"event_description__c\": (params.event_description__c !=\"\" ? params.event_description__c : \"N/A\" )& (params.shelf_life !=\"\" ? \"; Shelf life: \" & params.shelf_life : \"\"),\t       \"keywords__c\": event_keywords_name,\t       \"rec__c\": rec_id,\t       \"global_application__v\": global_application,\t       \"content_plan_template__v\": \"0EP00000004B425\",\t       \"project_id__c\": study.project_clinical_studies__cr.data[0].project__c\t\t   }\t]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 190,
        "y": 3020,
        "wires": [
            [
                "aa587593b012a0d6"
            ]
        ]
    },
    {
        "id": "7975a53c4a64c4da",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "store result",
        "rules": [
            {
                "t": "set",
                "p": "event_id",
                "pt": "msg",
                "to": "payload.data[0].data.id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 710,
        "y": 3020,
        "wires": [
            [
                "a1297a352376667d",
                "01db86a06b72aa5d"
            ]
        ]
    },
    {
        "id": "5e4ca652c9e4bf6b",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "link to product family",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"event_product_family__c\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t   {\t       \"name__v\": event_id & \"_\" & study.product__v,\t       \"event__c\": event_id,\t       \"product_family__c\": study.product__v\t    }\t]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 220,
        "y": 3140,
        "wires": [
            [
                "df24c6a33ef0144c"
            ]
        ]
    },
    {
        "id": "327f99f807c82926",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "link to products",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"event_drug_product__rim\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t    study.clinical_study_products__cr.data.{\t       \"event__rim\": $$.event_id,\t       \"product_family__c\": product_family__c,\t       \"drug_product__rim\": product__c,\t       \"product_detail__rim\": product_variant__c\t    }\t]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 200,
        "y": 3200,
        "wires": [
            [
                "a24a9fbdc9572faf"
            ]
        ]
    },
    {
        "id": "9bfc6b2d877fd930",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "link to study",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"event_clinical_study__v\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t   {\t       \"event__v\": event_id,\t       \"clinical_study__v\": study_id,\t       \"impd_version_quality_part__c\": params.impd_version_quality_part__c,\t       \"impd_version_nonquality_part__c\": params.impd_version_nonquality_part__c,\t       \"protocol_version__c\": params.protocol_version__c,\t       \"ib_version__c\": params.ib_version__c\t    }\t]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 190,
        "y": 3260,
        "wires": [
            [
                "071f93addb1baef2"
            ]
        ]
    },
    {
        "id": "a1297a352376667d",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 970,
        "y": 3020,
        "wires": []
    },
    {
        "id": "489e682a3e118466",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 970,
        "y": 3140,
        "wires": []
    },
    {
        "id": "45fc8bba6e75e18b",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 970,
        "y": 3200,
        "wires": []
    },
    {
        "id": "4664de213928f6b8",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 970,
        "y": 3260,
        "wires": []
    },
    {
        "id": "aa587593b012a0d6",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "",
        "x": 500,
        "y": 3020,
        "wires": [
            [
                "7975a53c4a64c4da"
            ],
            [
                "2491f8f69e4cd706"
            ]
        ]
    },
    {
        "id": "df24c6a33ef0144c",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "",
        "x": 500,
        "y": 3140,
        "wires": [
            [
                "327f99f807c82926",
                "489e682a3e118466"
            ],
            [
                "2491f8f69e4cd706"
            ]
        ]
    },
    {
        "id": "a24a9fbdc9572faf",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "",
        "x": 500,
        "y": 3200,
        "wires": [
            [
                "45fc8bba6e75e18b",
                "9bfc6b2d877fd930"
            ],
            [
                "2491f8f69e4cd706"
            ]
        ]
    },
    {
        "id": "071f93addb1baef2",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "",
        "x": 500,
        "y": 3260,
        "wires": [
            [
                "4664de213928f6b8",
                "fb8967fe1e37119e"
            ],
            [
                "2491f8f69e4cd706"
            ]
        ]
    },
    {
        "id": "2491f8f69e4cd706",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "",
        "mode": "link",
        "links": [
            "a1d7e010334dfdd3"
        ],
        "x": 745,
        "y": 3180,
        "wires": []
    },
    {
        "id": "fb8967fe1e37119e",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "link to indications",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"event_indication__rim\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t   study.therapeutic_indication_clinical_studies__cr.data.{\t       \"product_family__c\": $$.study.product__v,\t       \"indication__rim\": therapeutic_indication__c,\t       \"event__rim\": $$.event_id\t    }\t]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 210,
        "y": 3320,
        "wires": [
            [
                "48d5f5daef40767e"
            ]
        ]
    },
    {
        "id": "48d5f5daef40767e",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "",
        "x": 500,
        "y": 3320,
        "wires": [
            [
                "31951ddedb788c4a",
                "121f746a467d7985"
            ],
            [
                "2491f8f69e4cd706"
            ]
        ]
    },
    {
        "id": "31951ddedb788c4a",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 970,
        "y": 3320,
        "wires": []
    },
    {
        "id": "6c0b1489b79ec564",
        "type": "http in",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "",
        "url": "cta/amend_event",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 250,
        "y": 2720,
        "wires": [
            [
                "34a488a3f7a19293",
                "a190aec9e9613a5f"
            ]
        ]
    },
    {
        "id": "a190aec9e9613a5f",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "store parameters",
        "rules": [
            {
                "t": "set",
                "p": "study_id",
                "pt": "msg",
                "to": "payload.study_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "params",
                "pt": "msg",
                "to": "payload",
                "tot": "msg",
                "dc": true
            },
            {
                "t": "set",
                "p": "job.job_scope",
                "pt": "msg",
                "to": "payload.job_scope",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "job.job_type",
                "pt": "msg",
                "to": "payload.job_type",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "event_keywords_name",
                "pt": "msg",
                "to": "payload.event_keywords_name",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 510,
        "y": 2720,
        "wires": [
            [
                "341d47cf0b2b0cce",
                "be22f772ce8a3b54"
            ]
        ]
    },
    {
        "id": "be22f772ce8a3b54",
        "type": "brave-login",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "",
        "x": 990,
        "y": 2780,
        "wires": [
            [
                "ea4a5eff2a90f692"
            ],
            [
                "2491f8f69e4cd706"
            ]
        ]
    },
    {
        "id": "341d47cf0b2b0cce",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 690,
        "y": 2680,
        "wires": []
    },
    {
        "id": "121f746a467d7985",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "restart CTA creation",
        "rules": [
            {
                "t": "set",
                "p": "headers",
                "pt": "msg",
                "to": "{\t   \"location\":\"/nodes/cta/execute?study_id=\" & study_id & \"&event_id=\" & event_id & \"&job_type=\" & job.job_type & \"&job_scope=\" & job.job_scope\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "statusCode",
                "pt": "msg",
                "to": "303",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 210,
        "y": 3380,
        "wires": [
            [
                "63f8ad143cc0ddef"
            ]
        ]
    },
    {
        "id": "34a488a3f7a19293",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 450,
        "y": 2680,
        "wires": []
    },
    {
        "id": "ea4a5eff2a90f692",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "query study",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, study_alias__c, product__v, product__vr.name__v, (select id, name__v, product__c, product__cr.name__v, product_family__c, product_family__cr.name__v, product_variant__c, product_variant__cr.name__v from clinical_study_products__cr), (select id, project__c, project__cr.name__v from project_clinical_studies__cr), (select id, name__v, therapeutic_indication__c, therapeutic_indication__cr.name__v from therapeutic_indication_clinical_studies__cr) from clinical_study__v where id='\" & study_id & \"'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 190,
        "y": 2840,
        "wires": [
            [
                "2c3f6e2ddb32d519"
            ]
        ]
    },
    {
        "id": "2c3f6e2ddb32d519",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "",
        "x": 490,
        "y": 2840,
        "wires": [
            [
                "b6b8561265ea31aa"
            ],
            [
                "2491f8f69e4cd706"
            ]
        ]
    },
    {
        "id": "b6b8561265ea31aa",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "study",
                "pt": "msg",
                "to": "payload.data[0]",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 720,
        "y": 2840,
        "wires": [
            [
                "6067cc6e280611b2",
                "1044ed1feb065477"
            ]
        ]
    },
    {
        "id": "6067cc6e280611b2",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 970,
        "y": 2840,
        "wires": []
    },
    {
        "id": "63f8ad143cc0ddef",
        "type": "http response",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 470,
        "y": 3380,
        "wires": []
    },
    {
        "id": "62ade5ae7fc90b87",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "create REC",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"regulatory_event_code__c\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t   {\t       \t   }\t]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 190,
        "y": 2960,
        "wires": [
            [
                "7743178ec513f855"
            ]
        ]
    },
    {
        "id": "7743178ec513f855",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "",
        "x": 500,
        "y": 2960,
        "wires": [
            [
                "873c396f5e7b7dad"
            ],
            [
                "2491f8f69e4cd706"
            ]
        ]
    },
    {
        "id": "a9fd5e372d44bf21",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "debug 280",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 990,
        "y": 2960,
        "wires": []
    },
    {
        "id": "873c396f5e7b7dad",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "store result",
        "rules": [
            {
                "t": "set",
                "p": "rec_id",
                "pt": "msg",
                "to": "payload.data[0].data.id",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 710,
        "y": 2960,
        "wires": [
            [
                "a9fd5e372d44bf21",
                "7bdbda2743cdc6b5"
            ]
        ]
    },
    {
        "id": "01db86a06b72aa5d",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "Create Global Content Plan",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "vault_api & \"v22.2/vobjects/event__rim/\" & event_id &\"/actions/Objectlifecyclestateuseraction.event__rim.planned_state__c.create_global_content_plan_useraction__c\"",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "headers",
                "pt": "msg",
                "to": "{\t   \"Authorization\": session_id,\t   \"Accept\": \"application/json\",\t   \"Content-Type\": \"application/x-www-form-urlencoded\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 240,
        "y": 3080,
        "wires": [
            [
                "4caa4b440eecd699"
            ]
        ]
    },
    {
        "id": "ec3bd062de3892df",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "debug 281",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 990,
        "y": 3080,
        "wires": []
    },
    {
        "id": "4caa4b440eecd699",
        "type": "http request",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 490,
        "y": 3080,
        "wires": [
            [
                "ec3bd062de3892df",
                "5e4ca652c9e4bf6b"
            ]
        ]
    },
    {
        "id": "1044ed1feb065477",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "query global application",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, product__v, product__vr.name__v from application__v where object_type__vr.api_name__v='global_application__v' and product__v='\" & study.product__v & \"'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 230,
        "y": 2900,
        "wires": [
            [
                "40cc101214fab216"
            ]
        ]
    },
    {
        "id": "f38c2e7c333e26c6",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 970,
        "y": 2900,
        "wires": []
    },
    {
        "id": "87365503757eef58",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "global_application",
                "pt": "msg",
                "to": "payload.data[0].id",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 760,
        "y": 2900,
        "wires": [
            [
                "f38c2e7c333e26c6",
                "62ade5ae7fc90b87"
            ]
        ]
    },
    {
        "id": "40cc101214fab216",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "",
        "x": 490,
        "y": 2900,
        "wires": [
            [
                "87365503757eef58"
            ],
            [
                "2491f8f69e4cd706"
            ]
        ]
    },
    {
        "id": "c6a48fc906ea7961",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "event_keywords_string",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 720,
        "y": 2720,
        "wires": [
            [
                "0721deac26607746"
            ]
        ]
    },
    {
        "id": "aff0aca1f43e6a27",
        "type": "json",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "json to object",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 190,
        "y": 2780,
        "wires": [
            [
                "5a7cadee10bd1fd2"
            ]
        ]
    },
    {
        "id": "7ffc6c3c390efdf3",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "Event Keyword to string",
        "rules": [
            {
                "t": "set",
                "p": "event_keywords_name",
                "pt": "msg",
                "to": "payload.Name ~>\t$reduce(function($i,$j){$i & \",\" & $j})",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 750,
        "y": 2780,
        "wires": [
            [
                "947f65204f9bce09",
                "be22f772ce8a3b54"
            ]
        ]
    },
    {
        "id": "947f65204f9bce09",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "debug 282",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1050,
        "y": 2700,
        "wires": []
    },
    {
        "id": "0721deac26607746",
        "type": "split",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 890,
        "y": 2720,
        "wires": [
            [
                "aff0aca1f43e6a27"
            ]
        ]
    },
    {
        "id": "5a7cadee10bd1fd2",
        "type": "join",
        "z": "2c4527dad914ec1c",
        "g": "9a07594d93225bc8",
        "name": "",
        "mode": "auto",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": true,
        "timeout": "",
        "count": "",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 470,
        "y": 2780,
        "wires": [
            [
                "7ffc6c3c390efdf3"
            ]
        ]
    },
    {
        "id": "ee4366403c02b6ed",
        "type": "link in",
        "z": "2c4527dad914ec1c",
        "g": "3b470881f25ba564",
        "name": "link in 2",
        "links": [],
        "x": 135,
        "y": 2420,
        "wires": [
            [
                "0155cf65fdd39e3a"
            ]
        ]
    },
    {
        "id": "d22e8bdb48ca67c9",
        "type": "http response",
        "z": "2c4527dad914ec1c",
        "g": "3b470881f25ba564",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 680,
        "y": 2420,
        "wires": []
    },
    {
        "id": "7824fdd12ef9b926",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "3b470881f25ba564",
        "name": "set fields for input form",
        "rules": [
            {
                "t": "set",
                "p": "title",
                "pt": "msg",
                "to": "\"Creating Event for Study \" & study.name__v & \" \" & study.study_alias__c",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "type",
                "pt": "msg",
                "to": "checkbox",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "description",
                "pt": "msg",
                "to": "Please select Event Keywords.",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "tableheader",
                "pt": "msg",
                "to": "{\"columns\":[\"Event Keyword\"]}",
                "tot": "json"
            },
            {
                "t": "set",
                "p": "dataarray",
                "pt": "msg",
                "to": "Event_Keywords.{\t   \"selection\": $string(),\t   \"columns\": \t   [\t       Title\t       ]\t}",
                "tot": "jsonata",
                "dc": true
            },
            {
                "t": "set",
                "p": "flow",
                "pt": "msg",
                "to": "nodes/cta/event_info",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "hiddenfields",
                "pt": "msg",
                "to": "[\t   {\t       \"name\": \"study_id\",\t       \"value\": study_id\t    },\t    {\t        \"name\": \"job_type\",\t        \"value\": job.job_type\t    },\t    {\t        \"name\": \"job_scope\",\t        \"value\": job.job_scope\t    }\t]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 290,
        "y": 2420,
        "wires": [
            [
                "912a8a51ff9bea31"
            ]
        ]
    },
    {
        "id": "912a8a51ff9bea31",
        "type": "brave-input-form",
        "z": "2c4527dad914ec1c",
        "g": "3b470881f25ba564",
        "name": "",
        "x": 510,
        "y": 2420,
        "wires": [
            [
                "d22e8bdb48ca67c9"
            ]
        ]
    },
    {
        "id": "2d28b95c057acbd6",
        "type": "template",
        "z": "2c4527dad914ec1c",
        "g": "5efd74cfedb4bd1b",
        "name": "Input Form",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "<!doctype html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"utf-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n    <title>New Clinical Study Event</title>\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css\"\n        integrity=\"sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu\" crossorigin=\"anonymous\">\n    <script src=\"https://code.jquery.com/jquery-1.12.4.min.js\"\n        integrity=\"sha384-nvAa0+6Qg9clwYCGGPpDQLVpLNn0fRaROjHqs13t4Ggj3Ez50XnGQqc/r8MhnRDZ\"\n        crossorigin=\"anonymous\"></script>\n    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js\"\n        integrity=\"sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd\"\n        crossorigin=\"anonymous\"></script>\n</head>\n\n<body>\n    <div class=\"modal fade\" id=\"modal\" tabindex=\"-1\" data-backdrop=\"static\">\n        <div class=\"modal-dialog\">\n            <div class=\"modal-content\">\n                <div class=\"modal-header\">\n                    <h4 class=\"modal-title\">Processing ...</h4>\n                </div>\n                <div class=\"modal-body\">\n                    <p>Please wait while the changes are applied.</p>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"container\">\n        <h1>New Event for Clinical Study {{study.name__v}}</h1>\n        <p>Please provide details for the new Clinical Study Event.</p>\n        <br>\n        <form class=\"form-horizontal\" method=\"post\" action=\"/nodes/cta/amend_event\">\n            <input type=\"hidden\" name=\"study_id\" value=\"{{study_id}}\">\n            <input type=\"hidden\" name=\"job_scope\" value=\"{{job.job_scope}}\">\n            <input type=\"hidden\" name=\"job_type\" value=\"{{job.job_type}}\">\n            <input type=\"hidden\" name=\"event_keywords_name\" value=\"{{event_keywords_name}}\">\n            \n            <div class=\"form-group\">\n                <label class=\"col-md-4 control-label\" for=\"impd_version_quality_part__c\">IMPD Version Quality Part\n                    Provided</label>\n                <div class=\"col-md-8\">\n                    <input type=\"text\" class=\"form-control\" id=\"impd_version_quality_part__c\"\n                        name=\"impd_version_quality_part__c\">\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label class=\"col-md-4 control-label\" for=\"impd_version_nonquality_part__c\">IMPD Version non- Quality\n                    Part Provided</label>\n                <div class=\"col-md-8\">\n                    <input type=\"text\" class=\"form-control\" id=\"impd_version_nonquality_part__c\"\n                        name=\"impd_version_nonquality_part__c\">\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label class=\"col-md-4 control-label\" for=\"protocol_version__c\">Protocol Version Provided</label>\n                <div class=\"col-md-8\">\n                    <input type=\"text\" class=\"form-control\" id=\"protocol_version__c\" name=\"protocol_version__c\">\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label class=\"col-md-4 control-label\" for=\"ib_version__c\">IB Version Provided</label>\n                <div class=\"col-md-8\">\n                    <input type=\"text\" class=\"form-control\" id=\"ib_version__c\" name=\"ib_version__c\">\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label class=\"col-md-4 control-label\" for=\"shelf_life\">Shelf Life</label>\n                <div class=\"col-md-8\">\n                    <input type=\"text\" class=\"form-control\" id=\"shelf_life\" name=\"shelf_life\">\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label class=\"col-md-4 control-label\" for=\"event_description__c\">Event Desciption</label>\n                <div class=\"col-md-8\">\n                    <input type=\"text\" class=\"form-control\" id=\"event_description__c\" name=\"event_description__c\">\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <div class=\"col-md-offset-4 col-md-8\">\n                    <button type=\"submit\" class=\"btn btn-primary\">Create Clinical Study Event</button>\n                </div>\n            </div>\n        </form>\n    </div>\n\n    <script>\n        $(document).ready(function(){\n            $(\"form\").submit(function() {\n                $(\"#modal\").modal(\"show\");\n            });\n        });\n    </script>\n</body>\n\n</html>",
        "output": "str",
        "x": 810,
        "y": 2580,
        "wires": [
            [
                "16a15a22a3ecac4f"
            ]
        ]
    },
    {
        "id": "16a15a22a3ecac4f",
        "type": "http response",
        "z": "2c4527dad914ec1c",
        "g": "5efd74cfedb4bd1b",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 990,
        "y": 2580,
        "wires": []
    },
    {
        "id": "5d11ec05b66d8579",
        "type": "http in",
        "z": "2c4527dad914ec1c",
        "g": "5efd74cfedb4bd1b",
        "name": "",
        "url": "cta/event_info",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 240,
        "y": 2520,
        "wires": [
            [
                "50f1ed09b27bed3a"
            ]
        ]
    },
    {
        "id": "b056ee42124d34cb",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "5efd74cfedb4bd1b",
        "name": "store parameters",
        "rules": [
            {
                "t": "set",
                "p": "study_id",
                "pt": "msg",
                "to": "payload.study_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "params",
                "pt": "msg",
                "to": "payload",
                "tot": "msg",
                "dc": true
            },
            {
                "t": "set",
                "p": "job.job_scope",
                "pt": "msg",
                "to": "payload.job_scope",
                "tot": "msg",
                "dc": true
            },
            {
                "t": "set",
                "p": "job.job_type",
                "pt": "msg",
                "to": "payload.job_type",
                "tot": "msg",
                "dc": true
            },
            {
                "t": "set",
                "p": "event_keywords_string",
                "pt": "msg",
                "to": "payload.response_full",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 630,
        "y": 2520,
        "wires": [
            [
                "7d376e89c7e53d97",
                "bc189a0f67043a81"
            ]
        ]
    },
    {
        "id": "7d376e89c7e53d97",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "5efd74cfedb4bd1b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "event_keywords_string",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 820,
        "y": 2520,
        "wires": [
            [
                "af4d16bd22a40964"
            ]
        ]
    },
    {
        "id": "af4d16bd22a40964",
        "type": "split",
        "z": "2c4527dad914ec1c",
        "g": "5efd74cfedb4bd1b",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 990,
        "y": 2520,
        "wires": [
            [
                "6b76d854d26061fe"
            ]
        ]
    },
    {
        "id": "6b76d854d26061fe",
        "type": "json",
        "z": "2c4527dad914ec1c",
        "g": "5efd74cfedb4bd1b",
        "name": "json to object",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 250,
        "y": 2580,
        "wires": [
            [
                "822cec06c5fb841a"
            ]
        ]
    },
    {
        "id": "822cec06c5fb841a",
        "type": "join",
        "z": "2c4527dad914ec1c",
        "g": "5efd74cfedb4bd1b",
        "name": "",
        "mode": "auto",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": true,
        "timeout": "",
        "count": "",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 410,
        "y": 2580,
        "wires": [
            [
                "5b5a5ba5cb51ccd9"
            ]
        ]
    },
    {
        "id": "5b5a5ba5cb51ccd9",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "5efd74cfedb4bd1b",
        "name": "Event Keyword to string",
        "rules": [
            {
                "t": "set",
                "p": "event_keywords_name",
                "pt": "msg",
                "to": "payload.Name ~>\t$reduce(function($i,$j){$i & \",\" & $j})",
                "tot": "jsonata",
                "dc": true
            },
            {
                "t": "set",
                "p": "event_keywords_title",
                "pt": "msg",
                "to": "payload.Title ~>\t$reduce(function($i,$j){$i & \",\" & $j})",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 610,
        "y": 2580,
        "wires": [
            [
                "2d28b95c057acbd6",
                "5ea516a7f15262e5"
            ]
        ]
    },
    {
        "id": "50f1ed09b27bed3a",
        "type": "json",
        "z": "2c4527dad914ec1c",
        "g": "5efd74cfedb4bd1b",
        "name": "resp_full",
        "property": "payload.response_full",
        "action": "obj",
        "pretty": false,
        "x": 440,
        "y": 2520,
        "wires": [
            [
                "b056ee42124d34cb"
            ]
        ]
    },
    {
        "id": "bc189a0f67043a81",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "b75f5f55f3053983",
        "name": "debug 283",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1030,
        "y": 2420,
        "wires": []
    },
    {
        "id": "5ea516a7f15262e5",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "b75f5f55f3053983",
        "name": "debug 284",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1090,
        "y": 2380,
        "wires": []
    },
    {
        "id": "1565440b12069ef1",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "create event",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"event__rim\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t   {\t       \"object_type__vr.api_name__v\": \"clinical_study_event__c\",\t       \"applicable_product_type__v\": \"drug__v\",\t       \"event_description__c\": params.event_description__c !=\"\" ? params.event_description__c : \"N/A\" & (params.shelf_life !=\"\" ? \"; Shelf life: \" & params.shelf_life : \"\"),\t       \"keywords__c\": \"clinical_initial_cta__c\",\t       \"rec__c\": rec_id,\t       \"global_application__v\": global_application,\t       \"content_plan_template__v\": \"0EP00000004B425\",\t       \"project_id__c\": study.project_clinical_studies__cr.data[0].project__c\t       \t   }\t]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 190,
        "y": 1560,
        "wires": [
            [
                "4dac18d979dde774"
            ]
        ]
    },
    {
        "id": "a0c278bd43c9d392",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "store result",
        "rules": [
            {
                "t": "set",
                "p": "event_id",
                "pt": "msg",
                "to": "payload.data[0].data.id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 710,
        "y": 1560,
        "wires": [
            [
                "b87bf7a4c50d663b",
                "adee49dc044bbea2"
            ]
        ]
    },
    {
        "id": "16dd3361eb7ce0d4",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "link to product family",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"event_product_family__c\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t   {\t       \"name__v\": event_id & \"_\" & study.product__v,\t       \"event__c\": event_id,\t       \"product_family__c\": study.product__v\t    }\t]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 220,
        "y": 1680,
        "wires": [
            [
                "dc369b349e727f46"
            ]
        ]
    },
    {
        "id": "9adfccf7b2b56294",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "link to products",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"event_drug_product__rim\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t    study.clinical_study_products__cr.data.{\t       \"event__rim\": $$.event_id,\t       \"product_family__c\": product_family__c,\t       \"drug_product__rim\": product__c,\t       \"product_detail__rim\": product_variant__c\t    }\t]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 200,
        "y": 1740,
        "wires": [
            [
                "704b19538a23bbbb"
            ]
        ]
    },
    {
        "id": "a29d31f087a5e74f",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "link to study",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"event_clinical_study__v\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t   {\t       \"event__v\": event_id,\t       \"clinical_study__v\": study_id,\t       \"impd_version_quality_part__c\": params.impd_version_quality_part__c,\t       \"impd_version_nonquality_part__c\": params.impd_version_nonquality_part__c,\t       \"protocol_version__c\": params.protocol_version__c,\t       \"ib_version__c\": params.ib_version__c\t    }\t]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 190,
        "y": 1800,
        "wires": [
            [
                "646de72917b2e936"
            ]
        ]
    },
    {
        "id": "b87bf7a4c50d663b",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 930,
        "y": 1560,
        "wires": []
    },
    {
        "id": "e610822d0af072be",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 930,
        "y": 1680,
        "wires": []
    },
    {
        "id": "31e1f21fd3dbad06",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 910,
        "y": 1740,
        "wires": []
    },
    {
        "id": "65ae0fe8fc738277",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 930,
        "y": 1800,
        "wires": []
    },
    {
        "id": "4dac18d979dde774",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "",
        "x": 440,
        "y": 1560,
        "wires": [
            [
                "a0c278bd43c9d392"
            ],
            [
                "275ebe4c83353954"
            ]
        ]
    },
    {
        "id": "dc369b349e727f46",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "",
        "x": 440,
        "y": 1680,
        "wires": [
            [
                "9adfccf7b2b56294",
                "e610822d0af072be"
            ],
            [
                "275ebe4c83353954"
            ]
        ]
    },
    {
        "id": "704b19538a23bbbb",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "",
        "x": 440,
        "y": 1740,
        "wires": [
            [
                "31e1f21fd3dbad06",
                "a29d31f087a5e74f"
            ],
            [
                "275ebe4c83353954"
            ]
        ]
    },
    {
        "id": "646de72917b2e936",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "",
        "x": 440,
        "y": 1800,
        "wires": [
            [
                "65ae0fe8fc738277",
                "937cbb9741f463b9"
            ],
            [
                "275ebe4c83353954"
            ]
        ]
    },
    {
        "id": "275ebe4c83353954",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "",
        "mode": "link",
        "links": [
            "a1d7e010334dfdd3"
        ],
        "x": 745,
        "y": 1720,
        "wires": []
    },
    {
        "id": "937cbb9741f463b9",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "link to indications",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"event_indication__rim\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t   study.therapeutic_indication_clinical_studies__cr.data.{\t       \"product_family__c\": $$.study.product__v,\t       \"indication__rim\": therapeutic_indication__c,\t       \"event__rim\": $$.event_id\t    }\t]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 210,
        "y": 1860,
        "wires": [
            [
                "610d6bcf4d082900"
            ]
        ]
    },
    {
        "id": "610d6bcf4d082900",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "",
        "x": 440,
        "y": 1860,
        "wires": [
            [
                "7bc4c9683b8274bc",
                "9003a9eb57a9aa3d"
            ],
            [
                "275ebe4c83353954"
            ]
        ]
    },
    {
        "id": "7bc4c9683b8274bc",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 930,
        "y": 1860,
        "wires": []
    },
    {
        "id": "4838544d636b8126",
        "type": "http in",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "",
        "url": "cta-event",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 220,
        "y": 1320,
        "wires": [
            [
                "d021c864dee5eecb",
                "ae93614e24ba3a56"
            ]
        ]
    },
    {
        "id": "ae93614e24ba3a56",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "store parameters",
        "rules": [
            {
                "t": "set",
                "p": "study_id",
                "pt": "msg",
                "to": "payload.study_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "params",
                "pt": "msg",
                "to": "payload",
                "tot": "msg",
                "dc": true
            },
            {
                "t": "set",
                "p": "job.job_scope",
                "pt": "msg",
                "to": "payload.job_scope",
                "tot": "msg",
                "dc": true
            },
            {
                "t": "set",
                "p": "job.job_type",
                "pt": "msg",
                "to": "payload.job_type",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 470,
        "y": 1320,
        "wires": [
            [
                "d5d703ab75216ed7",
                "6a93ae39ab073d95"
            ]
        ]
    },
    {
        "id": "6a93ae39ab073d95",
        "type": "brave-login",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "",
        "x": 690,
        "y": 1320,
        "wires": [
            [
                "9a46815ed62743f5"
            ],
            [
                "275ebe4c83353954"
            ]
        ]
    },
    {
        "id": "d5d703ab75216ed7",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 690,
        "y": 1280,
        "wires": []
    },
    {
        "id": "9003a9eb57a9aa3d",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "restart CTA creation",
        "rules": [
            {
                "t": "set",
                "p": "headers",
                "pt": "msg",
                "to": "{\t   \"location\":\"/nodes/cta/execute?study_id=\" & study_id & \"&event_id=\" & event_id & \"&job_type=\" & job.job_type & \"&job_scope=\" & job.job_scope\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "statusCode",
                "pt": "msg",
                "to": "303",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 210,
        "y": 1920,
        "wires": [
            [
                "cc2dec68746a7c48"
            ]
        ]
    },
    {
        "id": "d021c864dee5eecb",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 450,
        "y": 1280,
        "wires": []
    },
    {
        "id": "9a46815ed62743f5",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "query study",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, study_alias__c, product__v, product__vr.name__v, (select id, name__v, product__c, product__cr.name__v, product_family__c, product_family__cr.name__v, product_variant__c, product_variant__cr.name__v from clinical_study_products__cr), (select id, project__c, project__cr.name__v from project_clinical_studies__cr), (select id, name__v, therapeutic_indication__c, therapeutic_indication__cr.name__v from therapeutic_indication_clinical_studies__cr) from clinical_study__v where id='\" & study_id & \"'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 190,
        "y": 1380,
        "wires": [
            [
                "ce48537993842d01"
            ]
        ]
    },
    {
        "id": "ce48537993842d01",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "",
        "x": 430,
        "y": 1380,
        "wires": [
            [
                "487be070f2dc5c9a"
            ],
            [
                "275ebe4c83353954"
            ]
        ]
    },
    {
        "id": "487be070f2dc5c9a",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "study",
                "pt": "msg",
                "to": "payload.data[0]",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 720,
        "y": 1380,
        "wires": [
            [
                "eedb0e85cc43d225",
                "7773a63cbb806d65"
            ]
        ]
    },
    {
        "id": "eedb0e85cc43d225",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 930,
        "y": 1380,
        "wires": []
    },
    {
        "id": "cc2dec68746a7c48",
        "type": "http response",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 410,
        "y": 1920,
        "wires": []
    },
    {
        "id": "d890c02a1874a2e0",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "create REC",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"regulatory_event_code__c\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t   {\t       \t   }\t]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 190,
        "y": 1500,
        "wires": [
            [
                "7dcf8f4baa80652e"
            ]
        ]
    },
    {
        "id": "7dcf8f4baa80652e",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "",
        "x": 440,
        "y": 1500,
        "wires": [
            [
                "346e9d801d1ffa8d"
            ],
            [
                "275ebe4c83353954"
            ]
        ]
    },
    {
        "id": "823a1fc8bdd1a3e5",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "debug 285",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 950,
        "y": 1500,
        "wires": []
    },
    {
        "id": "346e9d801d1ffa8d",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "store result",
        "rules": [
            {
                "t": "set",
                "p": "rec_id",
                "pt": "msg",
                "to": "payload.data[0].data.id",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 710,
        "y": 1500,
        "wires": [
            [
                "823a1fc8bdd1a3e5",
                "1565440b12069ef1"
            ]
        ]
    },
    {
        "id": "adee49dc044bbea2",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "Create Global Content Plan",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "vault_api & \"v22.2/vobjects/event__rim/\" & event_id &\"/actions/Objectlifecyclestateuseraction.event__rim.planned_state__c.create_global_content_plan_useraction__c\"",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "headers",
                "pt": "msg",
                "to": "{\t   \"Authorization\": session_id,\t   \"Accept\": \"application/json\",\t   \"Content-Type\": \"application/x-www-form-urlencoded\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 240,
        "y": 1620,
        "wires": [
            [
                "19b50a4a81355f3d"
            ]
        ]
    },
    {
        "id": "93a845c0a3f44c59",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "debug 286",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 930,
        "y": 1620,
        "wires": []
    },
    {
        "id": "19b50a4a81355f3d",
        "type": "http request",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 490,
        "y": 1620,
        "wires": [
            [
                "93a845c0a3f44c59",
                "16dd3361eb7ce0d4"
            ]
        ]
    },
    {
        "id": "7773a63cbb806d65",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "query global application",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, product__v, product__vr.name__v from application__v where object_type__vr.api_name__v='global_application__v' and product__v='\" & study.product__v & \"'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 230,
        "y": 1440,
        "wires": [
            [
                "37fc862475dbce73"
            ]
        ]
    },
    {
        "id": "30c274e5bbd50f08",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 970,
        "y": 1440,
        "wires": []
    },
    {
        "id": "38b9bfcbd809e815",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "global_application",
                "pt": "msg",
                "to": "payload.data[0].id",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 760,
        "y": 1440,
        "wires": [
            [
                "30c274e5bbd50f08",
                "d890c02a1874a2e0"
            ]
        ]
    },
    {
        "id": "37fc862475dbce73",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "e4dc8a0d3b3cb6f8",
        "name": "",
        "x": 430,
        "y": 1440,
        "wires": [
            [
                "38b9bfcbd809e815"
            ],
            [
                "275ebe4c83353954"
            ]
        ]
    },
    {
        "id": "e7d6fc8ca841fa9a",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "29b43c9507b8a9bc",
        "name": "query event",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v from event__rim where object_type__vr.api_name__v = 'clinical_study_event__c' and applicable_product_type__v = 'drug__v'and keywords__c = 'clinical_initial_cta__c' and id in (select id from event_clinical_studies__vr where clinical_study__v='\" & study_id & \"')\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 190,
        "y": 1120,
        "wires": [
            [
                "70ab23a321437933",
                "b33b1728cfa4f937"
            ]
        ]
    },
    {
        "id": "70ab23a321437933",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "29b43c9507b8a9bc",
        "name": "",
        "x": 470,
        "y": 1120,
        "wires": [
            [
                "56e9c9847f31a328",
                "2661afcec2409879"
            ],
            [
                "f75af9837491f17f"
            ]
        ]
    },
    {
        "id": "56e9c9847f31a328",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "29b43c9507b8a9bc",
        "name": "exists?",
        "property": "payload.data",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nempty"
            },
            {
                "t": "empty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 690,
        "y": 1120,
        "wires": [
            [
                "d246955bc53f98dd"
            ],
            [
                "f78035f60f3dfdc7"
            ]
        ]
    },
    {
        "id": "f78035f60f3dfdc7",
        "type": "template",
        "z": "2c4527dad914ec1c",
        "g": "29b43c9507b8a9bc",
        "name": "Input Form",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "<!doctype html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"utf-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n    <title>New Clinical Study Event</title>\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css\"\n        integrity=\"sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu\" crossorigin=\"anonymous\">\n    <script src=\"https://code.jquery.com/jquery-1.12.4.min.js\"\n        integrity=\"sha384-nvAa0+6Qg9clwYCGGPpDQLVpLNn0fRaROjHqs13t4Ggj3Ez50XnGQqc/r8MhnRDZ\"\n        crossorigin=\"anonymous\"></script>\n    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js\"\n        integrity=\"sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd\"\n        crossorigin=\"anonymous\"></script>\n</head>\n\n<body>\n    <div class=\"modal fade\" id=\"modal\" tabindex=\"-1\" data-backdrop=\"static\">\n        <div class=\"modal-dialog\">\n            <div class=\"modal-content\">\n                <div class=\"modal-header\">\n                    <h4 class=\"modal-title\">Processing ...</h4>\n                </div>\n                <div class=\"modal-body\">\n                    <p>Please wait while the changes are applied.</p>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"container\">\n        <h1>New Event for Clinical Study {{study.name__v}}</h1>\n        <p>Please provide details for the new Clinical Study Event.</p>\n        <br>\n        <form class=\"form-horizontal\" method=\"post\" action=\"/nodes/cta-event\">\n            <input type=\"hidden\" name=\"study_id\" value=\"{{study_id}}\">\n            <input type=\"hidden\" name=\"job_scope\" value=\"{{job.job_scope}}\">\n            <input type=\"hidden\" name=\"job_type\" value=\"{{job.job_type}}\">\n            <div class=\"form-group\">\n                <label class=\"col-md-4 control-label\" for=\"impd_version_quality_part__c\">IMPD Version Quality Part\n                    Provided</label>\n                <div class=\"col-md-8\">\n                    <input type=\"text\" class=\"form-control\" id=\"impd_version_quality_part__c\"\n                        name=\"impd_version_quality_part__c\">\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label class=\"col-md-4 control-label\" for=\"impd_version_nonquality_part__c\">IMPD Version non- Quality\n                    Part Provided</label>\n                <div class=\"col-md-8\">\n                    <input type=\"text\" class=\"form-control\" id=\"impd_version_nonquality_part__c\"\n                        name=\"impd_version_nonquality_part__c\">\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label class=\"col-md-4 control-label\" for=\"protocol_version__c\">Protocol Version Provided</label>\n                <div class=\"col-md-8\">\n                    <input type=\"text\" class=\"form-control\" id=\"protocol_version__c\" name=\"protocol_version__c\">\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label class=\"col-md-4 control-label\" for=\"ib_version__c\">IB Version Provided</label>\n                <div class=\"col-md-8\">\n                    <input type=\"text\" class=\"form-control\" id=\"ib_version__c\" name=\"ib_version__c\">\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label class=\"col-md-4 control-label\" for=\"shelf_life\">Shelf Life</label>\n                <div class=\"col-md-8\">\n                    <input type=\"text\" class=\"form-control\" id=\"shelf_life\" name=\"shelf_life\">\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label class=\"col-md-4 control-label\" for=\"event_description__c\">Event Desciption</label>\n                <div class=\"col-md-8\">\n                    <input type=\"text\" class=\"form-control\" id=\"event_description__c\" name=\"event_description__c\">\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <div class=\"col-md-offset-4 col-md-8\">\n                    <button type=\"submit\" class=\"btn btn-primary\">Create Clinical Study Event</button>\n                </div>\n            </div>\n        </form>\n    </div>\n\n    <script>\n        $(document).ready(function(){\n            $(\"form\").submit(function() {\n                $(\"#modal\").modal(\"show\");\n            });\n        });\n    </script>\n</body>\n\n</html>",
        "output": "str",
        "x": 870,
        "y": 1160,
        "wires": [
            [
                "f82b3ab5ecb10577"
            ]
        ]
    },
    {
        "id": "f75af9837491f17f",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "29b43c9507b8a9bc",
        "name": "",
        "mode": "link",
        "links": [
            "a1d7e010334dfdd3"
        ],
        "x": 595,
        "y": 1160,
        "wires": []
    },
    {
        "id": "327e267911d56ed7",
        "type": "link in",
        "z": "2c4527dad914ec1c",
        "g": "29b43c9507b8a9bc",
        "name": "link in 3",
        "links": [],
        "x": 145,
        "y": 1060,
        "wires": [
            [
                "e7d6fc8ca841fa9a"
            ]
        ]
    },
    {
        "id": "d246955bc53f98dd",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "29b43c9507b8a9bc",
        "name": "link out 2",
        "mode": "return",
        "links": [],
        "x": 845,
        "y": 1100,
        "wires": []
    },
    {
        "id": "2661afcec2409879",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "29b43c9507b8a9bc",
        "name": "debug 287",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 710,
        "y": 1060,
        "wires": []
    },
    {
        "id": "f82b3ab5ecb10577",
        "type": "http response",
        "z": "2c4527dad914ec1c",
        "g": "29b43c9507b8a9bc",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 970,
        "y": 1120,
        "wires": []
    },
    {
        "id": "b33b1728cfa4f937",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "29b43c9507b8a9bc",
        "name": "debug 288",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 470,
        "y": 1060,
        "wires": []
    },
    {
        "id": "79dc00f87e370be6",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "7352d6de44d315d8",
        "name": "link to products",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"product_application__c\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t    applications ~> $map(function($application) {\t       study.clinical_study_products__cr.data.{\t           \"application__c\": $application.id,\t           \"product_family__c\": product_family__c,\t           \"product__c\": product__c,\t           \"product_variant__c\": product_variant__c\t        }\t    }) ~> $reduce(function($accumulator, $value) {$append($accumulator, $value)})\t]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1400,
        "y": 3180,
        "wires": [
            [
                "1ec6cfe34db7d431"
            ]
        ]
    },
    {
        "id": "a3ca3e44e6958337",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "7352d6de44d315d8",
        "name": "link to study",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"application_clinical_study__c\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "applications.{\t   \"application__c\": id,\t   \"clinical_study__c\": $$.study.id\t}[]\t",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1390,
        "y": 3120,
        "wires": [
            [
                "32afb23ea52e48e9"
            ]
        ]
    },
    {
        "id": "1b36f753f30929bb",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "7352d6de44d315d8",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "application_ids",
                "pt": "msg",
                "to": "payload.data[responseStatus=\"SUCCESS\"].data.id[]",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "created_application_ids",
                "pt": "msg",
                "to": "payload.data[responseStatus=\"SUCCESS\"].data.id[]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1920,
        "y": 2940,
        "wires": [
            [
                "9715c1f72c64ad49",
                "bf78181027710cc5"
            ]
        ]
    },
    {
        "id": "bf78181027710cc5",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "7352d6de44d315d8",
        "name": "query applications",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, lead_market__rim from application__v where \" & (application_ids ~> $map(function($v) {\"id='\" & $v & \"'\"}) ~> $join(\" OR \"))",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1410,
        "y": 3000,
        "wires": [
            [
                "8ab0417a5926e9fd"
            ]
        ]
    },
    {
        "id": "fce32955635296b4",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "7352d6de44d315d8",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "applications",
                "pt": "msg",
                "to": "payload.data",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1940,
        "y": 3000,
        "wires": [
            [
                "a21a1989e6a49e7e",
                "193a81253fe4730e"
            ]
        ]
    },
    {
        "id": "9715c1f72c64ad49",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "7352d6de44d315d8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2170,
        "y": 2940,
        "wires": []
    },
    {
        "id": "a21a1989e6a49e7e",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "7352d6de44d315d8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2170,
        "y": 3000,
        "wires": []
    },
    {
        "id": "163b00cb684085db",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "7352d6de44d315d8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2170,
        "y": 3120,
        "wires": []
    },
    {
        "id": "a81a36e30b94e259",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "7352d6de44d315d8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2170,
        "y": 3180,
        "wires": []
    },
    {
        "id": "c6b211f4e9d6c341",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "7352d6de44d315d8",
        "name": "",
        "x": 1640,
        "y": 2940,
        "wires": [
            [
                "1b36f753f30929bb"
            ],
            [
                "27b2616ea773d52f"
            ]
        ]
    },
    {
        "id": "32afb23ea52e48e9",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "7352d6de44d315d8",
        "name": "",
        "x": 1640,
        "y": 3120,
        "wires": [
            [
                "79dc00f87e370be6",
                "163b00cb684085db"
            ],
            [
                "27b2616ea773d52f"
            ]
        ]
    },
    {
        "id": "1ec6cfe34db7d431",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "7352d6de44d315d8",
        "name": "",
        "x": 1640,
        "y": 3180,
        "wires": [
            [
                "a81a36e30b94e259",
                "3b7cad86dd37a146"
            ],
            [
                "27b2616ea773d52f"
            ]
        ]
    },
    {
        "id": "27b2616ea773d52f",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "7352d6de44d315d8",
        "name": "",
        "mode": "link",
        "links": [
            "a1d7e010334dfdd3"
        ],
        "x": 1865,
        "y": 3240,
        "wires": []
    },
    {
        "id": "8ab0417a5926e9fd",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "7352d6de44d315d8",
        "name": "",
        "x": 1630,
        "y": 3000,
        "wires": [
            [
                "fce32955635296b4"
            ],
            [
                "27b2616ea773d52f"
            ]
        ]
    },
    {
        "id": "3b7cad86dd37a146",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "7352d6de44d315d8",
        "name": "link to indications",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"application_indication__rim\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t    applications ~> $map(function($application) {\t       study.therapeutic_indication_clinical_studies__cr.data.{\t           \"therapeutic_indication__rim\": therapeutic_indication__c,\t           \"application__rim\": $application.id\t        }\t    }) ~> $reduce(function($accumulator, $value) {$append($accumulator, $value)})\t]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1410,
        "y": 3240,
        "wires": [
            [
                "3d7304f437ac546e"
            ]
        ]
    },
    {
        "id": "3d7304f437ac546e",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "7352d6de44d315d8",
        "name": "",
        "x": 1640,
        "y": 3240,
        "wires": [
            [
                "3a8ebaf7d483bbd4",
                "2ebc5c6d445f1138"
            ],
            [
                "27b2616ea773d52f"
            ]
        ]
    },
    {
        "id": "3a8ebaf7d483bbd4",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "7352d6de44d315d8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2170,
        "y": 3240,
        "wires": []
    },
    {
        "id": "23738ff3d5c6de63",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "7352d6de44d315d8",
        "name": "create applications",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"application__v\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "Application_country",
                "pt": "msg",
                "to": "$append(lead_country,countries)",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Application_country.{\t   \"name__v\": \"cta_\" & $millis() & \"_\" & country_code,\t   \"object_type__vr.api_name__v\": \"investigational_application__c\",\t   \"domain__vr.name__v\": \"Human use\",\t   \"lead_market__rim\": country_id,\t   \"region__v\": region_id,\t   \"product__v\": $$.study.product__v,\t   \"applicable_product_type__v\": \"drug__v\",\t   \"application_type__rim\": application_type_id,\t   \"clinical_study__c\": $$.study.id,\t   \"publishing_hub__c\": \"ctis_submission_management__c\"\t}[]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1410,
        "y": 2940,
        "wires": [
            [
                "c6b211f4e9d6c341"
            ]
        ]
    },
    {
        "id": "193a81253fe4730e",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "7352d6de44d315d8",
        "name": "rename Application",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "vault_api & \"v22.2/vobjects/application__v\"",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "headers",
                "pt": "msg",
                "to": "{\t   \"Authorization\": session_id,\t   \"Accept\": \"application/json\",\t   \"Content-Type\": \"application/json\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "applications.{\t   \"id\": id,\t   \"name__v\": $substringBefore(name__v,\" - ##\")\t}[]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1410,
        "y": 3060,
        "wires": [
            [
                "f976c52a47cce42e"
            ]
        ]
    },
    {
        "id": "eead4d84f542e524",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "7352d6de44d315d8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2170,
        "y": 3060,
        "wires": []
    },
    {
        "id": "42452a39b395d8e8",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "7352d6de44d315d8",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "cont",
                "v": "SUCCESS",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1890,
        "y": 3060,
        "wires": [
            [
                "a3ca3e44e6958337",
                "eead4d84f542e524"
            ],
            [
                "27b2616ea773d52f"
            ]
        ]
    },
    {
        "id": "c4148dbf29ced4c0",
        "type": "template",
        "z": "2c4527dad914ec1c",
        "g": "2e5e59eac091f6b6",
        "name": "Input Form",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "<!doctype html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"utf-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n    <title>Defining scope</title>\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css\"\n        integrity=\"sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu\" crossorigin=\"anonymous\">\n    <script src=\"https://code.jquery.com/jquery-1.12.4.min.js\"\n        integrity=\"sha384-nvAa0+6Qg9clwYCGGPpDQLVpLNn0fRaROjHqs13t4Ggj3Ez50XnGQqc/r8MhnRDZ\"\n        crossorigin=\"anonymous\"></script>\n    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js\"\n        integrity=\"sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd\"\n        crossorigin=\"anonymous\"></script>\n</head>\n\n<body>\n    <div class=\"modal fade\" id=\"modal\" tabindex=\"-1\" data-backdrop=\"static\">\n        <div class=\"modal-dialog\">\n            <div class=\"modal-content\">\n                <div class=\"modal-header\">\n                    <h4 class=\"modal-title\">Processing ...</h4>\n                </div>\n                <div class=\"modal-body\">\n                    <p>Please wait while the changes are applied.</p>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"container\">\n        <h1>Please specify if you need to create EU CTR Application for the study {{study.name__v}}</h1>\n        <p> </p>\n        <br>\n        <form class=\"form-horizontal\" method=\"post\" action=\"/nodes/cta/cms\">\n            <input type=\"hidden\" name=\"study_id\" value=\"{{study_id}}\">\n            <input type=\"hidden\" name=\"job_type\" value=\"{{job.job_type}}\">\n            <input type=\"hidden\" name=\"job_scope\" value=\"{{job.job_scope}}\">\n            <input type=\"hidden\" name=\"created_event_id\" value=\"{{created_event_id}}\">\n            <div class=\"form-group\">\n                <div class=\"col-md-offset-4 col-md-8\">\n                    <button type=\"submit\" class=\"btn btn-primary\">Yes</button>\n                </div>\n            </div>\n        </form>\n        <form class=\"form-horizontal\" method=\"post\" action=\"/nodes/cta/ctd\">\n            <input type=\"hidden\" name=\"study_id\" value=\"{{study_id}}\">\n            <input type=\"hidden\" name=\"job_type\" value=\"{{job.job_type}}\">\n            <input type=\"hidden\" name=\"job_scope\" value=\"{{job.job_scope}}\">\n            <input type=\"hidden\" name=\"created_event_id\" value=\"{{created_event_id}}\">\n            <div class=\"form-group\">\n                <div class=\"col-md-offset-4 col-md-8\">\n                    <button type=\"submit\" class=\"btn btn-primary\">No</button>\n                </div>\n            </div>\n        </form>\n    </div>\n\n    <script>\n        $(document).ready(function(){\n            $(\"form\").submit(function() {\n                $(\"#modal\").modal(\"show\");\n            });\n        });\n    </script>\n</body>\n\n</html>",
        "output": "str",
        "x": 1470,
        "y": 1060,
        "wires": [
            [
                "598037ac92ad64cd"
            ]
        ]
    },
    {
        "id": "598037ac92ad64cd",
        "type": "http response",
        "z": "2c4527dad914ec1c",
        "g": "2e5e59eac091f6b6",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 1630,
        "y": 1060,
        "wires": []
    },
    {
        "id": "23bdf07343944511",
        "type": "link in",
        "z": "2c4527dad914ec1c",
        "g": "2e5e59eac091f6b6",
        "name": "To create Application",
        "links": [],
        "x": 1335,
        "y": 1060,
        "wires": [
            [
                "c4148dbf29ced4c0"
            ]
        ]
    },
    {
        "id": "63be4dd09ce5c341",
        "type": "http in",
        "z": "2c4527dad914ec1c",
        "g": "44e871b1bae7c620",
        "name": "",
        "url": "cta/app_country",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 1440,
        "y": 2380,
        "wires": [
            [
                "e34086576e2a64ad"
            ]
        ]
    },
    {
        "id": "b0fc88afbb33c1a0",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "44e871b1bae7c620",
        "name": "query study",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, study_alias__c, product__v, product__vr.name__v, (select id, name__v, product__c, product__cr.name__v, product_family__c, product_family__cr.name__v, product_variant__c, product_variant__cr.name__v from clinical_study_products__cr), (select id, name__v, therapeutic_indication__c, therapeutic_indication__cr.name__v from therapeutic_indication_clinical_studies__cr) from clinical_study__v where id='\" & study_id & \"'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2230,
        "y": 2680,
        "wires": [
            [
                "0afe761b64cbb329"
            ]
        ]
    },
    {
        "id": "0315c803b9a7cf50",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "44e871b1bae7c620",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "study",
                "pt": "msg",
                "to": "payload.data[0]",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2680,
        "y": 2680,
        "wires": [
            [
                "cae06e1193aaaf99",
                "a2e04219e8b4b9cb"
            ]
        ]
    },
    {
        "id": "72026368a96a09a2",
        "type": "split",
        "z": "2c4527dad914ec1c",
        "g": "44e871b1bae7c620",
        "name": "for each country",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 2460,
        "y": 2560,
        "wires": [
            [
                "b40c9dba22cbc868"
            ]
        ]
    },
    {
        "id": "3206f3c1f1e0735a",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "44e871b1bae7c620",
        "name": "store parameters",
        "rules": [
            {
                "t": "set",
                "p": "study_id",
                "pt": "msg",
                "to": "payload.study_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "countries",
                "pt": "msg",
                "to": "payload.response_full[]",
                "tot": "jsonata",
                "dc": true
            },
            {
                "t": "set",
                "p": "cms_countries_string",
                "pt": "msg",
                "to": "payload.cms_countries",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "lead_country_string",
                "pt": "msg",
                "to": "payload.lead_country",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "client_id",
                "pt": "msg",
                "to": "cta-automation",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "job.job_scope",
                "pt": "msg",
                "to": "payload.job_scope",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "job.job_type",
                "pt": "msg",
                "to": "payload.job_type",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "created_event_id",
                "pt": "msg",
                "to": "payload.created_event_id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1990,
        "y": 2380,
        "wires": [
            [
                "2bd9708f4077eae8"
            ]
        ]
    },
    {
        "id": "b40c9dba22cbc868",
        "type": "json",
        "z": "2c4527dad914ec1c",
        "g": "44e871b1bae7c620",
        "name": "json to object",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 2230,
        "y": 2620,
        "wires": [
            [
                "308ce12f61ee6030"
            ]
        ]
    },
    {
        "id": "308ce12f61ee6030",
        "type": "join",
        "z": "2c4527dad914ec1c",
        "g": "44e871b1bae7c620",
        "name": "",
        "mode": "auto",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": true,
        "timeout": "",
        "count": "",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 2390,
        "y": 2620,
        "wires": [
            [
                "fcf74b442ee22766"
            ]
        ]
    },
    {
        "id": "4cae53dc94434e4e",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "44e871b1bae7c620",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2910,
        "y": 2620,
        "wires": []
    },
    {
        "id": "2d0f771410e3e36a",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "44e871b1bae7c620",
        "name": "parse countries",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "countries",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2240,
        "y": 2560,
        "wires": [
            [
                "72026368a96a09a2"
            ]
        ]
    },
    {
        "id": "cae06e1193aaaf99",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "44e871b1bae7c620",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2910,
        "y": 2680,
        "wires": []
    },
    {
        "id": "fcf74b442ee22766",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "44e871b1bae7c620",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "countries",
                "pt": "msg",
                "to": "payload",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2550,
        "y": 2620,
        "wires": [
            [
                "4cae53dc94434e4e",
                "b0fc88afbb33c1a0"
            ]
        ]
    },
    {
        "id": "2bd9708f4077eae8",
        "type": "brave-login",
        "z": "2c4527dad914ec1c",
        "g": "44e871b1bae7c620",
        "name": "",
        "x": 2210,
        "y": 2380,
        "wires": [
            [
                "692cec66a76c12c1",
                "235a0c53b800fc4a"
            ],
            [
                "b351bb84c353b4f3"
            ]
        ]
    },
    {
        "id": "814b7282a5575644",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "44e871b1bae7c620",
        "name": "",
        "mode": "link",
        "links": [
            "a1d7e010334dfdd3"
        ],
        "x": 2625,
        "y": 2820,
        "wires": []
    },
    {
        "id": "0afe761b64cbb329",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "44e871b1bae7c620",
        "name": "",
        "x": 2450,
        "y": 2680,
        "wires": [
            [
                "0315c803b9a7cf50"
            ],
            [
                "814b7282a5575644"
            ]
        ]
    },
    {
        "id": "a2e04219e8b4b9cb",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "44e871b1bae7c620",
        "name": "query event",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, event_description__c, (select id, impd_version_nonquality_part__c, impd_version_quality_part__c, protocol_version__c, ib_version__c from event_clinical_studies__vr) from event__rim where object_type__vr.api_name__v = 'clinical_study_event__c' and applicable_product_type__v = 'drug__v'and keywords__c = 'clinical_initial_cta__c' and id in (select id from event_clinical_studies__vr where clinical_study__v='\" & study_id & \"')\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2230,
        "y": 2740,
        "wires": [
            [
                "3da61cdc6873fd1f"
            ]
        ]
    },
    {
        "id": "3da61cdc6873fd1f",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "44e871b1bae7c620",
        "name": "",
        "x": 2450,
        "y": 2740,
        "wires": [
            [
                "36dc00761631f425"
            ],
            [
                "814b7282a5575644"
            ]
        ]
    },
    {
        "id": "36dc00761631f425",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "44e871b1bae7c620",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "event",
                "pt": "msg",
                "to": "payload.data[0]",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2680,
        "y": 2740,
        "wires": [
            [
                "f40586315f069e51",
                "23738ff3d5c6de63"
            ]
        ]
    },
    {
        "id": "f40586315f069e51",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "44e871b1bae7c620",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2910,
        "y": 2740,
        "wires": []
    },
    {
        "id": "639144debba161a8",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "44e871b1bae7c620",
        "name": "parse Lead country",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "lead_country_string",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1550,
        "y": 2440,
        "wires": [
            [
                "aaf9d1d169a58400"
            ]
        ]
    },
    {
        "id": "ac3c2bcf8dcd4883",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "44e871b1bae7c620",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "lead_country",
                "pt": "msg",
                "to": "payload",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2260,
        "y": 2440,
        "wires": [
            [
                "095f93b72d3bf820",
                "c51f3bb8d2848e6b"
            ]
        ]
    },
    {
        "id": "aaf9d1d169a58400",
        "type": "split",
        "z": "2c4527dad914ec1c",
        "g": "44e871b1bae7c620",
        "name": "for each country",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1760,
        "y": 2440,
        "wires": [
            [
                "45d0215e41dff0ab"
            ]
        ]
    },
    {
        "id": "c51f3bb8d2848e6b",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "44e871b1bae7c620",
        "name": "parse CMS countries",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "cms_countries_string",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1560,
        "y": 2500,
        "wires": [
            [
                "a1af548a44f34861"
            ]
        ]
    },
    {
        "id": "a1af548a44f34861",
        "type": "json",
        "z": "2c4527dad914ec1c",
        "g": "44e871b1bae7c620",
        "name": "json to object",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 1750,
        "y": 2500,
        "wires": [
            [
                "e7f0fb926f966d3e"
            ]
        ]
    },
    {
        "id": "45d0215e41dff0ab",
        "type": "json",
        "z": "2c4527dad914ec1c",
        "g": "44e871b1bae7c620",
        "name": "json to object",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 1970,
        "y": 2440,
        "wires": [
            [
                "ac3c2bcf8dcd4883"
            ]
        ]
    },
    {
        "id": "e7f0fb926f966d3e",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "44e871b1bae7c620",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "cms_countries",
                "pt": "msg",
                "to": "payload",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1980,
        "y": 2500,
        "wires": [
            [
                "60b9429f386a55ca",
                "d304a0fb3ea8a5d8"
            ]
        ]
    },
    {
        "id": "60b9429f386a55ca",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "44e871b1bae7c620",
        "name": "msg",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2470,
        "y": 2500,
        "wires": []
    },
    {
        "id": "095f93b72d3bf820",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "44e871b1bae7c620",
        "name": "msg",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2470,
        "y": 2440,
        "wires": []
    },
    {
        "id": "d304a0fb3ea8a5d8",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "44e871b1bae7c620",
        "name": "Check if non_CTR countries are selected",
        "property": "payload.countries",
        "propertyType": "msg",
        "rules": [
            {
                "t": "jsonata_exp",
                "v": "$exists(countries)",
                "vt": "jsonata"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1940,
        "y": 2560,
        "wires": [
            [
                "2d0f771410e3e36a"
            ],
            [
                "1d26e25a22ede841"
            ]
        ]
    },
    {
        "id": "1d26e25a22ede841",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "44e871b1bae7c620",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "countries",
                "pt": "msg",
                "to": "[]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1550,
        "y": 2620,
        "wires": [
            [
                "4fb49a8801532b08",
                "b0fc88afbb33c1a0"
            ]
        ]
    },
    {
        "id": "4fb49a8801532b08",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "44e871b1bae7c620",
        "name": "debug 289",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1770,
        "y": 2720,
        "wires": []
    },
    {
        "id": "e34086576e2a64ad",
        "type": "json",
        "z": "2c4527dad914ec1c",
        "g": "44e871b1bae7c620",
        "name": "resp_full",
        "property": "payload.response_full",
        "action": "obj",
        "pretty": false,
        "x": 1740,
        "y": 2380,
        "wires": [
            [
                "3206f3c1f1e0735a"
            ]
        ]
    },
    {
        "id": "692cec66a76c12c1",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "44e871b1bae7c620",
        "name": "debug 290",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2490,
        "y": 2380,
        "wires": []
    },
    {
        "id": "235a0c53b800fc4a",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "44e871b1bae7c620",
        "name": "",
        "property": "lead_country_string",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nempty"
            },
            {
                "t": "empty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1370,
        "y": 2440,
        "wires": [
            [
                "639144debba161a8"
            ],
            [
                "97b21bfa8be4c5b6"
            ]
        ]
    },
    {
        "id": "97b21bfa8be4c5b6",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "44e871b1bae7c620",
        "name": "Clear lead & cms country",
        "rules": [
            {
                "t": "set",
                "p": "lead_country",
                "pt": "msg",
                "to": "[]",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "cms_countries",
                "pt": "msg",
                "to": "[]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1570,
        "y": 2560,
        "wires": [
            [
                "d304a0fb3ea8a5d8"
            ]
        ]
    },
    {
        "id": "c3b45f5d98bdac5d",
        "type": "http response",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 2110,
        "y": 2260,
        "wires": []
    },
    {
        "id": "07ba54e9b76ea2dd",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "set msg.application_types",
        "rules": [
            {
                "t": "set",
                "p": "application_types",
                "pt": "msg",
                "to": "$distinct(payload.data).{\t   \"country_id\": country__rim,\t   \"country_name\": `country__rimr.name__v`,\t   \"country_code\": `country__rimr.country_code__rim`,\t   \"region_id\": region__rim,\t   \"region_name\": `region__rimr.name__v`,\t   \"application_type_id\": cv_1__rim,\t   \"application_type\": `cv_1__rimr.name__v`\t} ~> $filter(function($v) {\t    $v.region_name = \"European Union\" and $v.application_type != \"CTA Regulation\" and $v.application_type != \"Paediatric Investigation Plan (PIP)\" and $v.application_type != \"Orphan Drug Designation Application\"or\t    $v.country_name = \"United States\" and $v.application_type = \"Investigational New Drug (IND)\" or\t    $v.region_name != \"European Union\" and $v.country_name != \"United States\" and $v.application_type != \"Paediatric Investigation Plan (PIP)\"\t})",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "full_application_types",
                "pt": "msg",
                "to": "application_types[country_id=null]\t/* Replace null countries with a list of all countries in that region */\t~> $map(function($t) {$.countries[region_id=$t.region_id] ~> $map(function($c) {$merge([$t,$c])})})\t/* Reduce list of lists to single list */\t~> $reduce(function($i, $v) { $append($i, $v) })\t/* Join with non-null countries */\t~> $append(application_types[country_id!=null])\t/* Filter out already existing applications */\t/* by using the Countries in Lead Country*/\t~> $filter(function($v) {$count(applications[lead_market__rim=$v.country_id and application_type__rim=$v.application_type_id])=0})\t/* by using the Countries in Application Country join*/\t~> $filter(function($v) {$count(application_countries[country__rim=$v.country_id and `application__rimr.application_type__rim`=$v.application_type_id])=0})\t/* Filter out Common (EU) and Common (GCC) */\t~> $filter(function($v) {$v.country_name != \"Common (EU)\" and $v.country_name != \"Common (GCC)\"})\t/* Sort by name */\t~> $sort(function($l, $r) {$l.country_name > $r.country_name})\t",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2170,
        "y": 2180,
        "wires": [
            [
                "fd754c253fa76273",
                "ade26af0922ee143"
            ]
        ]
    },
    {
        "id": "5033a94f248d3ec6",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2650,
        "y": 2240,
        "wires": []
    },
    {
        "id": "cb792cb3a882cf6d",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "countries",
                "pt": "msg",
                "to": "payload.data.{\t   \"country_id\": id,\t   \"country_name\": name__v,\t   \"country_code\": country_code__rim,\t   \"region_id\": region__v,\t   \"region_name\": `region__vr.name__v`\t}",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2150,
        "y": 2000,
        "wires": [
            [
                "5323f5fa282e6d4b",
                "9a6e0cbda2147e1e"
            ]
        ]
    },
    {
        "id": "5323f5fa282e6d4b",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2650,
        "y": 1980,
        "wires": []
    },
    {
        "id": "fd754c253fa76273",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2650,
        "y": 2180,
        "wires": []
    },
    {
        "id": "2c718837889be13f",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "",
        "x": 1930,
        "y": 2000,
        "wires": [
            [
                "cb792cb3a882cf6d"
            ],
            [
                "b351bb84c353b4f3"
            ]
        ]
    },
    {
        "id": "35dad220fe453b94",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "",
        "x": 1930,
        "y": 2180,
        "wires": [
            [
                "07ba54e9b76ea2dd"
            ],
            [
                "b351bb84c353b4f3"
            ]
        ]
    },
    {
        "id": "916991213130f0b6",
        "type": "brave-input-form",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "",
        "x": 1930,
        "y": 2240,
        "wires": [
            [
                "c3b45f5d98bdac5d",
                "5033a94f248d3ec6"
            ]
        ]
    },
    {
        "id": "c4a455daa0eea8b3",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "",
        "x": 1930,
        "y": 2120,
        "wires": [
            [
                "9f8e098d2849aa2f"
            ],
            [
                "b351bb84c353b4f3"
            ]
        ]
    },
    {
        "id": "9f8e098d2849aa2f",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "applications",
                "pt": "msg",
                "to": "payload.data",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2160,
        "y": 2120,
        "wires": [
            [
                "a62e4b4d64a2b9b2",
                "489f4664c01b7352"
            ]
        ]
    },
    {
        "id": "489f4664c01b7352",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2650,
        "y": 2120,
        "wires": []
    },
    {
        "id": "687bcf3e9aa2c2a3",
        "type": "brave-login",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "",
        "x": 2410,
        "y": 1780,
        "wires": [
            [
                "00dd4fbe51c029e6",
                "7c371cb10c3dab09"
            ],
            [
                "dd8842491a14509c"
            ]
        ]
    },
    {
        "id": "027533d7f1212d3e",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "store parameters",
        "rules": [
            {
                "t": "set",
                "p": "study_id",
                "pt": "msg",
                "to": "payload.study_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "event_id",
                "pt": "msg",
                "to": "payload.event_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "cms_countries_string",
                "pt": "msg",
                "to": "payload.response_full[]",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "lead_country_string",
                "pt": "msg",
                "to": "payload.lead_country",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "client_id",
                "pt": "msg",
                "to": "cta-automation",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "job.job_type",
                "pt": "msg",
                "to": "payload.job_type",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "job.job_scope",
                "pt": "msg",
                "to": "payload.job_scope",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "created_event_id",
                "pt": "msg",
                "to": "payload.created_event_id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2150,
        "y": 1780,
        "wires": [
            [
                "687bcf3e9aa2c2a3"
            ]
        ]
    },
    {
        "id": "dbb7083b5406891f",
        "type": "split",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "for each country",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1940,
        "y": 1840,
        "wires": [
            [
                "10480a94b49c21f4"
            ]
        ]
    },
    {
        "id": "10480a94b49c21f4",
        "type": "json",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "json to object",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 2130,
        "y": 1840,
        "wires": [
            [
                "e521a704d9bac1ab"
            ]
        ]
    },
    {
        "id": "e521a704d9bac1ab",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "lead_country",
                "pt": "msg",
                "to": "payload",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2460,
        "y": 1840,
        "wires": [
            [
                "af1cd65bf3bafe37",
                "7f713bd2df926ab1"
            ]
        ]
    },
    {
        "id": "af1cd65bf3bafe37",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "msg",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2650,
        "y": 1840,
        "wires": []
    },
    {
        "id": "f1fb0ef678bfce17",
        "type": "split",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "for each country",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1940,
        "y": 1900,
        "wires": [
            [
                "728887161d445a67"
            ]
        ]
    },
    {
        "id": "728887161d445a67",
        "type": "json",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "json to object",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 2130,
        "y": 1900,
        "wires": [
            [
                "679b90afc5ef4d8b"
            ]
        ]
    },
    {
        "id": "679b90afc5ef4d8b",
        "type": "join",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "",
        "mode": "auto",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": true,
        "timeout": "",
        "count": "",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 2290,
        "y": 1900,
        "wires": [
            [
                "1a581b37f886fe19"
            ]
        ]
    },
    {
        "id": "1a581b37f886fe19",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "cms_countries",
                "pt": "msg",
                "to": "payload",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2460,
        "y": 1900,
        "wires": [
            [
                "d7314dc8efb4b0a3",
                "690a1796de0e6d1c"
            ]
        ]
    },
    {
        "id": "690a1796de0e6d1c",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "msg",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2650,
        "y": 1900,
        "wires": []
    },
    {
        "id": "92e9f14f2867eaf7",
        "type": "http in",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "",
        "url": "cta/ctd",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 1410,
        "y": 1780,
        "wires": [
            [
                "6d6502cd1def83cd"
            ]
        ]
    },
    {
        "id": "00dd4fbe51c029e6",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "parse Lead country",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "lead_country_string",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1670,
        "y": 1840,
        "wires": [
            [
                "dbb7083b5406891f"
            ]
        ]
    },
    {
        "id": "7f713bd2df926ab1",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "parse CMS countries",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "cms_countries_string",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1680,
        "y": 1900,
        "wires": [
            [
                "f1fb0ef678bfce17"
            ]
        ]
    },
    {
        "id": "d7314dc8efb4b0a3",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "query countries",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, country_code__rim, region__v, region__vr.name__v from country__v where status__v = 'active__v' and id !='\" & $.lead_country[0].country_id & \"' AND \" & (cms_countries.country_id ~> $map(function($v) {\"id!='\" & $v & \"'\"}) ~> $join(\" AND \"))",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1660,
        "y": 1960,
        "wires": [
            [
                "2c718837889be13f"
            ]
        ]
    },
    {
        "id": "e810c2f13748f253",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "query existing applications",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v,lead_market__rim, application_type__rim from application__v where clinical_study__c = '\" & study_id & \"'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1700,
        "y": 2120,
        "wires": [
            [
                "c4a455daa0eea8b3"
            ]
        ]
    },
    {
        "id": "a62e4b4d64a2b9b2",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "query application types",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "SELECT country__rim, country__rimr.name__v, country__rimr.country_code__rim, region__rim, region__rimr.name__v, cv_1__rim, cv_1__rimr.name__v FROM constraint__rim WHERE applicable_product_type__v = 'drug__v' AND constraint_scope__v = 'investigational__c' AND status__v = 'active__v' AND cv_1__rimr.controlled_vocabulary_type__rim = 'application_type__rim' AND cv_1__rimr.status__v = 'active__v'",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1680,
        "y": 2180,
        "wires": [
            [
                "35dad220fe453b94"
            ]
        ]
    },
    {
        "id": "ade26af0922ee143",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "set fields for input form",
        "rules": [
            {
                "t": "set",
                "p": "title",
                "pt": "msg",
                "to": "Please select the target countries for new CTAs",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "type",
                "pt": "msg",
                "to": "checkbox",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "description",
                "pt": "msg",
                "to": "\"For Study \" & flow.study.name__v & \" \" & study.study_alias__c & \". Leave empty if not applicable.\"",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "tableheader",
                "pt": "msg",
                "to": "{\"columns\":[\"Country\",\"Region\",\"Application Type\"]}",
                "tot": "json"
            },
            {
                "t": "set",
                "p": "dataarray",
                "pt": "msg",
                "to": "full_application_types.{\t   \"selection\": $string(),\t   \"columns\": [\t       country_name,\t       region_name,\t       application_type\t   ]\t}",
                "tot": "jsonata",
                "dc": true
            },
            {
                "t": "set",
                "p": "flow",
                "pt": "msg",
                "to": "nodes/cta/app_country",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "hiddenfields",
                "pt": "msg",
                "to": "[\t   {\t       \"name\": \"study_id\",\t       \"value\": study_id\t    },\t    {\t        \"name\": \"lead_country\",\t        \"value\": $string(lead_country)\t    },\t    {\t        \"name\": \"cms_countries\",\t        \"value\": $string(cms_countries)\t    },\t    {\t        \"name\": \"event_id\",\t        \"value\": event_id\t    },\t    {\t        \"name\": \"created_event_id\",\t        \"value\": created_event_id\t    },\t    {\t        \"name\": \"job_type\",\t        \"value\": job.job_type\t    },\t    {\t        \"name\": \"job_scope\",\t        \"value\": job.job_scope\t    }\t\t]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1680,
        "y": 2240,
        "wires": [
            [
                "916991213130f0b6"
            ]
        ]
    },
    {
        "id": "2e23ebd064472974",
        "type": "json",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "resp_full",
        "property": "payload.response_full",
        "action": "obj",
        "pretty": false,
        "x": 1920,
        "y": 1780,
        "wires": [
            [
                "027533d7f1212d3e"
            ]
        ]
    },
    {
        "id": "b351bb84c353b4f3",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "link out 3",
        "mode": "link",
        "links": [
            "a1d7e010334dfdd3"
        ],
        "x": 2325,
        "y": 2260,
        "wires": []
    },
    {
        "id": "6d6502cd1def83cd",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "CTR?",
        "property": "payload.lead_country",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nnull"
            },
            {
                "t": "null"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1630,
        "y": 1780,
        "wires": [
            [
                "2e23ebd064472974"
            ],
            [
                "a1d0dd4eb8365192"
            ]
        ]
    },
    {
        "id": "d87f178a0e39e5be",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "query countries",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, country_code__rim, region__v, region__vr.name__v from country__v where status__v = 'active__v'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1660,
        "y": 2000,
        "wires": [
            [
                "2c718837889be13f"
            ]
        ]
    },
    {
        "id": "278b0710d6e4d674",
        "type": "brave-login",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "",
        "x": 1370,
        "y": 2020,
        "wires": [
            [
                "d87f178a0e39e5be"
            ],
            [
                "dd8842491a14509c"
            ]
        ]
    },
    {
        "id": "a1d0dd4eb8365192",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "store parameters",
        "rules": [
            {
                "t": "set",
                "p": "study_id",
                "pt": "msg",
                "to": "payload.study_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "cms_countries_string",
                "pt": "msg",
                "to": "payload.response_full[]",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "lead_country_string",
                "pt": "msg",
                "to": "payload.lead_country",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "client_id",
                "pt": "msg",
                "to": "cta-automation",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "job.job_scope",
                "pt": "msg",
                "to": "payload.job_scope",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "job.job_type",
                "pt": "msg",
                "to": "payload.job_type",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "created_event_id",
                "pt": "msg",
                "to": "payload.created_event_id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1410,
        "y": 1900,
        "wires": [
            [
                "278b0710d6e4d674"
            ]
        ]
    },
    {
        "id": "9a6e0cbda2147e1e",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "query study",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, study_alias__c, product__v, product__vr.name__v, (select id, name__v, product__c, product__cr.name__v, product_family__c, product_family__cr.name__v, product_variant__c, product_variant__cr.name__v from clinical_study_products__cr), (select id, name__v, therapeutic_indication__c, therapeutic_indication__cr.name__v from therapeutic_indication_clinical_studies__cr) from clinical_study__v where id='\" & study_id & \"'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1650,
        "y": 2060,
        "wires": [
            [
                "dfb12041a0a66a3c"
            ]
        ]
    },
    {
        "id": "dfb12041a0a66a3c",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "",
        "x": 1930,
        "y": 2060,
        "wires": [
            [
                "c99b838874d141cd"
            ],
            [
                "b351bb84c353b4f3"
            ]
        ]
    },
    {
        "id": "c99b838874d141cd",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "study",
                "pt": "msg",
                "to": "payload.data[0]",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2140,
        "y": 2060,
        "wires": [
            [
                "dd550a90dd0aabaf",
                "e810c2f13748f253"
            ]
        ]
    },
    {
        "id": "dd550a90dd0aabaf",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2650,
        "y": 2060,
        "wires": []
    },
    {
        "id": "7c371cb10c3dab09",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "418698a9468db53e",
        "name": "debug 291",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2670,
        "y": 1780,
        "wires": []
    },
    {
        "id": "18d6266e97652570",
        "type": "http response",
        "z": "2c4527dad914ec1c",
        "g": "60c0de94d312a065",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 2170,
        "y": 1640,
        "wires": []
    },
    {
        "id": "2e16cd83e26cf93b",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "60c0de94d312a065",
        "name": "set msg.application_types",
        "rules": [
            {
                "t": "set",
                "p": "application_types",
                "pt": "msg",
                "to": "$distinct(payload.data).{\t   \"country_id\": country__rim,\t   \"country_name\": `country__rimr.name__v`,\t   \"country_code\": `country__rimr.country_code__rim`,\t   \"region_id\": region__rim,\t   \"region_name\": `region__rimr.name__v`,\t   \"application_type_id\": cv_1__rim,\t   \"application_type\": `cv_1__rimr.name__v`\t} ~> $filter(function($v) {\t    $v.region_name = \"European Union\" and $v.application_type = \"CTA Regulation\" and $v.country_id !=$.lead_country.country_id\t})",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "full_application_types",
                "pt": "msg",
                "to": "application_types[country_id=null]\t/* Replace null countries with a list of all countries in that region */\t~> $map(function($t) {$.countries[region_id=$t.region_id] ~> $map(function($c) {$merge([$t,$c])})})\t/* Reduce list of lists to single list */\t~> $reduce(function($i, $v) { $append($i, $v) })\t/* Join with non-null countries */\t~> $append(application_types[country_id!=null])\t/* Filter out already existing applications */\t/* by using the Countries in Lead Country*/\t~> $filter(function($v) {$count(applications[lead_market__rim=$v.country_id and application_type__rim=$v.application_type_id])=0})\t/* by using the Countries in Application Country join*/\t~> $filter(function($v) {$count(application_countries[country__rim=$v.country_id and `application__rimr.application_type__rim`=$v.application_type_id])=0})\t/* Filter out Common (EU) and Common (GCC) */\t~> $filter(function($v) {$v.country_name != \"Common (EU)\" and $v.country_name != \"Common (GCC)\"})\t/* Sort by name */\t~> $sort(function($l, $r) {$l.country_name > $r.country_name})\t",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1930,
        "y": 1540,
        "wires": [
            [
                "663e76bf01799be3",
                "2ff139f4915e9a83"
            ]
        ]
    },
    {
        "id": "2ff139f4915e9a83",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "60c0de94d312a065",
        "name": "set fields for input form",
        "rules": [
            {
                "t": "set",
                "p": "title",
                "pt": "msg",
                "to": "Please select all the participating countries of the CTR process",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "type",
                "pt": "msg",
                "to": "checkbox",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "description",
                "pt": "msg",
                "to": "\"Lead Country is set as European Union for new CTR for Study \" & study.name__v & \" \" & study.study_alias__c",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "tableheader",
                "pt": "msg",
                "to": "{\"columns\":[\"Country\",\"Region\",\"Application Type\"]}",
                "tot": "json"
            },
            {
                "t": "set",
                "p": "dataarray",
                "pt": "msg",
                "to": "full_application_types.{\t   \"selection\": $string(),\t   \"columns\": [\t       country_name,\t       region_name,\t       application_type\t   ]\t}",
                "tot": "jsonata",
                "dc": true
            },
            {
                "t": "set",
                "p": "flow",
                "pt": "msg",
                "to": "nodes/cta/ctd",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "hiddenfields",
                "pt": "msg",
                "to": "[\t   {\t       \"name\": \"study_id\",\t       \"value\": study_id\t    },\t    {\t       \"name\": \"lead_country\",\t       \"value\": $string(lead_country)\t    },\t    {\t        \"name\": \"event_id\",\t        \"value\": event_id\t    },\t    {\t        \"name\": \"created_event_id\",\t        \"value\": created_event_id\t    },\t    {\t        \"name\": \"job_type\",\t        \"value\": job.job_type\t    },\t    {\t        \"name\": \"job_scope\",\t        \"value\": job.job_scope\t    }\t\t]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1420,
        "y": 1600,
        "wires": [
            [
                "356e2e4aa54252a7"
            ]
        ]
    },
    {
        "id": "7a194ad4e9fa1f04",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "60c0de94d312a065",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2170,
        "y": 1600,
        "wires": []
    },
    {
        "id": "a59b352152a16d6f",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "60c0de94d312a065",
        "name": "query application types",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "SELECT country__rim, country__rimr.name__v, country__rimr.country_code__rim, region__rim, region__rimr.name__v, cv_1__rim, cv_1__rimr.name__v FROM constraint__rim WHERE applicable_product_type__v = 'drug__v' AND constraint_scope__v = 'investigational__c' AND status__v = 'active__v' AND cv_1__rimr.controlled_vocabulary_type__rim = 'application_type__rim' AND cv_1__rimr.status__v = 'active__v' AND region__rimr.name__v='European Union'",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1420,
        "y": 1540,
        "wires": [
            [
                "0e71c22f3b4b309f"
            ]
        ]
    },
    {
        "id": "304f15172a2493b6",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "60c0de94d312a065",
        "name": "query countries",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, country_code__rim, region__v, region__vr.name__v from country__v where status__v = 'active__v' and region__vr.name__v='European Union' and id !='\" & $.lead_country[0].country_id & \"'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1400,
        "y": 1360,
        "wires": [
            [
                "4f9b3e39b40d256e"
            ]
        ]
    },
    {
        "id": "988426700c3ab4eb",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "60c0de94d312a065",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "countries",
                "pt": "msg",
                "to": "payload.data.{\t   \"country_id\": id,\t   \"country_name\": name__v,\t   \"country_code\": country_code__rim,\t   \"region_id\": region__v,\t   \"region_name\": `region__vr.name__v`\t}",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1910,
        "y": 1360,
        "wires": [
            [
                "57b954a69cdbd921",
                "b2c64e99abb28c30"
            ]
        ]
    },
    {
        "id": "57b954a69cdbd921",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "60c0de94d312a065",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2170,
        "y": 1360,
        "wires": []
    },
    {
        "id": "663e76bf01799be3",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "60c0de94d312a065",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2170,
        "y": 1540,
        "wires": []
    },
    {
        "id": "4f9b3e39b40d256e",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "60c0de94d312a065",
        "name": "",
        "x": 1690,
        "y": 1360,
        "wires": [
            [
                "988426700c3ab4eb"
            ],
            [
                "dd8842491a14509c"
            ]
        ]
    },
    {
        "id": "0e71c22f3b4b309f",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "60c0de94d312a065",
        "name": "",
        "x": 1690,
        "y": 1540,
        "wires": [
            [
                "2e16cd83e26cf93b"
            ],
            [
                "dd8842491a14509c"
            ]
        ]
    },
    {
        "id": "356e2e4aa54252a7",
        "type": "brave-input-form",
        "z": "2c4527dad914ec1c",
        "g": "60c0de94d312a065",
        "name": "",
        "x": 1690,
        "y": 1600,
        "wires": [
            [
                "18d6266e97652570",
                "7a194ad4e9fa1f04"
            ]
        ]
    },
    {
        "id": "b2c64e99abb28c30",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "60c0de94d312a065",
        "name": "query existing applications",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v,lead_market__rim, application_type__rim from application__v where clinical_study__c = '\" & study_id & \"'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1440,
        "y": 1420,
        "wires": [
            [
                "2d30c6c52c634f2a"
            ]
        ]
    },
    {
        "id": "2d30c6c52c634f2a",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "60c0de94d312a065",
        "name": "",
        "x": 1690,
        "y": 1420,
        "wires": [
            [
                "3d0d6dbcadc450d6"
            ],
            [
                "dd8842491a14509c"
            ]
        ]
    },
    {
        "id": "3d0d6dbcadc450d6",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "60c0de94d312a065",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "applications",
                "pt": "msg",
                "to": "payload.data",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1920,
        "y": 1420,
        "wires": [
            [
                "5872a89cd3958fcb",
                "310f410bd28e250a"
            ]
        ]
    },
    {
        "id": "5872a89cd3958fcb",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "60c0de94d312a065",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2170,
        "y": 1420,
        "wires": []
    },
    {
        "id": "66c25bf8b0a1edfb",
        "type": "http in",
        "z": "2c4527dad914ec1c",
        "g": "60c0de94d312a065",
        "name": "",
        "url": "cta/cms",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 1420,
        "y": 1180,
        "wires": [
            [
                "d202e1e3c2ad80ff"
            ]
        ]
    },
    {
        "id": "1acfb51d07c7fe8e",
        "type": "brave-login",
        "z": "2c4527dad914ec1c",
        "g": "60c0de94d312a065",
        "name": "",
        "x": 1870,
        "y": 1180,
        "wires": [
            [
                "7c0dc3c51543f672"
            ],
            [
                "dd8842491a14509c"
            ]
        ]
    },
    {
        "id": "d202e1e3c2ad80ff",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "60c0de94d312a065",
        "name": "store parameters",
        "rules": [
            {
                "t": "set",
                "p": "study_id",
                "pt": "msg",
                "to": "payload.study_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "lead_country_string",
                "pt": "msg",
                "to": "[{\"country_id\":\"00C000000000783\",\"country_name\":\"European Union\",\"country_code\":\"EU\",\"region_id\":\"00R000000000102\",\"region_name\":\"European Union\",\"application_type_id\":\"A0V000000004004\",\"application_type\":\"CTA Regulation\"}]",
                "tot": "str",
                "dc": true
            },
            {
                "t": "set",
                "p": "client_id",
                "pt": "msg",
                "to": "cta-automation",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "event_id",
                "pt": "msg",
                "to": "payload.id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "job.job_scope",
                "pt": "msg",
                "to": "payload.job_scope",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "job.job_type",
                "pt": "msg",
                "to": "payload.job_type",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "created_event_id",
                "pt": "msg",
                "to": "payload.created_event_id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1710,
        "y": 1180,
        "wires": [
            [
                "1acfb51d07c7fe8e"
            ]
        ]
    },
    {
        "id": "9f4f0222088f8ec7",
        "type": "json",
        "z": "2c4527dad914ec1c",
        "g": "60c0de94d312a065",
        "name": "json to object",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 1690,
        "y": 1240,
        "wires": [
            [
                "ffcfb0bd8992cab7"
            ]
        ]
    },
    {
        "id": "ffcfb0bd8992cab7",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "60c0de94d312a065",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "lead_country",
                "pt": "msg",
                "to": "payload",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1920,
        "y": 1240,
        "wires": [
            [
                "d1d77c14b8aa7c78",
                "13ad1b3d246764f1"
            ]
        ]
    },
    {
        "id": "e08539a4baec5868",
        "type": "split",
        "z": "2c4527dad914ec1c",
        "g": "60c0de94d312a065",
        "name": "for each country",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1400,
        "y": 1240,
        "wires": [
            [
                "9f4f0222088f8ec7"
            ]
        ]
    },
    {
        "id": "7c0dc3c51543f672",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "60c0de94d312a065",
        "name": "parse countries",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "lead_country_string",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2140,
        "y": 1180,
        "wires": [
            [
                "e08539a4baec5868"
            ]
        ]
    },
    {
        "id": "d1d77c14b8aa7c78",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "60c0de94d312a065",
        "name": "msg",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2170,
        "y": 1240,
        "wires": []
    },
    {
        "id": "310f410bd28e250a",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "60c0de94d312a065",
        "name": "query existing Application Countries",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, country__rim, country__rimr.name__v, application__rim, application__rimr.name__v, application__rimr.application_type__rim from application_country__rim where application__rimr.clinical_study__c ='\" & study_id & \"'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1460,
        "y": 1480,
        "wires": [
            [
                "1e7595e74b058c3c"
            ]
        ]
    },
    {
        "id": "1e7595e74b058c3c",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "60c0de94d312a065",
        "name": "",
        "x": 1690,
        "y": 1480,
        "wires": [
            [
                "8201c8fc8cfddd57"
            ],
            [
                "dd8842491a14509c"
            ]
        ]
    },
    {
        "id": "8201c8fc8cfddd57",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "60c0de94d312a065",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "application_countries",
                "pt": "msg",
                "to": "payload.data",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1950,
        "y": 1480,
        "wires": [
            [
                "1e058dc04b758acf",
                "a59b352152a16d6f"
            ]
        ]
    },
    {
        "id": "1e058dc04b758acf",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "60c0de94d312a065",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2170,
        "y": 1480,
        "wires": []
    },
    {
        "id": "dd8842491a14509c",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "60c0de94d312a065",
        "name": "link out 4",
        "mode": "link",
        "links": [
            "a1d7e010334dfdd3"
        ],
        "x": 1845,
        "y": 1660,
        "wires": []
    },
    {
        "id": "13ad1b3d246764f1",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "60c0de94d312a065",
        "name": "query study",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, study_alias__c, product__v, product__vr.name__v, (select id, name__v, product__c, product__cr.name__v, product_family__c, product_family__cr.name__v, product_variant__c, product_variant__cr.name__v from clinical_study_products__cr), (select id, name__v, therapeutic_indication__c, therapeutic_indication__cr.name__v from therapeutic_indication_clinical_studies__cr) from clinical_study__v where id='\" & study_id & \"'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1390,
        "y": 1300,
        "wires": [
            [
                "89c781ac52c22d3d"
            ]
        ]
    },
    {
        "id": "89c781ac52c22d3d",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "60c0de94d312a065",
        "name": "",
        "x": 1690,
        "y": 1300,
        "wires": [
            [
                "2fb8da2f7b5e1265"
            ],
            [
                "dd8842491a14509c"
            ]
        ]
    },
    {
        "id": "2fb8da2f7b5e1265",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "60c0de94d312a065",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "study",
                "pt": "msg",
                "to": "payload.data[0]",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1900,
        "y": 1300,
        "wires": [
            [
                "a3128ebd4788fce9",
                "304f15172a2493b6"
            ]
        ]
    },
    {
        "id": "a3128ebd4788fce9",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "60c0de94d312a065",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2170,
        "y": 1300,
        "wires": []
    },
    {
        "id": "a68c76b15e9cc5dc",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "d022bdeaa8a97155",
        "name": "create application countries",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"application_country__rim\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "join_countries",
                "pt": "msg",
                "to": "$append(cms_countries,countries)",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "cms_countries@$i.ha@$h[$i.country_id=$h.country__rim].{\t   \"country__rim\": $i.country_id,\t   \"health_authority__c\": $h.health_authority__v,\t   \"application__rim\": applications[0].id,\t   \"object_type__vr.name__v\": \"Investigational Application Country\"\t}[]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1860,
        "y": 3400,
        "wires": [
            [
                "2095eca2c9c73c2f"
            ]
        ]
    },
    {
        "id": "2095eca2c9c73c2f",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "d022bdeaa8a97155",
        "name": "",
        "x": 2160,
        "y": 3400,
        "wires": [
            [
                "c20b83ab768b1d3d",
                "f3538e4adcf2f613"
            ],
            [
                "bc49ae6168ab21da"
            ]
        ]
    },
    {
        "id": "c20b83ab768b1d3d",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "d022bdeaa8a97155",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2470,
        "y": 3400,
        "wires": []
    },
    {
        "id": "2ebc5c6d445f1138",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "d022bdeaa8a97155",
        "name": "query HA",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "select id, country__rim, country__rimr.name__v, object_type__v, object_type__vr.name__v, health_authority__v, health_authority__vr.name__v from constraint__rim where object_type__vr.name__v='Health Authority'",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1380,
        "y": 3340,
        "wires": [
            [
                "d3669aac99d1ad97"
            ]
        ]
    },
    {
        "id": "d3669aac99d1ad97",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "d022bdeaa8a97155",
        "name": "",
        "x": 1630,
        "y": 3340,
        "wires": [
            [
                "84d87af5ca62f986"
            ],
            [
                "bc49ae6168ab21da"
            ]
        ]
    },
    {
        "id": "494215724b71c2d7",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "d022bdeaa8a97155",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "ha",
                "pt": "msg",
                "to": "payload.data",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1390,
        "y": 3400,
        "wires": [
            [
                "107176c9638961b0"
            ]
        ]
    },
    {
        "id": "0f1be22b10561660",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "d022bdeaa8a97155",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2470,
        "y": 3460,
        "wires": []
    },
    {
        "id": "31d9f9d15f809871",
        "type": "function",
        "z": "2c4527dad914ec1c",
        "g": "d022bdeaa8a97155",
        "name": "Remove duplicate by country",
        "func": "var prev = null;\n\nmsg.payload.data = msg.payload.data.filter((item) => {\n    var keep = (item.country__rim !== prev);\n    prev = item.country__rim;\n    return keep;\n});\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2200,
        "y": 3340,
        "wires": [
            [
                "494215724b71c2d7",
                "e2f80f1e3a501d9e"
            ]
        ]
    },
    {
        "id": "e2f80f1e3a501d9e",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "d022bdeaa8a97155",
        "name": "debug 292",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 2490,
        "y": 3340,
        "wires": []
    },
    {
        "id": "84d87af5ca62f986",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "d022bdeaa8a97155",
        "name": "Order the HA by Country",
        "rules": [
            {
                "t": "set",
                "p": "payload.data",
                "pt": "msg",
                "to": "payload.data\t~>$sort(function($l, $r) {$l.country__rim > $r.country__rim})",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1850,
        "y": 3340,
        "wires": [
            [
                "31d9f9d15f809871"
            ]
        ]
    },
    {
        "id": "bc49ae6168ab21da",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "d022bdeaa8a97155",
        "name": "",
        "mode": "link",
        "links": [
            "a1d7e010334dfdd3"
        ],
        "x": 1865,
        "y": 3520,
        "wires": []
    },
    {
        "id": "4a2521f6e1a32aa0",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "d022bdeaa8a97155",
        "name": "link out 5",
        "mode": "link",
        "links": [
            "df6e3632b0e19e34"
        ],
        "x": 2435,
        "y": 3520,
        "wires": []
    },
    {
        "id": "f3538e4adcf2f613",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "d022bdeaa8a97155",
        "name": "create non-CTR application countries",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"application_country__rim\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "applications@$i.ha@$h[$i.lead_market__rim != \"00C000000000783\" and $i.lead_market__rim=$h.country__rim].{\t   \"country__rim\": $i.lead_market__rim,\t   \"health_authority__c\": $h.health_authority__v,\t   \"application__rim\": $i.id,\t   \"object_type__vr.name__v\": \"Investigational Application Country\"\t}[]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1890,
        "y": 3460,
        "wires": [
            [
                "766d56d483547360"
            ]
        ]
    },
    {
        "id": "107176c9638961b0",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "d022bdeaa8a97155",
        "name": "",
        "property": "lead_country_string",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nempty"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1570,
        "y": 3400,
        "wires": [
            [
                "a68c76b15e9cc5dc"
            ],
            [
                "f3538e4adcf2f613"
            ]
        ]
    },
    {
        "id": "766d56d483547360",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "d022bdeaa8a97155",
        "name": "",
        "x": 2160,
        "y": 3460,
        "wires": [
            [
                "0f1be22b10561660",
                "4a2521f6e1a32aa0"
            ],
            [
                "bc49ae6168ab21da"
            ]
        ]
    },
    {
        "id": "f976c52a47cce42e",
        "type": "http request",
        "z": "2c4527dad914ec1c",
        "g": "ca1016782fddaa02",
        "name": "",
        "method": "PUT",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 1630,
        "y": 3060,
        "wires": [
            [
                "42452a39b395d8e8"
            ]
        ]
    },
    {
        "id": "baa39c9826af5348",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "create submissions",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"submission__v\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "applications.{\t   \"name__v\": $$.event.name__v & ' - ' & $substringBefore(name__v, \" -\"),\t   \"description__v\": $length($$.event.event_description__c) > 500 ? $substring($$.event.event_description__c,0,497) & \"...\" : $$.event.event_description__c,\t   \"application__v\": id,\t   \"object_type__vr.api_name__v\": \"investigational_submission__c\",\t   \"submission_type__rimr.name__v\": \"*Placeholder - Please Update*\"\t}[]\t",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3250,
        "y": 2340,
        "wires": [
            [
                "6561ba05eaa91b22"
            ]
        ]
    },
    {
        "id": "180f74906abb7521",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "store result",
        "rules": [
            {
                "t": "set",
                "p": "submission_ids",
                "pt": "msg",
                "to": "payload.data[responseStatus=\"SUCCESS\"].data.id[]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3730,
        "y": 2340,
        "wires": [
            [
                "db38931e34bfc13a",
                "e1cecc09636022ad"
            ]
        ]
    },
    {
        "id": "db38931e34bfc13a",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "query submissions",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v from submission__v where \" & (submission_ids ~> $map(function($v) {\"id='\" & $v & \"'\"}) ~> $join(\" OR \"))",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3250,
        "y": 2400,
        "wires": [
            [
                "ef9e020dec7062f3"
            ]
        ]
    },
    {
        "id": "09a3f28a35c4d5e6",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "store result",
        "rules": [
            {
                "t": "set",
                "p": "submissions",
                "pt": "msg",
                "to": "payload.data",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3730,
        "y": 2400,
        "wires": [
            [
                "74be9745ad928e34",
                "db85d39043815280"
            ]
        ]
    },
    {
        "id": "74be9745ad928e34",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "link to products",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"submission_pharmaceutical_product__rim\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t    submissions ~> $map(\t       function($submission) {\t           study.clinical_study_products__cr.data.{\t               \"submission__rim\": $submission.id,\t               \"pharmaceutical_product__rim\": product__c,\t               \"product_detail__rim\": product_variant__c\t        }\t    }\t    ) ~> $reduce(\t       function($accumulator, $value) {$append($accumulator, $value)}\t    )\t]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3240,
        "y": 2460,
        "wires": [
            [
                "5bda67103104bddb"
            ]
        ]
    },
    {
        "id": "ad1b1ab7c19ca46d",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "link to study",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"submission_clinical_study__rim\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "submissions.{\t   \"submission__rim\": id,\t   \"clinical_study__rim\": $$.study_id\t}[]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3230,
        "y": 2580,
        "wires": [
            [
                "eeb32648b97425e0"
            ]
        ]
    },
    {
        "id": "e1cecc09636022ad",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3910,
        "y": 2340,
        "wires": []
    },
    {
        "id": "db85d39043815280",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3910,
        "y": 2400,
        "wires": []
    },
    {
        "id": "6e735561c94ccedb",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3910,
        "y": 2460,
        "wires": []
    },
    {
        "id": "2a42318059e84be7",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3910,
        "y": 2580,
        "wires": []
    },
    {
        "id": "6561ba05eaa91b22",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "",
        "x": 3480,
        "y": 2340,
        "wires": [
            [
                "180f74906abb7521"
            ],
            [
                "ec17eea9c45882f3"
            ]
        ]
    },
    {
        "id": "ef9e020dec7062f3",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "",
        "x": 3470,
        "y": 2400,
        "wires": [
            [
                "09a3f28a35c4d5e6"
            ],
            [
                "ec17eea9c45882f3"
            ]
        ]
    },
    {
        "id": "5bda67103104bddb",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "",
        "x": 3480,
        "y": 2460,
        "wires": [
            [
                "6e735561c94ccedb",
                "10d4268fac032ef1"
            ],
            [
                "ec17eea9c45882f3"
            ]
        ]
    },
    {
        "id": "ec17eea9c45882f3",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "",
        "mode": "link",
        "links": [
            "a1d7e010334dfdd3"
        ],
        "x": 3705,
        "y": 2660,
        "wires": []
    },
    {
        "id": "eeb32648b97425e0",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "",
        "x": 3480,
        "y": 2580,
        "wires": [
            [
                "2a42318059e84be7",
                "3ad0cdaa497c315c"
            ],
            [
                "ec17eea9c45882f3"
            ]
        ]
    },
    {
        "id": "3ad0cdaa497c315c",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "link to indications",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"submission_indication__rim\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t    submissions ~> $map(function($submission) {\t       study.therapeutic_indication_clinical_studies__cr.data.{\t           \"indication__rim\": therapeutic_indication__c,\t           \"submission__rim\": $submission.id\t        }\t    }) ~> $reduce(function($accumulator, $value) {$append($accumulator, $value)})\t]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3250,
        "y": 2640,
        "wires": [
            [
                "8a04922b90e546e5"
            ]
        ]
    },
    {
        "id": "8a04922b90e546e5",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "",
        "x": 3480,
        "y": 2640,
        "wires": [
            [
                "faa088213b8d2f54",
                "e974785e628c969c"
            ],
            [
                "ec17eea9c45882f3"
            ]
        ]
    },
    {
        "id": "faa088213b8d2f54",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3910,
        "y": 2640,
        "wires": []
    },
    {
        "id": "10d4268fac032ef1",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "link to event",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"event_submission__rim\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "submissions.{\t   \"submission__rim\": id,\t   \"event__rim\": $$.event.id\t}[]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3230,
        "y": 2520,
        "wires": [
            [
                "73fa0facac6f8e60"
            ]
        ]
    },
    {
        "id": "73fa0facac6f8e60",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "",
        "x": 3480,
        "y": 2520,
        "wires": [
            [
                "e5249b72892316bd",
                "ad1b1ab7c19ca46d"
            ],
            [
                "ec17eea9c45882f3"
            ]
        ]
    },
    {
        "id": "e5249b72892316bd",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3910,
        "y": 2520,
        "wires": []
    },
    {
        "id": "02b89b06ff195d34",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "query event",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, event_description__c, (select id, impd_version_nonquality_part__c, impd_version_quality_part__c, protocol_version__c, ib_version__c from event_clinical_studies__vr) from event__rim where object_type__vr.api_name__v = 'clinical_study_event__c' and applicable_product_type__v = 'drug__v'and keywords__c = 'clinical_initial_cta__c' and id in (select id from event_clinical_studies__vr where clinical_study__v='\" & study_id & \"')\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3230,
        "y": 2280,
        "wires": [
            [
                "9b5b756c6ca7dc41"
            ]
        ]
    },
    {
        "id": "9b5b756c6ca7dc41",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "",
        "x": 3470,
        "y": 2280,
        "wires": [
            [
                "4b560aeae3c9a651"
            ],
            [
                "ec17eea9c45882f3"
            ]
        ]
    },
    {
        "id": "4b560aeae3c9a651",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "event",
                "pt": "msg",
                "to": "payload.data[0]",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3740,
        "y": 2280,
        "wires": [
            [
                "d18d6a3d80664269",
                "baa39c9826af5348"
            ]
        ]
    },
    {
        "id": "d18d6a3d80664269",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3910,
        "y": 2280,
        "wires": []
    },
    {
        "id": "375b947dcc80bda2",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "query study",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, study_alias__c, product__v, product__vr.name__v, (select id, name__v, product__c, product__cr.name__v, product_family__c, product_family__cr.name__v, product_variant__c, product_variant__cr.name__v from clinical_study_products__cr), (select id, name__v, therapeutic_indication__c, therapeutic_indication__cr.name__v from therapeutic_indication_clinical_studies__cr) from clinical_study__v where id='\" & study_id & \"'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3470,
        "y": 2160,
        "wires": [
            [
                "2aef3a8d44b39a07"
            ]
        ]
    },
    {
        "id": "2aef3a8d44b39a07",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "",
        "x": 3730,
        "y": 2160,
        "wires": [
            [
                "cbbe0423aa35ad06"
            ],
            [
                "ec17eea9c45882f3"
            ]
        ]
    },
    {
        "id": "cbbe0423aa35ad06",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "study",
                "pt": "msg",
                "to": "payload.data[0]",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3940,
        "y": 2160,
        "wires": [
            [
                "329af6459c29bdd3"
            ]
        ]
    },
    {
        "id": "53ec9ab2b97056b3",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3910,
        "y": 2220,
        "wires": []
    },
    {
        "id": "92969b844dd98f0b",
        "type": "http in",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "",
        "url": "cta/create_records",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 3290,
        "y": 2040,
        "wires": [
            [
                "fe469cda521e677d"
            ]
        ]
    },
    {
        "id": "fe469cda521e677d",
        "type": "json",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "resp_full",
        "property": "payload.response_full",
        "action": "obj",
        "pretty": false,
        "x": 3500,
        "y": 2040,
        "wires": [
            [
                "afb83f43f91551d8"
            ]
        ]
    },
    {
        "id": "afb83f43f91551d8",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "store parameters",
        "rules": [
            {
                "t": "set",
                "p": "study_id",
                "pt": "msg",
                "to": "payload.study_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "applications",
                "pt": "msg",
                "to": "payload.response_full[]",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "lead_country_string",
                "pt": "msg",
                "to": "payload.lead_country",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "client_id",
                "pt": "msg",
                "to": "cta-automation",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "event_id",
                "pt": "msg",
                "to": "payload.event_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "job.job_scope",
                "pt": "msg",
                "to": "payload.job_scope",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "job.job_type",
                "pt": "msg",
                "to": "payload.job_type",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "created_application_ids",
                "pt": "msg",
                "to": "payload.created_application_ids",
                "tot": "msg",
                "dc": true
            },
            {
                "t": "set",
                "p": "created_event_id",
                "pt": "msg",
                "to": "payload.created_event_id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3750,
        "y": 2040,
        "wires": [
            [
                "1cbce160e8451deb"
            ]
        ]
    },
    {
        "id": "1cbce160e8451deb",
        "type": "brave-login",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "",
        "x": 3910,
        "y": 2040,
        "wires": [
            [
                "9b5bae8c51d70c5a"
            ],
            [
                "ec17eea9c45882f3"
            ]
        ]
    },
    {
        "id": "9b5bae8c51d70c5a",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "parse Application",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "applications",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3250,
        "y": 2100,
        "wires": [
            [
                "edc809786ffa0b67"
            ]
        ]
    },
    {
        "id": "edc809786ffa0b67",
        "type": "split",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "for each Application",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 3490,
        "y": 2100,
        "wires": [
            [
                "0767c20240345f23"
            ]
        ]
    },
    {
        "id": "0767c20240345f23",
        "type": "json",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "json to object",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 3730,
        "y": 2100,
        "wires": [
            [
                "6f018798efc57d12"
            ]
        ]
    },
    {
        "id": "6f018798efc57d12",
        "type": "join",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "",
        "mode": "auto",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": true,
        "timeout": "",
        "count": "",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 3910,
        "y": 2100,
        "wires": [
            [
                "cf91e0058e911558"
            ]
        ]
    },
    {
        "id": "cf91e0058e911558",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "applications",
                "pt": "msg",
                "to": "payload",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3260,
        "y": 2160,
        "wires": [
            [
                "375b947dcc80bda2"
            ]
        ]
    },
    {
        "id": "329af6459c29bdd3",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "",
        "property": "job.job_type",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "1",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "2",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 3210,
        "y": 2220,
        "wires": [
            [
                "02b89b06ff195d34"
            ],
            [
                "b723c70ffd5fc20e"
            ]
        ]
    },
    {
        "id": "b723c70ffd5fc20e",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "f518aa9a70a561ce",
        "name": "query event",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, event_description__c, (select id, impd_version_nonquality_part__c, impd_version_quality_part__c, protocol_version__c, ib_version__c from event_clinical_studies__vr) from event__rim where id='\" & event_id & \"'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3470,
        "y": 2220,
        "wires": [
            [
                "9b5b756c6ca7dc41",
                "53ec9ab2b97056b3"
            ]
        ]
    },
    {
        "id": "815b898da7348084",
        "type": "http response",
        "z": "2c4527dad914ec1c",
        "g": "0df38016a1f72175",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 3670,
        "y": 1880,
        "wires": []
    },
    {
        "id": "5f5d749dad848b0c",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "0df38016a1f72175",
        "name": "set fields for input form",
        "rules": [
            {
                "t": "set",
                "p": "title",
                "pt": "msg",
                "to": "\"Creating records for Study \" & study.name__v & \" \" & study.study_alias__c",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "type",
                "pt": "msg",
                "to": "checkbox",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "description",
                "pt": "msg",
                "to": "Please select the Applications for which RO and Submission would be created.",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "tableheader",
                "pt": "msg",
                "to": "{\"columns\":[\"Application Name\",\"Lead Country\",\"Created Date\"]}",
                "tot": "json"
            },
            {
                "t": "set",
                "p": "dataarray",
                "pt": "msg",
                "to": "applications.{\t   \"selection\": $string(),\t   \"columns\": \t   [\t       name__v, \t       lead_market__rimr.data[0].name__v,\t       created_date__v\t       ]\t}",
                "tot": "jsonata",
                "dc": true
            },
            {
                "t": "set",
                "p": "flow",
                "pt": "msg",
                "to": "nodes/cta/create_records",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "hiddenfields",
                "pt": "msg",
                "to": "[\t   {\t       \"name\": \"study_id\",\t       \"value\": study_id\t    },\t    {\t        \"name\": \"job_type\",\t        \"value\": job.job_type\t    },\t    {\t        \"name\": \"job_scope\",\t        \"value\": job.job_scope\t    },\t    {\t        \"name\": \"event_id\",\t        \"value\": event_id\t    },\t    {\t        \"name\": \"created_application_ids\",\t        \"value\": created_application_ids\t    },\t    {\t        \"name\": \"created_event_id\",\t        \"value\": created_event_id\t    }\t]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3240,
        "y": 1880,
        "wires": [
            [
                "745032eae74c14c6"
            ]
        ]
    },
    {
        "id": "745032eae74c14c6",
        "type": "brave-input-form",
        "z": "2c4527dad914ec1c",
        "g": "0df38016a1f72175",
        "name": "",
        "x": 3510,
        "y": 1880,
        "wires": [
            [
                "815b898da7348084"
            ]
        ]
    },
    {
        "id": "712ffb860c3a2037",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "0df38016a1f72175",
        "name": "query applications",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, lead_market__rim, (select name__v, region__v, reporting_region__c from lead_market__rimr), created_date__v from application__v where id in (select application__c from application_clinical_studies__cr where clinical_study__c='\" & study_id & \"') and \" & app_filter",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3230,
        "y": 1760,
        "wires": [
            [
                "909b262a20993c68"
            ]
        ]
    },
    {
        "id": "909b262a20993c68",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "0df38016a1f72175",
        "name": "",
        "x": 3510,
        "y": 1760,
        "wires": [
            [
                "d45c685b21e8a671"
            ],
            [
                "621d2ba2e014840a"
            ]
        ]
    },
    {
        "id": "d45c685b21e8a671",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "0df38016a1f72175",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "applications",
                "pt": "msg",
                "to": "payload.data",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3720,
        "y": 1760,
        "wires": [
            [
                "a2e99079f9ca0f1b",
                "088e67f8e8199ab2"
            ]
        ]
    },
    {
        "id": "a2e99079f9ca0f1b",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "0df38016a1f72175",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3910,
        "y": 1760,
        "wires": []
    },
    {
        "id": "f0176fb78a6cd5e9",
        "type": "http in",
        "z": "2c4527dad914ec1c",
        "g": "0df38016a1f72175",
        "name": "",
        "url": "cta/app_for_records",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 3270,
        "y": 1440,
        "wires": [
            [
                "87df2f5923908545"
            ]
        ]
    },
    {
        "id": "1687742a6fc86431",
        "type": "brave-login",
        "z": "2c4527dad914ec1c",
        "g": "0df38016a1f72175",
        "name": "",
        "x": 3910,
        "y": 1500,
        "wires": [
            [
                "949d5ad057e1e261"
            ],
            [
                "621d2ba2e014840a"
            ]
        ]
    },
    {
        "id": "088e67f8e8199ab2",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "0df38016a1f72175",
        "name": "query applications",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select application__v from submission__v where id in (select submission__rim from event_submissions__rimr where event__rim='\" & event_id & \"')\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3230,
        "y": 1820,
        "wires": [
            [
                "6c5cc9ddbed9c5b0"
            ]
        ]
    },
    {
        "id": "6c5cc9ddbed9c5b0",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "0df38016a1f72175",
        "name": "",
        "x": 3510,
        "y": 1820,
        "wires": [
            [
                "7556bdfbf0946221"
            ],
            [
                "621d2ba2e014840a"
            ]
        ]
    },
    {
        "id": "7556bdfbf0946221",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "0df38016a1f72175",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "applications",
                "pt": "msg",
                "to": "applications\t~> $filter(function($v){$not($v.id in payload.data.application__v)})",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3720,
        "y": 1820,
        "wires": [
            [
                "6d25602125fc0b18",
                "5f5d749dad848b0c"
            ]
        ]
    },
    {
        "id": "6d25602125fc0b18",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "0df38016a1f72175",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3910,
        "y": 1820,
        "wires": []
    },
    {
        "id": "87df2f5923908545",
        "type": "json",
        "z": "2c4527dad914ec1c",
        "g": "0df38016a1f72175",
        "name": "resp_full",
        "property": "payload.response_full",
        "action": "obj",
        "pretty": false,
        "x": 3500,
        "y": 1440,
        "wires": [
            [
                "2e3e4bf8b0f2a1b8"
            ]
        ]
    },
    {
        "id": "2e3e4bf8b0f2a1b8",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "0df38016a1f72175",
        "name": "store parameters",
        "rules": [
            {
                "t": "set",
                "p": "study_id",
                "pt": "msg",
                "to": "payload.study_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "created_application_ids",
                "pt": "msg",
                "to": "payload.created_application_ids",
                "tot": "msg",
                "dc": true
            },
            {
                "t": "set",
                "p": "created_event_id",
                "pt": "msg",
                "to": "payload.created_event_id",
                "tot": "msg",
                "dc": true
            },
            {
                "t": "set",
                "p": "client_id",
                "pt": "msg",
                "to": "cta-automation",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "event_id",
                "pt": "msg",
                "to": "$filter (payload.event_id, function ($v) { $v != \"\" })",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "job.job_scope",
                "pt": "msg",
                "to": "payload.job_scope",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "job.job_type",
                "pt": "msg",
                "to": "payload.job_type",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "ro_type",
                "pt": "msg",
                "to": "payload.response_full[]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3730,
        "y": 1440,
        "wires": [
            [
                "731bc14a2469e6c6"
            ]
        ]
    },
    {
        "id": "731bc14a2469e6c6",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "0df38016a1f72175",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "ro_type",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3940,
        "y": 1440,
        "wires": [
            [
                "c18fb9326edc6329"
            ]
        ]
    },
    {
        "id": "c18fb9326edc6329",
        "type": "split",
        "z": "2c4527dad914ec1c",
        "g": "0df38016a1f72175",
        "name": "for RO Type",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 3210,
        "y": 1500,
        "wires": [
            [
                "6a4f3e9952067b39"
            ]
        ]
    },
    {
        "id": "6a4f3e9952067b39",
        "type": "json",
        "z": "2c4527dad914ec1c",
        "g": "0df38016a1f72175",
        "name": "json to object",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 3390,
        "y": 1500,
        "wires": [
            [
                "4b3c6d71655f890e"
            ]
        ]
    },
    {
        "id": "4b3c6d71655f890e",
        "type": "join",
        "z": "2c4527dad914ec1c",
        "g": "0df38016a1f72175",
        "name": "",
        "mode": "auto",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": true,
        "timeout": "",
        "count": "",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 3570,
        "y": 1500,
        "wires": [
            [
                "5d39cd3c146c924a"
            ]
        ]
    },
    {
        "id": "5d39cd3c146c924a",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "0df38016a1f72175",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "ro_type",
                "pt": "msg",
                "to": "payload[0].ID",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "ro_region",
                "pt": "msg",
                "to": "payload[0].Region",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3740,
        "y": 1500,
        "wires": [
            [
                "1687742a6fc86431"
            ]
        ]
    },
    {
        "id": "621d2ba2e014840a",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "0df38016a1f72175",
        "name": "",
        "mode": "link",
        "links": [
            "a1d7e010334dfdd3"
        ],
        "x": 4055,
        "y": 1820,
        "wires": []
    },
    {
        "id": "949d5ad057e1e261",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "0df38016a1f72175",
        "name": "check RO Type region",
        "property": "ro_region",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "EU",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Non-EU",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Japan",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "United States",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "All Regions",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 5,
        "x": 3240,
        "y": 1600,
        "wires": [
            [
                "e42a0766e2bc818b"
            ],
            [
                "f3e585d38bc8703d"
            ],
            [
                "279388131d7257e3"
            ],
            [
                "13116165a53789dd"
            ],
            [
                "9e1fc759e2fe5655"
            ]
        ]
    },
    {
        "id": "e42a0766e2bc818b",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "0df38016a1f72175",
        "name": "app filter - EU",
        "rules": [
            {
                "t": "set",
                "p": "app_filter",
                "pt": "msg",
                "to": "lead_market__rimr.region__v='00R000000000102'",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3500,
        "y": 1540,
        "wires": [
            [
                "712ffb860c3a2037"
            ]
        ]
    },
    {
        "id": "f3e585d38bc8703d",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "0df38016a1f72175",
        "name": "app filter - Non-EU",
        "rules": [
            {
                "t": "set",
                "p": "app_filter",
                "pt": "msg",
                "to": "lead_market__rimr.region__v!='00R000000000102'",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3510,
        "y": 1580,
        "wires": [
            [
                "712ffb860c3a2037"
            ]
        ]
    },
    {
        "id": "13116165a53789dd",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "0df38016a1f72175",
        "name": "app filter - US",
        "rules": [
            {
                "t": "set",
                "p": "app_filter",
                "pt": "msg",
                "to": "lead_market__rim='00C000000000752'",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3500,
        "y": 1660,
        "wires": [
            [
                "712ffb860c3a2037"
            ]
        ]
    },
    {
        "id": "279388131d7257e3",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "0df38016a1f72175",
        "name": "app filter - JP",
        "rules": [
            {
                "t": "set",
                "p": "app_filter",
                "pt": "msg",
                "to": "lead_market__rim=' 00C000000000808'",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3490,
        "y": 1620,
        "wires": [
            [
                "712ffb860c3a2037"
            ]
        ]
    },
    {
        "id": "9e1fc759e2fe5655",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "0df38016a1f72175",
        "name": "app filter - all",
        "rules": [
            {
                "t": "set",
                "p": "app_filter",
                "pt": "msg",
                "to": "lead_market__rim !=''",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3490,
        "y": 1700,
        "wires": [
            [
                "712ffb860c3a2037"
            ]
        ]
    },
    {
        "id": "be24b3c797804fe1",
        "type": "link in",
        "z": "2c4527dad914ec1c",
        "g": "eae4020013fd9b1d",
        "name": "link in 4",
        "links": [
            "bcd13a4e57099bd1"
        ],
        "x": 3155,
        "y": 840,
        "wires": [
            [
                "afcf9e517dd2b57d"
            ]
        ]
    },
    {
        "id": "fe308079eefb7a9b",
        "type": "http response",
        "z": "2c4527dad914ec1c",
        "g": "eae4020013fd9b1d",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 4130,
        "y": 960,
        "wires": []
    },
    {
        "id": "75c51310d6a882bf",
        "type": "brave-input-form",
        "z": "2c4527dad914ec1c",
        "g": "eae4020013fd9b1d",
        "name": "",
        "x": 3950,
        "y": 960,
        "wires": [
            [
                "fe308079eefb7a9b"
            ]
        ]
    },
    {
        "id": "8f63b44e74d15330",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "eae4020013fd9b1d",
        "name": "query event",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, brave_event_code__cr.name__v, event_description__c, keywords__c, state__v from event__rim where object_type__vr.api_name__v = 'clinical_study_event__c' and applicable_product_type__v = 'drug__v'and keywords__c != 'clinical_initial_cta__c' and id in (select id from event_clinical_studies__vr where clinical_study__v='\" & study_id & \"') and state__v != 'inactive_state__c' and state__v != 'cancelled_state__c'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3410,
        "y": 820,
        "wires": [
            [
                "48f15fdaeaa7032b"
            ]
        ]
    },
    {
        "id": "48f15fdaeaa7032b",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "eae4020013fd9b1d",
        "name": "",
        "x": 3590,
        "y": 840,
        "wires": [
            [
                "a06de76f609e4c23"
            ],
            [
                "b6f857a48f7b4794"
            ]
        ]
    },
    {
        "id": "7b8c39ac1a2cccea",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "eae4020013fd9b1d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "events",
                "pt": "msg",
                "to": "payload.data",
                "tot": "msg",
                "dc": true
            },
            {
                "t": "set",
                "p": "event",
                "pt": "msg",
                "to": "payload.data.{\t    \"event_id\": id,\t   \"event_name\": name__v,\t   \"rec\": `brave_event_code__cr.name__v` != null ? `brave_event_code__cr.name__v` : \"N/A\",\t   \"event_description\": event_description__c,\t   \"keyword\": $reduce(keywords__c[]@$kw.[$$.event_keyword[Name=$kw].Title],function($i,$j){$i & \",\" & $j}) != null ? $reduce(keywords__c[]@$kw.[$$.event_keyword[Name=$kw].Title],function($i,$j){$i & \",\" & $j}) : \"N/A\"\t\t}\t",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3960,
        "y": 840,
        "wires": [
            [
                "94f0820b14a9161b",
                "37b555ad14ef12a6"
            ]
        ]
    },
    {
        "id": "94f0820b14a9161b",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "eae4020013fd9b1d",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 4130,
        "y": 840,
        "wires": []
    },
    {
        "id": "37b555ad14ef12a6",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "eae4020013fd9b1d",
        "name": "set fields for input form",
        "rules": [
            {
                "t": "set",
                "p": "title",
                "pt": "msg",
                "to": "\"Creating records for Study \" & study.name__v & \" \" & study.study_alias__c",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "type",
                "pt": "msg",
                "to": "radio",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "description",
                "pt": "msg",
                "to": "Please select the Event for which records would be created",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "tableheader",
                "pt": "msg",
                "to": "{\"columns\":[\"Event Name\",\"Regulatory Event Code\",\"Keywords\",\"Description\"]}",
                "tot": "json"
            },
            {
                "t": "set",
                "p": "dataarray",
                "pt": "msg",
                "to": "event.{\t   \"selection\": $string(),\t   \"columns\": \t   [\t       event_name,\t       rec,\t       keyword,\t       event_description\t    ]\t}",
                "tot": "jsonata",
                "dc": true
            },
            {
                "t": "set",
                "p": "flow",
                "pt": "msg",
                "to": "nodes/cta/ro_type",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "hiddenfields",
                "pt": "msg",
                "to": "[\t   {\t       \"name\": \"study_id\",\t       \"value\": study_id\t    },\t    {\t        \"name\": \"job_type\",\t        \"value\": job.job_type\t    },\t    {\t        \"name\": \"job_scope\",\t        \"value\": job.job_scope\t    },\t    {\t        \"name\": \"created_event_id\",\t        \"value\": created_event_id\t    },\t    {\t        \"name\": \"created_application_ids\",\t        \"value\": created_application_ids\t    }\t\t]\t",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3760,
        "y": 960,
        "wires": [
            [
                "75c51310d6a882bf"
            ]
        ]
    },
    {
        "id": "559064536dec3b73",
        "type": "template",
        "z": "2c4527dad914ec1c",
        "g": "eae4020013fd9b1d",
        "name": "Input Form",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "<!doctype html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"utf-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n    <title>Defining scope</title>\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css\"\n        integrity=\"sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu\" crossorigin=\"anonymous\">\n    <script src=\"https://code.jquery.com/jquery-1.12.4.min.js\"\n        integrity=\"sha384-nvAa0+6Qg9clwYCGGPpDQLVpLNn0fRaROjHqs13t4Ggj3Ez50XnGQqc/r8MhnRDZ\"\n        crossorigin=\"anonymous\"></script>\n    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js\"\n        integrity=\"sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd\"\n        crossorigin=\"anonymous\"></script>\n</head>\n\n<body>\n    <div class=\"modal fade\" id=\"modal\" tabindex=\"-1\" data-backdrop=\"static\">\n        <div class=\"modal-dialog\">\n            <div class=\"modal-content\">\n                <div class=\"modal-header\">\n                    <h4 class=\"modal-title\">Processing ...</h4>\n                </div>\n                <div class=\"modal-body\">\n                    <p>Please wait while the changes are applied.</p>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"container\">\n        <h1>Records would be created for the Event {{created_event.name__v}}</h1>\n        <p> </p>\n        <br>\n        <form class=\"form-horizontal\" method=\"post\" action=\"/nodes/cta/ro_type\">\n            <input type=\"hidden\" name=\"study_id\" value=\"{{study_id}}\">\n            <input type=\"hidden\" name=\"job_type\" value=\"{{job.job_type}}\">\n            <input type=\"hidden\" name=\"job_scope\" value=\"{{job.job_scope}}\">\n            <input type=\"hidden\" name=\"created_event\" value=\"{{created_event}}\">\n            <input type=\"hidden\" name=\"created_application_ids\" value=\"{{created_application_ids}}\">\n\n            <div class=\"form-group\">\n                <div class=\"col-md-offset-4 col-md-8\">\n                    <button type=\"submit\" class=\"btn btn-primary\">Yes</button>\n                </div>\n            </div>\n        </form>\n    </div>\n\n    <script>\n        $(document).ready(function(){\n            $(\"form\").submit(function() {\n                $(\"#modal\").modal(\"show\");\n            });\n        });\n    </script>\n</body>\n\n</html>",
        "output": "str",
        "x": 3950,
        "y": 1020,
        "wires": [
            [
                "4acf0be56211cf62"
            ]
        ]
    },
    {
        "id": "4acf0be56211cf62",
        "type": "http response",
        "z": "2c4527dad914ec1c",
        "g": "eae4020013fd9b1d",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 4130,
        "y": 1020,
        "wires": []
    },
    {
        "id": "ec65684c71962ec3",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "eae4020013fd9b1d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "created_event",
                "pt": "msg",
                "to": "payload.data[0]",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3760,
        "y": 1020,
        "wires": [
            [
                "559064536dec3b73"
            ]
        ]
    },
    {
        "id": "b6f857a48f7b4794",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "eae4020013fd9b1d",
        "name": "",
        "mode": "link",
        "links": [
            "a1d7e010334dfdd3"
        ],
        "x": 3605,
        "y": 960,
        "wires": []
    },
    {
        "id": "a06de76f609e4c23",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "eae4020013fd9b1d",
        "name": "If any event exists",
        "property": "$count(payload.data)!=0",
        "propertyType": "jsonata",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 3770,
        "y": 840,
        "wires": [
            [
                "7b8c39ac1a2cccea"
            ],
            [
                "4f9a931fc37b7bd0"
            ]
        ]
    },
    {
        "id": "4f9a931fc37b7bd0",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "eae4020013fd9b1d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload.errors",
                "pt": "msg",
                "to": "[\t   {\t       \"type\":\"Incomplete Data\",\t       \"message\":\"The study has no existing Event. Please confirm.\"\t   }\t]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3980,
        "y": 900,
        "wires": [
            [
                "b6f857a48f7b4794"
            ]
        ]
    },
    {
        "id": "5679cefc989d62b5",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "eae4020013fd9b1d",
        "name": "",
        "property": "job.job_type",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "2",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "1",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 3250,
        "y": 840,
        "wires": [
            [
                "8f63b44e74d15330"
            ],
            [
                "3fcec1e30ff78f0a"
            ]
        ]
    },
    {
        "id": "3fcec1e30ff78f0a",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "eae4020013fd9b1d",
        "name": "query event",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, brave_event_code__cr.name__v, event_description__c, keywords__c from event__rim where object_type__vr.api_name__v = 'clinical_study_event__c' and applicable_product_type__v = 'drug__v'and keywords__c = 'clinical_initial_cta__c' and id in (select id from event_clinical_studies__vr where clinical_study__v='\" & study_id & \"')\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3410,
        "y": 860,
        "wires": [
            [
                "48f15fdaeaa7032b"
            ]
        ]
    },
    {
        "id": "bbc02f3b1ab31c1d",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "eae4020013fd9b1d",
        "name": "",
        "x": 3550,
        "y": 1020,
        "wires": [
            [
                "ec65684c71962ec3"
            ],
            [
                "b6f857a48f7b4794"
            ]
        ]
    },
    {
        "id": "1c04bc0a1b81ef45",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "eae4020013fd9b1d",
        "name": "query event",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, brave_event_code__cr.name__v, event_description__c, keywords__c from event__rim where id='\" & created_event_id & \"'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3370,
        "y": 1020,
        "wires": [
            [
                "bbc02f3b1ab31c1d"
            ]
        ]
    },
    {
        "id": "ee42cdd847608b8e",
        "type": "http response",
        "z": "2c4527dad914ec1c",
        "g": "afea13b5e3ace5ed",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 4050,
        "y": 1260,
        "wires": []
    },
    {
        "id": "5e739d5310677788",
        "type": "brave-input-form",
        "z": "2c4527dad914ec1c",
        "g": "afea13b5e3ace5ed",
        "name": "",
        "x": 3830,
        "y": 1260,
        "wires": [
            [
                "ee42cdd847608b8e"
            ]
        ]
    },
    {
        "id": "d212fd55d6eb1f45",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "afea13b5e3ace5ed",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 4050,
        "y": 1300,
        "wires": []
    },
    {
        "id": "3ad05764e71aaecd",
        "type": "http in",
        "z": "2c4527dad914ec1c",
        "g": "afea13b5e3ace5ed",
        "name": "",
        "url": "/cta/ro_type",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 3250,
        "y": 1140,
        "wires": [
            [
                "3adece1ebc8ee643",
                "df3121b89215a09c"
            ]
        ]
    },
    {
        "id": "2f7502d21fcdd942",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "afea13b5e3ace5ed",
        "name": "set fields for input form",
        "rules": [
            {
                "t": "set",
                "p": "title",
                "pt": "msg",
                "to": "Please define the Regulatory Objective Type",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "type",
                "pt": "msg",
                "to": "radio",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "description",
                "pt": "msg",
                "to": "\"for Study \" & study.name__v & \" \" & study.study_alias__c",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "tableheader",
                "pt": "msg",
                "to": "{\"columns\":[\"Type\",\"Applicable region\"]}",
                "tot": "json"
            },
            {
                "t": "set",
                "p": "dataarray",
                "pt": "msg",
                "to": "RO_type.{\t   \"selection\": $string(),\t   \"columns\": [\t       Type,\t       Region\t   ]\t}",
                "tot": "jsonata",
                "dc": true
            },
            {
                "t": "set",
                "p": "flow",
                "pt": "msg",
                "to": "nodes/cta/app_for_records",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "hiddenfields",
                "pt": "msg",
                "to": "[\t   {\t       \"name\": \"study_id\",\t       \"value\": study_id\t    },\t    {\t       \"name\": \"lead_country\",\t       \"value\": $string(lead_country)\t    },\t    {\t        \"name\": \"job_type\",\t        \"value\": job.job_type\t    },\t    {\t        \"name\": \"job_scope\",\t        \"value\": job.job_scope\t    },\t    {\t        \"name\": \"created_event_id\",\t        \"value\": created_event_id\t    },\t    {\t        \"name\": \"created_application_ids\",\t        \"value\": created_application_ids\t    },\t    {\t        \"name\": \"event_id\",\t        \"value\": event_id\t    }\t\t]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3520,
        "y": 1260,
        "wires": [
            [
                "5e739d5310677788",
                "d212fd55d6eb1f45"
            ]
        ]
    },
    {
        "id": "9ddf0b394c30ebf5",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "afea13b5e3ace5ed",
        "name": "parse Event",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "event",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 4070,
        "y": 1140,
        "wires": [
            [
                "b156a7d9df56630a"
            ]
        ]
    },
    {
        "id": "df3121b89215a09c",
        "type": "json",
        "z": "2c4527dad914ec1c",
        "g": "afea13b5e3ace5ed",
        "name": "resp_full",
        "property": "payload.response_full",
        "action": "obj",
        "pretty": false,
        "x": 3640,
        "y": 1140,
        "wires": [
            [
                "1b6e37da8454b220"
            ]
        ]
    },
    {
        "id": "1b6e37da8454b220",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "afea13b5e3ace5ed",
        "name": "Store parameters",
        "rules": [
            {
                "t": "set",
                "p": "study_id",
                "pt": "msg",
                "to": "payload.study_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "client_id",
                "pt": "msg",
                "to": "cta-automation",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "event_id",
                "pt": "msg",
                "to": "payload.event_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "job.job_type",
                "pt": "msg",
                "to": "payload.job_type",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "job.job_scope",
                "pt": "msg",
                "to": "payload.job_scope",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "event",
                "pt": "msg",
                "to": "payload.response_full[0]",
                "tot": "jsonata",
                "dc": true
            },
            {
                "t": "set",
                "p": "created_event_id",
                "pt": "msg",
                "to": "payload.created_event_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "created_application_ids",
                "pt": "msg",
                "to": "payload.created_application_ids",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3850,
        "y": 1140,
        "wires": [
            [
                "9ddf0b394c30ebf5"
            ]
        ]
    },
    {
        "id": "7886df4b5fe256f2",
        "type": "json",
        "z": "2c4527dad914ec1c",
        "g": "afea13b5e3ace5ed",
        "name": "json to object",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 3830,
        "y": 1200,
        "wires": [
            [
                "96a581392456dd7e"
            ]
        ]
    },
    {
        "id": "b156a7d9df56630a",
        "type": "split",
        "z": "2c4527dad914ec1c",
        "g": "afea13b5e3ace5ed",
        "name": "Event",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 3630,
        "y": 1200,
        "wires": [
            [
                "7886df4b5fe256f2"
            ]
        ]
    },
    {
        "id": "96a581392456dd7e",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "afea13b5e3ace5ed",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "event",
                "pt": "msg",
                "to": "payload",
                "tot": "msg",
                "dc": true
            },
            {
                "t": "set",
                "p": "event_id",
                "pt": "msg",
                "to": "payload.event_id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 4080,
        "y": 1200,
        "wires": [
            [
                "4832d0381e80370c"
            ]
        ]
    },
    {
        "id": "dcdcab2d3a93e4dd",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "afea13b5e3ace5ed",
        "name": "",
        "property": "payload.created_event_id",
        "propertyType": "msg",
        "rules": [
            {
                "t": "null"
            },
            {
                "t": "nnull"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 3410,
        "y": 1200,
        "wires": [
            [
                "df3121b89215a09c"
            ],
            [
                "34829d07d935abec"
            ]
        ]
    },
    {
        "id": "34829d07d935abec",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "afea13b5e3ace5ed",
        "name": "Store parameters",
        "rules": [
            {
                "t": "set",
                "p": "study_id",
                "pt": "msg",
                "to": "payload.study_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "client_id",
                "pt": "msg",
                "to": "cta-automation",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "event_id",
                "pt": "msg",
                "to": "payload.created_event_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "job.job_type",
                "pt": "msg",
                "to": "payload.job_type",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "job.job_scope",
                "pt": "msg",
                "to": "payload.job_scope",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "created_event",
                "pt": "msg",
                "to": "payload.created_event",
                "tot": "msg",
                "dc": true
            },
            {
                "t": "set",
                "p": "created_application_ids",
                "pt": "msg",
                "to": "payload.created_application_ids",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "created_event_id",
                "pt": "msg",
                "to": "payload.created_event_id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3230,
        "y": 1260,
        "wires": [
            [
                "2f7502d21fcdd942",
                "4478fbc938fa0963"
            ]
        ]
    },
    {
        "id": "3adece1ebc8ee643",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "afea13b5e3ace5ed",
        "name": "debug 293",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3250,
        "y": 1180,
        "wires": []
    },
    {
        "id": "4478fbc938fa0963",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "afea13b5e3ace5ed",
        "name": "debug 294",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3310,
        "y": 1300,
        "wires": []
    },
    {
        "id": "09f07fe60c2f6cb9",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "4cdbc47d14deae5f",
        "name": "Dispatch content plan",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "vault_api & \"v22.2/vobjects/event__rim/\" & event_id & \"/actions/Objectlifecyclestateuseraction.event__rim.planned_state__c.dispatch_global_content_plan_useraction__c\"",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "headers",
                "pt": "msg",
                "to": "{\t   \"Authorization\": session_id,\t   \"Accept\": \"application/json\",\t   \"Content-Type\": \"application/x-www-form-urlencoded\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3260,
        "y": 3300,
        "wires": [
            [
                "71f7e671c4f7b57b"
            ]
        ]
    },
    {
        "id": "71f7e671c4f7b57b",
        "type": "http request",
        "z": "2c4527dad914ec1c",
        "g": "4cdbc47d14deae5f",
        "name": "",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 3470,
        "y": 3300,
        "wires": [
            [
                "84672330f380c95e",
                "fefdf06d43eeebc2"
            ]
        ]
    },
    {
        "id": "9de4de9264b9a65d",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "af1996fdf68f3807",
        "name": "create ros",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"regulatory_objective__rim\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "applications.{\t   \"name__v\": $$.event.name__v & ' - ' & $substringBefore(name__v, \" -\"),\t   \"description_of_change__rim\": $$.event.event_description__c,\t   \"application__rim\": id,\t   \"object_type__vr.api_name__v\": \"investigational_regulatory_objective__c\",\t   \"safetyrelated__c\": \"no__c\",\t   \"regulatory_objective_type_global__c\": $$.ro_type\t}[]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3220,
        "y": 2840,
        "wires": [
            [
                "5fae1149cd1a09ff"
            ]
        ]
    },
    {
        "id": "acd4cce99dbe8a5c",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "af1996fdf68f3807",
        "name": "store result",
        "rules": [
            {
                "t": "set",
                "p": "ro_ids",
                "pt": "msg",
                "to": "payload.data[responseStatus=\"SUCCESS\"].data.id[]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3710,
        "y": 2840,
        "wires": [
            [
                "153a78ac51558834",
                "615be9c29aeb9f2a"
            ]
        ]
    },
    {
        "id": "3b26a3db4270484e",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "af1996fdf68f3807",
        "name": "link to products",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"regulatory_objective_drug_product__v\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t    ros ~> $map(\t       function($ro) {\t           study.clinical_study_products__cr.data.{\t               \"regulatory_objective__v\": $ro.id,\t               \"drug_product__v\": product__c,\t               \"product_detail__v\": product_variant__c\t        }\t    }\t    ) ~> $reduce(\t       function($accumulator, $value) {$append($accumulator, $value)}\t    )\t]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3240,
        "y": 2960,
        "wires": [
            [
                "13d22eaf8330299c"
            ]
        ]
    },
    {
        "id": "153a78ac51558834",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "af1996fdf68f3807",
        "name": "query ros",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v from regulatory_objective__rim where \" & (ro_ids ~> $map(function($v) {\"id='\" & $v & \"'\"}) ~> $join(\" OR \"))",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3220,
        "y": 2900,
        "wires": [
            [
                "bcf54a7297050edb"
            ]
        ]
    },
    {
        "id": "d8af64ecc1be1919",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "af1996fdf68f3807",
        "name": "store result",
        "rules": [
            {
                "t": "set",
                "p": "ros",
                "pt": "msg",
                "to": "payload.data",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3710,
        "y": 2900,
        "wires": [
            [
                "3b26a3db4270484e",
                "776056a1428904bd"
            ]
        ]
    },
    {
        "id": "a9d63e694c8d9d4c",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "af1996fdf68f3807",
        "name": "link to study",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"regulatory_objective_clinical_study__v\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "ros.{\t   \"regulatory_objective__v\": id,\t   \"clinical_study__v\": $$.study_id,\t   \"impd_version_nonquality_part__c\": $$.event.event_clinical_studies__vr.data.impd_version_nonquality_part__c,\t   \"impd_version_quality_part__c\": $$.event.event_clinical_studies__vr.data.impd_version_quality_part__c,\t   \"protocol_version__c\": $$.event.event_clinical_studies__vr.data.protocol_version__c,\t   \"ib_version__c\": $$.event.event_clinical_studies__vr.data.ib_version__c\t}[]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3230,
        "y": 3080,
        "wires": [
            [
                "a4b95f67c34a39d5"
            ]
        ]
    },
    {
        "id": "c0f85b4e811b690d",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "af1996fdf68f3807",
        "name": "link to submissions",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"submission_regulatory_objective__v\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "submissions#$i.{\t   \"regulatory_objective__v\": $$.ros[$i].id,\t   \"submission__v\": id\t}[]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3250,
        "y": 3140,
        "wires": [
            [
                "9cebbaf0235b3380"
            ]
        ]
    },
    {
        "id": "7dc55a7434381ac6",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "af1996fdf68f3807",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3910,
        "y": 2780,
        "wires": []
    },
    {
        "id": "615be9c29aeb9f2a",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "af1996fdf68f3807",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3910,
        "y": 2840,
        "wires": []
    },
    {
        "id": "776056a1428904bd",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "af1996fdf68f3807",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3910,
        "y": 2900,
        "wires": []
    },
    {
        "id": "43289b9ac83571d2",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "af1996fdf68f3807",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3910,
        "y": 2960,
        "wires": []
    },
    {
        "id": "659c0e50730e044a",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "af1996fdf68f3807",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3910,
        "y": 3080,
        "wires": []
    },
    {
        "id": "e974785e628c969c",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "af1996fdf68f3807",
        "name": "query ro type",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "select id from controlled_vocabulary__rim where controlled_vocabulary_type__rim = 'regulatory_objective_type_global__c' and name__v = 'New Clinical Trial' and status__v = 'active__v'",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3230,
        "y": 2780,
        "wires": [
            [
                "e47135f7f278a7aa"
            ]
        ]
    },
    {
        "id": "e4385ff11def9dd6",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "af1996fdf68f3807",
        "name": "store result",
        "rules": [
            {
                "t": "set",
                "p": "ro_type",
                "pt": "msg",
                "to": "payload.data[0].id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3710,
        "y": 2780,
        "wires": [
            [
                "9de4de9264b9a65d",
                "7dc55a7434381ac6"
            ]
        ]
    },
    {
        "id": "f09971b834b30d9b",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "af1996fdf68f3807",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3910,
        "y": 3140,
        "wires": []
    },
    {
        "id": "e47135f7f278a7aa",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "af1996fdf68f3807",
        "name": "",
        "x": 3470,
        "y": 2780,
        "wires": [
            [
                "e4385ff11def9dd6"
            ],
            [
                "be22b1d3f5feb681"
            ]
        ]
    },
    {
        "id": "5fae1149cd1a09ff",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "af1996fdf68f3807",
        "name": "",
        "x": 3480,
        "y": 2840,
        "wires": [
            [
                "acd4cce99dbe8a5c"
            ],
            [
                "be22b1d3f5feb681"
            ]
        ]
    },
    {
        "id": "bcf54a7297050edb",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "af1996fdf68f3807",
        "name": "",
        "x": 3470,
        "y": 2900,
        "wires": [
            [
                "d8af64ecc1be1919"
            ],
            [
                "be22b1d3f5feb681"
            ]
        ]
    },
    {
        "id": "13d22eaf8330299c",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "af1996fdf68f3807",
        "name": "",
        "x": 3480,
        "y": 2960,
        "wires": [
            [
                "43289b9ac83571d2",
                "54b51c9ab87013f5"
            ],
            [
                "be22b1d3f5feb681"
            ]
        ]
    },
    {
        "id": "a4b95f67c34a39d5",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "af1996fdf68f3807",
        "name": "",
        "x": 3480,
        "y": 3080,
        "wires": [
            [
                "c0f85b4e811b690d",
                "659c0e50730e044a"
            ],
            [
                "be22b1d3f5feb681"
            ]
        ]
    },
    {
        "id": "be22b1d3f5feb681",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "af1996fdf68f3807",
        "name": "",
        "mode": "link",
        "links": [
            "a1d7e010334dfdd3"
        ],
        "x": 3665,
        "y": 2980,
        "wires": []
    },
    {
        "id": "9cebbaf0235b3380",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "af1996fdf68f3807",
        "name": "",
        "x": 3480,
        "y": 3140,
        "wires": [
            [
                "f09971b834b30d9b",
                "37ab62b5076f66a9"
            ],
            [
                "be22b1d3f5feb681"
            ]
        ]
    },
    {
        "id": "37ab62b5076f66a9",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "af1996fdf68f3807",
        "name": "link to indications",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"regulatory_objective_indication__v\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t    ros ~> $map(function($ro) {\t       study.therapeutic_indication_clinical_studies__cr.data.{\t           \"indication__v\": therapeutic_indication__c,\t           \"regulatory_objective__v\": $ro.id\t        }\t    }) ~> $reduce(function($accumulator, $value) {$append($accumulator, $value)})\t]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3250,
        "y": 3200,
        "wires": [
            [
                "b4ad71faf47753af"
            ]
        ]
    },
    {
        "id": "b4ad71faf47753af",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "af1996fdf68f3807",
        "name": "",
        "x": 3480,
        "y": 3200,
        "wires": [
            [
                "6ac114583415268d",
                "09f07fe60c2f6cb9"
            ],
            [
                "be22b1d3f5feb681"
            ]
        ]
    },
    {
        "id": "6ac114583415268d",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "af1996fdf68f3807",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3910,
        "y": 3200,
        "wires": []
    },
    {
        "id": "54b51c9ab87013f5",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "af1996fdf68f3807",
        "name": "link to event",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"event_regulatory_objective__v\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "ros.{\t   \"regulatory_objective__v\": id,\t   \"event__v\": $$.event.id\t}[]\t\t",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3230,
        "y": 3020,
        "wires": [
            [
                "b7477ad69b72790b"
            ]
        ]
    },
    {
        "id": "b7477ad69b72790b",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "af1996fdf68f3807",
        "name": "",
        "x": 3480,
        "y": 3020,
        "wires": [
            [
                "4528b12e1949518c",
                "a9d63e694c8d9d4c"
            ],
            [
                "be22b1d3f5feb681"
            ]
        ]
    },
    {
        "id": "4528b12e1949518c",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "af1996fdf68f3807",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3910,
        "y": 3020,
        "wires": []
    },
    {
        "id": "035c0891e0dd692a",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "4cdbc47d14deae5f",
        "name": "link out 6",
        "mode": "link",
        "links": [
            "86ee4f73d33b2cca"
        ],
        "x": 3905,
        "y": 3280,
        "wires": []
    },
    {
        "id": "84672330f380c95e",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "4cdbc47d14deae5f",
        "name": "",
        "property": "payload.responseStatus",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "SUCCESS",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 3630,
        "y": 3300,
        "wires": [
            [
                "035c0891e0dd692a"
            ],
            [
                "7a3d292b917621ed"
            ]
        ]
    },
    {
        "id": "7a3d292b917621ed",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "4cdbc47d14deae5f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload.errors",
                "pt": "msg",
                "to": "[\t   {\t       \"type\":\"Incomplete Data\",\t       \"message\":\"Unable to create Submission Content Plan\"\t   }\t]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3820,
        "y": 3320,
        "wires": [
            [
                "be22b1d3f5feb681"
            ]
        ]
    },
    {
        "id": "7522c7b5aec3a9ef",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "49afa798aa000027",
        "name": "If Event creation needed and which type",
        "property": "job",
        "propertyType": "msg",
        "rules": [
            {
                "t": "jsonata_exp",
                "v": "job.job_type=\"1\" and $contains(job.job_scope,\"Event\") and $not($exists(event_id))",
                "vt": "jsonata"
            },
            {
                "t": "jsonata_exp",
                "v": "job.job_type=\"2\" and $contains(job.job_scope,\"Event\") and $not($exists(event_id))",
                "vt": "jsonata"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 3,
        "x": 1100,
        "y": 860,
        "wires": [
            [
                "c48a56058ff8c72f"
            ],
            [
                "85e74d8cb43654c6"
            ],
            [
                "01e20530c1d676df"
            ]
        ]
    },
    {
        "id": "01e20530c1d676df",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "49afa798aa000027",
        "name": "If Application creation needed",
        "property": "job",
        "propertyType": "msg",
        "rules": [
            {
                "t": "jsonata_exp",
                "v": "$contains(job.job_scope,\"Country\")",
                "vt": "jsonata"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1850,
        "y": 880,
        "wires": [
            [
                "492708f4a2a8a23b"
            ],
            [
                "cf3a900eaa9fb293",
                "d93fbd5a33448866"
            ]
        ]
    },
    {
        "id": "cf3a900eaa9fb293",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "49afa798aa000027",
        "name": "If record creation needed and which type",
        "property": "job",
        "propertyType": "msg",
        "rules": [
            {
                "t": "jsonata_exp",
                "v": "job.job_type=\"1\" and $contains(job.job_scope,\"Related\")",
                "vt": "jsonata"
            },
            {
                "t": "jsonata_exp",
                "v": "job.job_type=\"2\" and $contains(job.job_scope,\"Related\")",
                "vt": "jsonata"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 3,
        "x": 2660,
        "y": 880,
        "wires": [
            [
                "bcd13a4e57099bd1",
                "8cf33d612efacd67"
            ],
            [
                "bcd13a4e57099bd1",
                "8cf33d612efacd67"
            ],
            [
                "8cf33d612efacd67",
                "42678083ebcac3d6"
            ]
        ]
    },
    {
        "id": "53b94d493d8aebd4",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "49afa798aa000027",
        "name": "debug 295",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1690,
        "y": 780,
        "wires": []
    },
    {
        "id": "176b5b4f886480f6",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "49afa798aa000027",
        "name": "debug 296",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1690,
        "y": 820,
        "wires": []
    },
    {
        "id": "c48a56058ff8c72f",
        "type": "link call",
        "z": "2c4527dad914ec1c",
        "g": "49afa798aa000027",
        "name": "Create CTA Event",
        "links": [
            "327e267911d56ed7"
        ],
        "linkType": "static",
        "timeout": "10000",
        "x": 1390,
        "y": 800,
        "wires": [
            [
                "01e20530c1d676df",
                "53b94d493d8aebd4"
            ]
        ]
    },
    {
        "id": "85e74d8cb43654c6",
        "type": "link call",
        "z": "2c4527dad914ec1c",
        "g": "49afa798aa000027",
        "name": "Create Amendment Event",
        "links": [
            "ee4366403c02b6ed"
        ],
        "linkType": "static",
        "timeout": "300000",
        "x": 1410,
        "y": 840,
        "wires": [
            [
                "01e20530c1d676df",
                "176b5b4f886480f6"
            ]
        ]
    },
    {
        "id": "492708f4a2a8a23b",
        "type": "link call",
        "z": "2c4527dad914ec1c",
        "g": "49afa798aa000027",
        "name": "Create Application",
        "links": [
            "23bdf07343944511"
        ],
        "linkType": "static",
        "timeout": "10000",
        "x": 2130,
        "y": 840,
        "wires": [
            [
                "cf3a900eaa9fb293"
            ]
        ]
    },
    {
        "id": "d93fbd5a33448866",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "49afa798aa000027",
        "name": "debug 297",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2110,
        "y": 920,
        "wires": []
    },
    {
        "id": "fbcefa411dd50a96",
        "type": "http in",
        "z": "2c4527dad914ec1c",
        "g": "49afa798aa000027",
        "name": "",
        "url": "cta/execute",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 210,
        "y": 860,
        "wires": [
            [
                "d06919b14c6d2aa7"
            ]
        ]
    },
    {
        "id": "d06919b14c6d2aa7",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "49afa798aa000027",
        "name": "Store parameters",
        "rules": [
            {
                "t": "set",
                "p": "study_id",
                "pt": "msg",
                "to": "payload.study_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "client_id",
                "pt": "msg",
                "to": "payload.client_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "vault_domain_url",
                "pt": "msg",
                "to": "payload.vault_domain_url",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "session_id",
                "pt": "msg",
                "to": "payload.session_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "vault_api",
                "pt": "msg",
                "to": "vault_domain_url & \"/api/\"",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "event_id",
                "pt": "msg",
                "to": "payload.event_id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 430,
        "y": 860,
        "wires": [
            [
                "a533a86988712f6d"
            ]
        ]
    },
    {
        "id": "a533a86988712f6d",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "49afa798aa000027",
        "name": "payload.job exists?",
        "property": "$exists(payload.job)",
        "propertyType": "jsonata",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 650,
        "y": 860,
        "wires": [
            [
                "de9853d067d8ce97"
            ],
            [
                "ea5cf472d18d5375"
            ]
        ]
    },
    {
        "id": "ea5cf472d18d5375",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "49afa798aa000027",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "job.job_type",
                "pt": "msg",
                "to": "payload.job_type",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "job.job_scope",
                "pt": "msg",
                "to": "payload.job_scope",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 840,
        "y": 880,
        "wires": [
            [
                "7522c7b5aec3a9ef"
            ]
        ]
    },
    {
        "id": "de9853d067d8ce97",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "49afa798aa000027",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "job",
                "pt": "msg",
                "to": "payload.job",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 830,
        "y": 840,
        "wires": [
            [
                "7522c7b5aec3a9ef"
            ]
        ]
    },
    {
        "id": "ca49939d7d804fb3",
        "type": "http in",
        "z": "2c4527dad914ec1c",
        "g": "49afa798aa000027",
        "name": "",
        "url": "cta/execute",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 1180,
        "y": 920,
        "wires": [
            [
                "0b9aad679584a3b8"
            ]
        ]
    },
    {
        "id": "0b9aad679584a3b8",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "49afa798aa000027",
        "name": "Store parameters",
        "rules": [
            {
                "t": "set",
                "p": "study_id",
                "pt": "msg",
                "to": "payload.study_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "client_id",
                "pt": "msg",
                "to": "cta-automation",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "created_event_id",
                "pt": "msg",
                "to": "payload.event_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "event_id",
                "pt": "msg",
                "to": "payload.event_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "job.job_type",
                "pt": "msg",
                "to": "payload.job_type",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "job.job_scope",
                "pt": "msg",
                "to": "payload.job_scope",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1390,
        "y": 920,
        "wires": [
            [
                "808d87219cabb093"
            ]
        ]
    },
    {
        "id": "808d87219cabb093",
        "type": "brave-login",
        "z": "2c4527dad914ec1c",
        "g": "49afa798aa000027",
        "name": "",
        "x": 1550,
        "y": 920,
        "wires": [
            [
                "01e20530c1d676df"
            ],
            [
                "91bbab557e0bc067"
            ]
        ]
    },
    {
        "id": "91bbab557e0bc067",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "49afa798aa000027",
        "name": "link out 7",
        "mode": "link",
        "links": [
            "a1d7e010334dfdd3"
        ],
        "x": 1745,
        "y": 920,
        "wires": []
    },
    {
        "id": "bcd13a4e57099bd1",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "49afa798aa000027",
        "name": "link out 8",
        "mode": "link",
        "links": [
            "02de661d53928e64",
            "be24b3c797804fe1",
            "e3d2034e8f5e2cdb"
        ],
        "x": 2985,
        "y": 860,
        "wires": []
    },
    {
        "id": "df6e3632b0e19e34",
        "type": "link in",
        "z": "2c4527dad914ec1c",
        "g": "49afa798aa000027",
        "name": "link in 5",
        "links": [
            "4a2521f6e1a32aa0"
        ],
        "x": 2365,
        "y": 920,
        "wires": [
            [
                "cf3a900eaa9fb293"
            ]
        ]
    },
    {
        "id": "8cf33d612efacd67",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "49afa798aa000027",
        "name": "debug 298",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2670,
        "y": 780,
        "wires": []
    },
    {
        "id": "42678083ebcac3d6",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "49afa798aa000027",
        "name": "link out 9",
        "mode": "link",
        "links": [
            "86ee4f73d33b2cca"
        ],
        "x": 2985,
        "y": 900,
        "wires": []
    }
]