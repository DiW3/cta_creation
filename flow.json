[
    {
        "id": "2c4527dad914ec1c",
        "type": "tab",
        "label": "Flow 4",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "fca036ab5aa23301",
        "type": "subflow",
        "name": "Retrieve Settings",
        "info": "Retrieve an automation configuartaion object attachment from vault, or from Redis if alread exist, if not existing, it will be stored in Redis. \r\n\r\n### Node information\r\n:Initial Release (string): With building blocks version x.x.x\r\n:Description (string): Retrieve an automation configuartaion object attachment from vault, or from Redis if alread exist, if not existing, it will be stored in Redis. \r\n\r\n### Inputs\r\n: args.settings_name (string) : *(optional)* the name of the automation configuartaion object in vault, if not provided, the name '-client_id-__settings' will be used. \r\n: args.attachment_name (string) : *(optional)* the name of the object attachment in vault, it has to be a .json file, defaults to 'settings.json'. \r\n: args.keep (boolean) : *(optional)* If **false**, delete the args object. Defaults to **false**.\r\n: args.expire (integer): *(optional)* Number of seconds after redis deletes the topic automatically. Default is 24h.\r\n\r\n### Outputs\r\n1. Success\r\n: payload (object): attachment converted to an object/array\r\n\r\n1. Failure\r\n: payload (object): Error message on channel 2\r\n",
        "category": "Veeva Vault",
        "in": [
            {
                "x": 140,
                "y": 40,
                "wires": [
                    {
                        "id": "641eac4e6a3a1072"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 1800,
                "y": 480,
                "wires": [
                    {
                        "id": "9ffbd2aa8e3b35c4",
                        "port": 0
                    },
                    {
                        "id": "2fa9a7a10b10782e",
                        "port": 0
                    }
                ]
            },
            {
                "x": 1410,
                "y": 380,
                "wires": [
                    {
                        "id": "434ac0347080cde9",
                        "port": 0
                    },
                    {
                        "id": "80dbe2c3859434ef",
                        "port": 1
                    },
                    {
                        "id": "74e13d47f28fa1de",
                        "port": 1
                    },
                    {
                        "id": "bd54ec6a24f9d859",
                        "port": 1
                    },
                    {
                        "id": "e20436251156a60f",
                        "port": 1
                    }
                ]
            }
        ],
        "env": [],
        "meta": {},
        "color": "#ff0000",
        "inputLabels": [
            "get settings"
        ],
        "outputLabels": [
            "Success",
            "Error"
        ],
        "icon": "node-red/white-globe.svg"
    },
    {
        "id": "281da2542719f7ce",
        "type": "group",
        "z": "fca036ab5aa23301",
        "name": "get settings from vault",
        "style": {
            "fill": "#ffcf3f",
            "label": true,
            "color": "#777777",
            "label-position": "n"
        },
        "nodes": [
            "f2e66c06b9a9ba35",
            "3cba36dbc4be0431",
            "781204f40703ed7f",
            "bd54ec6a24f9d859",
            "74e13d47f28fa1de",
            "80dbe2c3859434ef",
            "862007a1a92de19b"
        ],
        "x": 154,
        "y": 339
    },
    {
        "id": "65512d829ddbe85d",
        "type": "group",
        "z": "fca036ab5aa23301",
        "name": "get settings from Redis",
        "style": {
            "fill": "#ffcf3f",
            "label": true,
            "label-position": "n",
            "color": "#777777"
        },
        "nodes": [
            "e20436251156a60f",
            "6adaa8b423a4321e",
            "78aa02b86a2d9b5f"
        ],
        "x": 1414,
        "y": 99
    },
    {
        "id": "a6858237518cf424",
        "type": "group",
        "z": "fca036ab5aa23301",
        "name": "get settings from Redis",
        "style": {
            "fill": "#ffcf3f",
            "label": true,
            "label-position": "n",
            "color": "#777777"
        },
        "nodes": [
            "be87b21f1e94e2d6",
            "c0e33d0da64adf97"
        ],
        "x": 354,
        "y": 599
    },
    {
        "id": "1adf9a7b09d9ec3e",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "name": "Check validity of clinical study",
        "style": {
            "fill": "#bfdbef",
            "label": true
        },
        "nodes": [
            "d1295ce2fe20155c",
            "0d04e49d871e24b5",
            "afd56f63ba84e193",
            "89aade3fd4849cf3",
            "1adcfc18ea193483",
            "e52a4fe1e67ec89d",
            "221e6a37d7438241",
            "9af30450c6112b17",
            "4eedfa2c0f6d5dca",
            "5543a07a1d0be52e",
            "92a36617cc355cc4",
            "8706a9e4bba62613",
            "427c9dafee3eee2e",
            "ace69593860de565",
            "00fdcb9a7b7f71e2",
            "05a3105881a36074",
            "7d76dabf1f75f67d",
            "ec1a25f9388786d7",
            "ecd1f9618322385c",
            "413d0d4919352499",
            "43a8f21c944f48c2",
            "ad3d43f8c209bac3",
            "de5518a5c2dcf534",
            "fc41e3958fc57881",
            "e1528945b7b35bc5",
            "7df34bf278de232c",
            "a95b3eb8a3ea40dd"
        ],
        "x": 14,
        "y": 399,
        "w": 2752,
        "h": 282
    },
    {
        "id": "4baa5eae6bccba26",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "name": "Show a generic error message",
        "style": {
            "fill": "#ffbfbf",
            "label": true
        },
        "nodes": [
            "0b4394d395558302",
            "4b18021ceb965cb3",
            "6be1c8357935ded8",
            "c5912362c452ad8c"
        ],
        "x": 4404,
        "y": 379,
        "w": 402,
        "h": 122
    },
    {
        "id": "8fe7fba9478ad6c8",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "name": "Show success message",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "38c9c876683df642",
            "6e98ee16de826386",
            "25164fe0afec3d7a"
        ],
        "x": 4404,
        "y": 539,
        "w": 402,
        "h": 82
    },
    {
        "id": "cf3f4fcb8dc2573a",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "name": "Prepare the result page",
        "style": {
            "fill": "#bfdbef",
            "label": true
        },
        "nodes": [
            "c65594f62b66ba6c",
            "6e441cc056e5c53b",
            "c3df4ccf459db19f",
            "e3f83d8d0cbdf4a4",
            "e0c1393bdfa1865e",
            "908a3e8352298a3f",
            "8a97172448094a63",
            "dd8e0450df6db078",
            "21345e0676e23ae3",
            "133e012f4802a9b2",
            "82a34d65142c7d1e",
            "25277f4f1f618498",
            "e465505a38c646ab",
            "e4d80dada213b37f",
            "dc179569b9799870",
            "b286a0092acfd283",
            "3875450d706f6724",
            "f913b67552863c67"
        ],
        "x": 3004,
        "y": 339,
        "w": 1292,
        "h": 322
    },
    {
        "id": "025d03bac4a1308c",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "name": "Amendment Event",
        "style": {
            "label": true
        },
        "nodes": [
            "4efce2b6e1fdfe62",
            "77a95a28986a8bfc",
            "e1b7d81d3cd06a62",
            "aec7dcad5b069c99",
            "2d6057ae01606945"
        ],
        "x": 8,
        "y": 2299,
        "w": 1138,
        "h": 1108
    },
    {
        "id": "b0647a0e3610ba68",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "name": "Initial Event",
        "style": {
            "label": true
        },
        "nodes": [
            "e40195be7e014804",
            "c3cc3bc6b0b0ab38"
        ],
        "x": 8,
        "y": 953,
        "w": 1024,
        "h": 994
    },
    {
        "id": "b21a8850dadd4a12",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "name": "Application",
        "style": {
            "label": true
        },
        "nodes": [
            "f4492470635578ae",
            "fa41432bb855af38",
            "213c3efa9b282b39",
            "23b14172f95f39ef",
            "0342ae8990d4e5d0",
            "3b0d3c603c0d1fd6",
            "e1b7d959e12be6a2"
        ],
        "x": 1208,
        "y": 953,
        "w": 1764,
        "h": 2594
    },
    {
        "id": "5e4f497cc3eacc9e",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "name": "Records",
        "style": {
            "label": true
        },
        "nodes": [
            "4a932e6034254d18",
            "eb7523f05c7170f0",
            "0cad5663dc4721fe",
            "2258a8ecc4d06406",
            "bc4bea3fd22cd07b",
            "a653f834e329c411",
            "7dbb9c6933b0187b",
            "1ad0402c6eac4a81",
            "cb29e4ac6ff2c120",
            "65a57ac386b4858f"
        ],
        "x": 3028,
        "y": 713,
        "w": 1164,
        "h": 2608
    },
    {
        "id": "a7a8a74946229b91",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "name": "Main stem",
        "style": {
            "fill": "#bfdbef",
            "label": true
        },
        "nodes": [
            "4e0728471558a67e",
            "0b5e993385abdbaf",
            "b3626201f7983f76",
            "cd510823c811d7c4",
            "64a2d7cc0f15b947",
            "19967e71170ecd73",
            "d046d19b53dad465",
            "3d2f1bb1ca763691",
            "115701a7b00b4c46",
            "1f4c810a5b6057fd",
            "120256ee19425fdd",
            "a69633711211e86e",
            "f8af263b4577eb60",
            "bfd4c5ba48630dad",
            "806db9d17f47a16f",
            "6517fc922a6908a8",
            "edf88ee6c1a5aee3",
            "ec46849d03dc97ee",
            "4b8eadec1c5671af",
            "0e57f11a59848a31",
            "eefb2eeedd415df4",
            "8bda251317c47732"
        ],
        "x": 14,
        "y": 699,
        "w": 2952,
        "h": 222
    },
    {
        "id": "cb0a933960ea0f9e",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "name": "get settings from vault",
        "style": {
            "fill": "#ffcf3f",
            "label": true,
            "color": "#777777",
            "label-position": "n"
        },
        "nodes": [
            "ce992dda59cd12c9",
            "a169c2eecb19ccd4",
            "3d77d5e044dee056",
            "8eb3b09584070d7f",
            "64d86b206d8d30b7",
            "36289c1d83b7740e",
            "6fdde1e72d7c411e",
            "1e48e22392c2fe29",
            "117c0f6f88e040c0"
        ],
        "x": 114,
        "y": 3719,
        "w": 792,
        "h": 322
    },
    {
        "id": "e40195be7e014804",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "g": "b0647a0e3610ba68",
        "name": "Create new clinical study event",
        "style": {
            "fill": "#ffffbf",
            "label": true
        },
        "nodes": [
            "127f606ce23423fd",
            "09acfdce79ce877b",
            "1125ca63681257a8",
            "e81f7d4c11cd8c6f",
            "f57054fb3844241f",
            "e305967f4ea2cf17",
            "780bdf10996d5dd7",
            "9059fa56b54821ca",
            "52e92467706337e4",
            "5eaedb53b36ae3ba",
            "643f9f0f66032d88",
            "99b2acd236550eec",
            "53f08c6da7acde3e",
            "3916d23c39b50211",
            "08dcb3332d416a46",
            "20c245ddd5dc2999",
            "bda7c5f6b4546054",
            "cb1e931c1520a0a2",
            "e9daca4394c17dc9",
            "43b7bc103c77a4ea",
            "7c44e24c5afad6c7",
            "9430be7746db98ea",
            "d982ee4112ccfb11",
            "8ed76db6b0e4920e",
            "f8390b9b8f960aab",
            "fb7f6db22a82a5ce",
            "1d834a7935beee6b",
            "05d9e73aaf4a53f9",
            "8c22964409200907",
            "69470779e142a87f",
            "73d1b1cc1b17b0a8",
            "8fde7159b4debb7a",
            "ac182d7b69f0f86a",
            "8cfa0940562a9266",
            "fd63e95672fb41ae",
            "eadb4a6f7d0dd4bc",
            "1e68c40c7d454e51",
            "b2a1451aac0e94f7",
            "5872344ca0191238"
        ],
        "x": 34,
        "y": 1199,
        "w": 972,
        "h": 722
    },
    {
        "id": "f4492470635578ae",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "g": "b21a8850dadd4a12",
        "name": "Create Applications",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "9bc8ca63c489f130",
            "0e58817144b122ca",
            "beaeeede45688d8f",
            "0f325294ff3deaf7",
            "352697d0f9b3b340",
            "5ee56af170f12036",
            "19e4cc04ce3ff2f3",
            "5569a704502d347e",
            "5f8c31a0b75604dc",
            "aeba6128dc0f5605",
            "26ef94169b200292",
            "c50f180f6dc5b7a7",
            "1f9e9253f0f4ed09",
            "bcdb50eb60cfc78d",
            "c87aa0067f73b660",
            "f7a46ec9815bec9e",
            "c316263822a4e043",
            "c526a83f886ee66c",
            "a710fd5c93105bef",
            "d43cbcb95adf6c56",
            "ee0a41c3e261db60"
        ],
        "x": 1234,
        "y": 2859,
        "w": 972,
        "h": 382
    },
    {
        "id": "c3cc3bc6b0b0ab38",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "g": "b0647a0e3610ba68",
        "name": "Check for existing CTA Application Event",
        "style": {
            "fill": "#ffffbf",
            "label": true
        },
        "nodes": [
            "f14722cf1050e3b6",
            "e1677939b436f9e1",
            "ace8a989e5fa795d",
            "c6e7a2c0aa81952d",
            "91a1c661f7629edc",
            "82f3a1c97692584d",
            "5301adb11c7b2c3a",
            "bdf854e2d1181a35",
            "a21361800a8e5222",
            "c83461d786b5f389"
        ],
        "x": 34,
        "y": 979,
        "w": 952,
        "h": 182
    },
    {
        "id": "fa41432bb855af38",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "g": "b21a8850dadd4a12",
        "name": "Checking if include EU CTR",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "877d493c814eb116",
            "eaa9fadb6a229543",
            "eece97d5539892a0"
        ],
        "x": 1234,
        "y": 979,
        "w": 412,
        "h": 82
    },
    {
        "id": "213c3efa9b282b39",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "g": "b21a8850dadd4a12",
        "name": "Collect Information",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "2bd0ad048ce6d34e",
            "529382b422e33baf",
            "80659552c324848c",
            "865bb03421f66f06",
            "5e50d16ff43a82fd",
            "1179a3687c6cf5a6",
            "886859ca7a54f7fd",
            "265347a384987222",
            "b44bfa5ffe29b60e",
            "5d3396e25a8c72c4",
            "d6bda7745030b8a0",
            "65e5881ebae4daa7",
            "a5c49e2191c98551",
            "71a35f478418d5d7",
            "1710ed53d4d37b5c",
            "ebb4d9b0095025e2",
            "5b81fc0c9cee31d0",
            "98a09d8faa795864",
            "551b9623d7990835",
            "d63ba5dad0268d14",
            "0c293fa5ea1d40ae",
            "3ca6345f6ae806b8",
            "d57e93c3e4dd9068",
            "36831944ea231a2c",
            "4931687c32f891d3",
            "26ea46e253a36a17",
            "6882d811cc48713f",
            "40898951895346d8",
            "c47ac8ab0a1808e1",
            "5c2196dbbf15ce94",
            "dbd00f23f54f267e",
            "96ab22406c6dcd7e",
            "c89d44f157d80bc4",
            "40b6e35085a52486"
        ],
        "x": 1234,
        "y": 2299,
        "w": 1712,
        "h": 522
    },
    {
        "id": "23b14172f95f39ef",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "g": "b21a8850dadd4a12",
        "name": "CTR process - Select non-CTR countries",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "e9ca3eba68b20dea",
            "f3946df6e7b32134",
            "1d2c66618b3e6c4f",
            "1149f834be044e54",
            "4ad7909a97e437a7",
            "078c240515b5297c",
            "9026e264d0fa9d16",
            "5b674da7b3b3c493",
            "e06fc599ded4e970",
            "99b5a29dc4898dc1",
            "f54f30035d27303f",
            "ea0561a17a3e4733",
            "7147d272c95b9b91",
            "232035efdfcc0ede",
            "6384e2cf76fa1a73",
            "2a5dbf3a114a6c7f",
            "5c5f8c6d3d14579b",
            "1ce0090dbddae5e8",
            "b1fa9325cae27f86",
            "ea17aeeb8c17f5aa",
            "30d0e763665a0f4f",
            "8f4a274d1b5bd632",
            "4379a5a24c6d2e1a",
            "c935b2229ba86e1a",
            "a29e783cc968e8c6",
            "604f50bb6db90c11",
            "52fb1526b6af11ee",
            "bdf4c22bb3725613",
            "4cbcdab4ed0ad26d",
            "b43c0eed548cafd3",
            "6a6c7efc7e51bf6d",
            "b7de0fe7ad66d2ca",
            "959da61bde9bb8b0",
            "7e622617fec07ddd",
            "b219b669e1aa3a1f",
            "4f6dbedf8f6e524e",
            "bd46d5f7dd3c56b5",
            "aabf522cbde63186",
            "8e7df44115a60b5e",
            "9304d4da4efa5f6c",
            "93250f2631c4e047"
        ],
        "x": 1234,
        "y": 1699,
        "w": 1492,
        "h": 562
    },
    {
        "id": "0342ae8990d4e5d0",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "g": "b21a8850dadd4a12",
        "name": "CTR process - Select CMS Countries",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "86268d6a0b837218",
            "f8994213aa7f8399",
            "97b53a3a8dd09761",
            "4cac1cf727b0ef9f",
            "3db241b53e5fc1f6",
            "f366310a370cb263",
            "2b6a8988be4f6aa1",
            "59a605b44b4e458f",
            "8f7f5b7af1e523e8",
            "cc8836b7ba4047c6",
            "309297c842b780cc",
            "09ab16f41f604cb4",
            "eabb62e6f580519c",
            "077d32a3b26a735d",
            "a0f6e8171e172d4a",
            "f0987bd0f1eba5cc",
            "1c94bab016a6778b",
            "3d50cf1b7e19fa64",
            "6d5e72093e4f1763",
            "62db2312adce6927",
            "2b6443fc1090bbdb",
            "2a898795a346bdae",
            "fc53ea68445af2da",
            "380f6e75443f7e3e",
            "1f5889e43a4b930a",
            "a6055687aa65ad2f",
            "a4abf52b8768caf0",
            "5945973ffe5f9e1c",
            "1e2e089e5f67454c",
            "a53bccc1a94c03cb",
            "d0a29d4805a80d8d",
            "4c13bcff35809281",
            "13bd5f110d29cf33"
        ],
        "x": 1234,
        "y": 1099,
        "w": 972,
        "h": 562
    },
    {
        "id": "4a932e6034254d18",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "g": "5e4f497cc3eacc9e",
        "name": "Create Submission",
        "style": {
            "fill": "#ffefbf",
            "label": true
        },
        "nodes": [
            "62640940a60a1f05",
            "898365ea0e27f9fa",
            "fd61c358f16a025d",
            "9398e7263bf82b17",
            "b4d75ca5d1862d0d",
            "19b4e65ee7032903",
            "f58d0bb835412fc4",
            "3a5fef5ba445dca6",
            "8e82a3e29f089f62",
            "7f14e480377ecb8f",
            "a77d51b53d8a6f23",
            "c871db4946297902",
            "14be5b3467d426ef",
            "1b109bb176828d44",
            "857c942e1e147c0c",
            "9e1f9abf0b7f18c2",
            "8d568405b4ec34f2",
            "a951ef41ea04daa1",
            "675035dafe7624c4",
            "a6fdd8a4c088efcd",
            "91c1fc453443a8e3",
            "d8d634dbb1feb7f0",
            "2a00af4ef68684ee",
            "b3093d1ee9de67e1",
            "71e04109ad804aa3",
            "b89f95ec9abb8084",
            "f5854a7cc17c0aa7",
            "9ef56b03101f70be",
            "7827ec475b7c8da5",
            "ceb33ad242526776",
            "383eedb90d0b8b41",
            "521d70b563cc5942",
            "618ef6d8cb29ffce",
            "09d4586254506745",
            "b9ecf6ddd77ad675",
            "867650c5b98c06c8",
            "119a9f972c38c24a",
            "a2813cb05abc95ed",
            "9bf734a0d565b0b0",
            "bfecddb23cb14652"
        ],
        "x": 3074,
        "y": 1959,
        "w": 912,
        "h": 702
    },
    {
        "id": "7dbb9c6933b0187b",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "g": "5e4f497cc3eacc9e",
        "name": "Create Regulatory Objective",
        "style": {
            "fill": "#ffefbf",
            "label": true
        },
        "nodes": [
            "ea8fd3395ae5fd49",
            "ea3dfeb51546e24a",
            "7282d98b9aebfd65",
            "449abf85b0dfeb5a",
            "4f666270c6fff25d",
            "dda0db44b7fc76a2",
            "92ab0d09bc0a2257",
            "50129e1a7a69e488",
            "f36d5ec80cec5d8f",
            "9104486cb4f058e0",
            "acaa1af7a2c60d83",
            "1a0e3c813639d7e8",
            "38c9f670c6aad425",
            "be244ca4d55bdd38",
            "2e6605503e1d4370",
            "9e0fbc59446d769b",
            "d054a08aba76294a",
            "33574cd26d86b730",
            "f44a6fefd13d1c10",
            "dd1397594a408f05",
            "275cac78bf29b682",
            "ac4deb9539f1fb55",
            "aa47eed378c684f0",
            "991415f1a79cd20a",
            "f6465cef2e0631c0",
            "2fee73769422c35f",
            "a539cc3ec7312d9d",
            "3d776d3161996ac6"
        ],
        "x": 3074,
        "y": 2699,
        "w": 872,
        "h": 502
    },
    {
        "id": "3b0d3c603c0d1fd6",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "g": "b21a8850dadd4a12",
        "name": "Create Application Country",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "0571712f078a2137",
            "eb1b125d55482241",
            "22075ff5491384ec",
            "bbd3c599a4d4a203",
            "b9d002f72c39627d",
            "fc7d31296cf7b12f",
            "00c17791fffdd382",
            "90e528859987db49",
            "66ccba17afd6cf21",
            "646ee80e0e3c6a5f",
            "e47b4d5d5c74d6f1",
            "9a87a1f173d5e53f",
            "80c81f840d3d8bf8",
            "8dd59e74376d6937",
            "d43907b12f64f459"
        ],
        "x": 1234,
        "y": 3259,
        "w": 1312,
        "h": 262
    },
    {
        "id": "4efce2b6e1fdfe62",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "g": "025d03bac4a1308c",
        "name": "Create new clinical study event",
        "style": {
            "fill": "#ffffbf",
            "label": true,
            "stroke": "#6f2fa0"
        },
        "nodes": [
            "34ea1cc0751f076c",
            "9ffd347dc28797f2",
            "37089233c845847c",
            "0b502743c2105427",
            "b8f295cb419ef511",
            "4fca64c6e5d7ed76",
            "7afeedf6bafee44a",
            "c407710e5c667233",
            "463d51c07d96306f",
            "66ee8a94fb2d7adc",
            "bc0bf892de0b4278",
            "5451e2d8fb92f9f3",
            "9a5044524de15b1f",
            "8b5fc85d413405da",
            "7a6a4a210e0afacd",
            "c87ff740f015c7a0",
            "156170586af1680b",
            "4a5932fab86abe01",
            "677b8bbeb3897d59",
            "18edec20a999d8ea",
            "286d257af08d6582",
            "b3fb81e7e5885281",
            "c936f98b296593d4",
            "adbccecc70ccc1de",
            "57f50ef402c17c23",
            "6f439a7a79524586",
            "6c02ed1e44e31e22",
            "ea80771e71258993",
            "d3885638377c2c4a",
            "1dd759108b42270b",
            "55ba323f168715bb",
            "67d9ed8e3673348f",
            "d75de5f5f81a0adc",
            "c4dd41f3d158cecd",
            "74f2aa2cafa46f84",
            "65c358887f4e068f",
            "37f99f391a826882",
            "b9c7b78dd7d44017",
            "2eae4c60b1476596",
            "745c1f28d5453c5b",
            "c52cd54c453f4f22",
            "c9dd85cca0928b83",
            "9f0baf50744a8972",
            "359d517b2871831f",
            "0ed372e867cabe51"
        ],
        "x": 34,
        "y": 2599,
        "w": 1072,
        "h": 782
    },
    {
        "id": "77a95a28986a8bfc",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "g": "025d03bac4a1308c",
        "name": "Select Event Keyword",
        "style": {
            "fill": "#ffffbf",
            "label": true,
            "stroke": "#6f2fa0"
        },
        "nodes": [
            "e4914f34cdb1e255",
            "82d495ca62c54a03",
            "1a580dd7501928eb",
            "20db1f0318099f37"
        ],
        "x": 34,
        "y": 2339,
        "w": 662,
        "h": 82
    },
    {
        "id": "eb7523f05c7170f0",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "g": "5e4f497cc3eacc9e",
        "name": "Select Applications",
        "style": {
            "fill": "#ffefbf",
            "label": true,
            "stroke": "#a4a4a4"
        },
        "nodes": [
            "e92dbdab8eb4e6f5",
            "3575399d43c70958",
            "c229575af81a577a",
            "6ee4c82e5bbdfb64",
            "baa100f75a1bdf83",
            "69e9f2c548c72906",
            "dbb0938eb77fb439",
            "b1d50aba3ccae290",
            "b29bd3b6b73fa3f4",
            "c5fde75660caf0e0",
            "8ea7bea18c3a37ec",
            "3e3267b7bf950552",
            "8f6dbe66602cd363",
            "6f594307a0362067",
            "d224372d0f77adba",
            "9e24def7b8e1ed20",
            "56bb3f2ede4357d3",
            "63b1e190539c60d6",
            "2d30c1a1b88ffd77",
            "9e67043bce8e07ce",
            "0acb4f725a0b3b4d",
            "368a237cb3da03f4",
            "f7b29bb7055e0a74",
            "f2ae517ed12d39ef",
            "6b4365514871b2fa",
            "a1ea860eacff14bf",
            "acbf802c7351198d"
        ],
        "x": 3054,
        "y": 1359,
        "w": 982,
        "h": 522
    },
    {
        "id": "0cad5663dc4721fe",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "g": "5e4f497cc3eacc9e",
        "name": "Select Event",
        "style": {
            "fill": "#ffefbf",
            "label": true,
            "stroke": "#a4a4a4"
        },
        "nodes": [
            "da23fd7381dc1b26",
            "f6ab8aa482d9d67f",
            "b6c6c4bc76a4ba53",
            "0181e70f2a18599b",
            "6d26ea123b445cc9",
            "8985a769a95830ae",
            "a1def3152347a0c1",
            "26a7680b9a307992",
            "ca1ba41a3b00c448",
            "35bf7c98624a0247",
            "28d47a2b92d9acde",
            "e2bbf68093902dd8",
            "70be352a47eee3c5",
            "6134dde92e85f832",
            "6e512e1221e08cb3",
            "55f7361f6ff3d3c0",
            "752081a41b761d79",
            "c20f0786cf488681"
        ],
        "x": 3054,
        "y": 739,
        "w": 1112,
        "h": 282
    },
    {
        "id": "2258a8ecc4d06406",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "g": "5e4f497cc3eacc9e",
        "name": "Select RO Type",
        "style": {
            "fill": "#ffefbf",
            "label": true,
            "stroke": "#a4a4a4"
        },
        "nodes": [
            "8de992bdd38f4d75",
            "ea2ff3f91e64e1c8",
            "322b77670ebfbc73",
            "6dae2eeabda1866b",
            "e18582e1e6af8a27",
            "48df2f80a99d8b29",
            "35a584fdbbbf184c",
            "bdd066564c6ce95f",
            "627236e68743463c",
            "4034cdfe618d83a5",
            "e7d6e3c82350409a",
            "a40d8680471a2479",
            "5d06a3bf7e00b740",
            "d4315b2a2c87f603",
            "015ffbdc35752fd2"
        ],
        "x": 3054,
        "y": 1059,
        "w": 1072,
        "h": 242
    },
    {
        "id": "e1b7d81d3cd06a62",
        "type": "group",
        "z": "2c4527dad914ec1c",
        "g": "025d03bac4a1308c",
        "name": "Provide Event information",
        "style": {
            "stroke": "#6f2fa0",
            "fill": "#ffffbf",
            "label": true
        },
        "nodes": [
            "787961bfe48f9c3f",
            "5ec534431ecdbbc3",
            "6d77e6da0d189a2f",
            "83bfb2c8803ef98a",
            "1c245cad2a9ec068",
            "23fa5da47fb79950",
            "b05a3d51f61273c5",
            "fede6ae32eca8534",
            "0eab635811c284a9",
            "9c10197129e36e22"
        ],
        "x": 34,
        "y": 2439,
        "w": 972,
        "h": 142
    },
    {
        "id": "f2e66c06b9a9ba35",
        "type": "change",
        "z": "fca036ab5aa23301",
        "g": "281da2542719f7ce",
        "name": "get automation configuration settings object id",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"SELECT id, name__v\"\t&\" FROM automation_configuration__c\" \t&\" WHERE name__v = '\"\t& args_sub.settings_name\t&\"' AND status__v = 'active__v'\"\t",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 360,
        "y": 380,
        "wires": [
            [
                "bd54ec6a24f9d859"
            ]
        ]
    },
    {
        "id": "3cba36dbc4be0431",
        "type": "change",
        "z": "fca036ab5aa23301",
        "g": "281da2542719f7ce",
        "name": "prepare request attachments",
        "rules": [
            {
                "t": "set",
                "p": "args.object_name",
                "pt": "msg",
                "to": "automation_configuration__c",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "args.object_record_id",
                "pt": "msg",
                "to": "payload.data[0].id",
                "tot": "msg",
                "dc": true
            },
            {
                "t": "set",
                "p": "args.keep",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 300,
        "y": 440,
        "wires": [
            [
                "74e13d47f28fa1de"
            ]
        ]
    },
    {
        "id": "781204f40703ed7f",
        "type": "change",
        "z": "fca036ab5aa23301",
        "g": "281da2542719f7ce",
        "name": "Set attachments to attachment_name",
        "rules": [
            {
                "t": "set",
                "p": "args.attachment_id",
                "pt": "msg",
                "to": "payload.data[filename__v=$$.args_sub.attachment_name].id",
                "tot": "jsonata",
                "dc": true
            },
            {
                "t": "set",
                "p": "args.keep",
                "pt": "msg",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 330,
        "y": 500,
        "wires": [
            [
                "80dbe2c3859434ef"
            ]
        ]
    },
    {
        "id": "bd54ec6a24f9d859",
        "type": "brave-vql-query",
        "z": "fca036ab5aa23301",
        "g": "281da2542719f7ce",
        "name": "",
        "x": 830,
        "y": 380,
        "wires": [
            [
                "3cba36dbc4be0431"
            ],
            []
        ]
    },
    {
        "id": "74e13d47f28fa1de",
        "type": "brave-retrieve-object-record-attachments",
        "z": "fca036ab5aa23301",
        "g": "281da2542719f7ce",
        "name": "",
        "x": 900,
        "y": 440,
        "wires": [
            [
                "781204f40703ed7f"
            ],
            []
        ]
    },
    {
        "id": "80dbe2c3859434ef",
        "type": "brave-download-object-record-attachment-file",
        "z": "fca036ab5aa23301",
        "g": "281da2542719f7ce",
        "name": "",
        "x": 920,
        "y": 500,
        "wires": [
            [
                "862007a1a92de19b"
            ],
            []
        ]
    },
    {
        "id": "862007a1a92de19b",
        "type": "json",
        "z": "fca036ab5aa23301",
        "g": "281da2542719f7ce",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1250,
        "y": 500,
        "wires": [
            [
                "60f4ee43b8ea1811",
                "c0e33d0da64adf97"
            ]
        ]
    },
    {
        "id": "66f404ec026a1e86",
        "type": "change",
        "z": "fca036ab5aa23301",
        "name": "settings_name",
        "rules": [
            {
                "t": "set",
                "p": "args_sub.settings_name",
                "pt": "msg",
                "to": "client_id & \"__settings\"\t",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 960,
        "y": 160,
        "wires": [
            [
                "d74f82f3ec519f0b"
            ]
        ]
    },
    {
        "id": "3a7756d9fa7a0bfd",
        "type": "switch",
        "z": "fca036ab5aa23301",
        "name": "",
        "property": "true",
        "propertyType": "jsonata",
        "rules": [
            {
                "t": "eq",
                "v": "$exists(args_sub.settings_name)and $exists(vault_api)and $exists(session_id)",
                "vt": "jsonata"
            },
            {
                "t": "eq",
                "v": "$exists(client_id) and $exists(vault_api)and $exists(session_id)",
                "vt": "jsonata"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 3,
        "x": 790,
        "y": 140,
        "wires": [
            [
                "d74f82f3ec519f0b",
                "93b92ac848544187"
            ],
            [
                "66f404ec026a1e86"
            ],
            [
                "434ac0347080cde9"
            ]
        ]
    },
    {
        "id": "434ac0347080cde9",
        "type": "change",
        "z": "fca036ab5aa23301",
        "name": "Error message",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "ERROR not enough input parameter",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 960,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "641eac4e6a3a1072",
        "type": "change",
        "z": "fca036ab5aa23301",
        "name": "mask args",
        "rules": [
            {
                "t": "set",
                "p": "args_sub",
                "pt": "msg",
                "to": "args",
                "tot": "msg",
                "dc": true
            },
            {
                "t": "move",
                "p": "args",
                "pt": "msg",
                "to": "args_in",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 290,
        "y": 40,
        "wires": [
            [
                "2b82d1df4e595d8b"
            ]
        ]
    },
    {
        "id": "60f4ee43b8ea1811",
        "type": "switch",
        "z": "fca036ab5aa23301",
        "name": "",
        "property": "args_sub.keep = true",
        "propertyType": "jsonata",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 1470,
        "y": 500,
        "wires": [
            [
                "9ffbd2aa8e3b35c4"
            ],
            [
                "2fa9a7a10b10782e"
            ]
        ]
    },
    {
        "id": "2b82d1df4e595d8b",
        "type": "switch",
        "z": "fca036ab5aa23301",
        "name": "",
        "property": "$type(args_sub.expire)=\"number\"",
        "propertyType": "jsonata",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 110,
        "y": 140,
        "wires": [
            [
                "ffd96ba83772ca58"
            ],
            [
                "8cabfa8f5e73b072"
            ]
        ]
    },
    {
        "id": "9ffbd2aa8e3b35c4",
        "type": "change",
        "z": "fca036ab5aa23301",
        "name": "reset args",
        "rules": [
            {
                "t": "move",
                "p": "args_in",
                "pt": "msg",
                "to": "args",
                "tot": "msg"
            },
            {
                "t": "delete",
                "p": "args_sub",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1620,
        "y": 460,
        "wires": [
            []
        ]
    },
    {
        "id": "8cabfa8f5e73b072",
        "type": "change",
        "z": "fca036ab5aa23301",
        "name": "set expire",
        "rules": [
            {
                "t": "set",
                "p": "args_sub.expire",
                "pt": "msg",
                "to": "24*60*60",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 260,
        "y": 220,
        "wires": [
            [
                "ffd96ba83772ca58"
            ]
        ]
    },
    {
        "id": "e20436251156a60f",
        "type": "brave-redis-queue",
        "z": "fca036ab5aa23301",
        "g": "65512d829ddbe85d",
        "name": "",
        "x": 1810,
        "y": 140,
        "wires": [
            [
                "78aa02b86a2d9b5f",
                "e1068dc03fd73659"
            ],
            []
        ]
    },
    {
        "id": "6adaa8b423a4321e",
        "type": "change",
        "z": "fca036ab5aa23301",
        "g": "65512d829ddbe85d",
        "name": "Try to read settings from Redis",
        "rules": [
            {
                "t": "set",
                "p": "args.topic",
                "pt": "msg",
                "to": "$substringBefore($substring(vault_api,8),\"/\")\t& \"__\" & args_sub.settings_name",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "args.method",
                "pt": "msg",
                "to": "GET",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "args.keep_queue",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            },
            {
                "t": "delete",
                "p": "payload",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1570,
        "y": 140,
        "wires": [
            [
                "e20436251156a60f",
                "2d89d68958642caa"
            ]
        ]
    },
    {
        "id": "2fa9a7a10b10782e",
        "type": "change",
        "z": "fca036ab5aa23301",
        "name": "delete args",
        "rules": [
            {
                "t": "delete",
                "p": "args_in",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "args_sub",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "args",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1630,
        "y": 520,
        "wires": [
            []
        ]
    },
    {
        "id": "78aa02b86a2d9b5f",
        "type": "switch",
        "z": "fca036ab5aa23301",
        "g": "65512d829ddbe85d",
        "name": "",
        "property": "payload?true:false",
        "propertyType": "jsonata",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 1990,
        "y": 140,
        "wires": [
            [
                "60f4ee43b8ea1811"
            ],
            [
                "f2e66c06b9a9ba35"
            ]
        ]
    },
    {
        "id": "be87b21f1e94e2d6",
        "type": "brave-redis-queue",
        "z": "fca036ab5aa23301",
        "g": "a6858237518cf424",
        "name": "",
        "x": 750,
        "y": 640,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "c0e33d0da64adf97",
        "type": "change",
        "z": "fca036ab5aa23301",
        "g": "a6858237518cf424",
        "name": "Write settings to Redis",
        "rules": [
            {
                "t": "set",
                "p": "args.topic",
                "pt": "msg",
                "to": "$substringBefore($substring(vault_api,8),\"/\")\t& \"__\" & args_sub.settings_name",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "args.method",
                "pt": "msg",
                "to": "SET",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "args.expire",
                "pt": "msg",
                "to": "args_sub.expire",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 480,
        "y": 640,
        "wires": [
            [
                "be87b21f1e94e2d6"
            ]
        ]
    },
    {
        "id": "ffd96ba83772ca58",
        "type": "switch",
        "z": "fca036ab5aa23301",
        "name": "",
        "property": "$type(args_sub.attachment_name) = \"string\" and\t$length($trim(args_sub.attachment_name))",
        "propertyType": "jsonata",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 430,
        "y": 140,
        "wires": [
            [
                "22eea11a1ec723a4"
            ],
            [
                "506d0aa9dcef77b4"
            ]
        ]
    },
    {
        "id": "506d0aa9dcef77b4",
        "type": "change",
        "z": "fca036ab5aa23301",
        "name": "set attachment",
        "rules": [
            {
                "t": "set",
                "p": "args_sub.attachment_name",
                "pt": "msg",
                "to": "settings.json",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 598.6666259765625,
        "y": 186.66665649414062,
        "wires": [
            [
                "3a7756d9fa7a0bfd"
            ]
        ]
    },
    {
        "id": "22eea11a1ec723a4",
        "type": "change",
        "z": "fca036ab5aa23301",
        "name": "append extension",
        "rules": [
            {
                "t": "set",
                "p": "args_sub.attachment_name",
                "pt": "msg",
                "to": "$substring(args_sub.attachment_name,-5)=\".json\"?\targs_sub.attachment_name:\targs_sub.attachment_name & \".json\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 610,
        "y": 100,
        "wires": [
            [
                "3a7756d9fa7a0bfd"
            ]
        ]
    },
    {
        "id": "d74f82f3ec519f0b",
        "type": "switch",
        "z": "fca036ab5aa23301",
        "name": "",
        "property": "args_sub.forced_renewal=true",
        "propertyType": "jsonata",
        "rules": [
            {
                "t": "false"
            },
            {
                "t": "true"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1170,
        "y": 140,
        "wires": [
            [
                "6adaa8b423a4321e"
            ],
            [
                "f2e66c06b9a9ba35"
            ]
        ]
    },
    {
        "id": "92b6319ddcc5179b",
        "type": "debug",
        "z": "fca036ab5aa23301",
        "name": "debug 160",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2090,
        "y": 60,
        "wires": []
    },
    {
        "id": "e1068dc03fd73659",
        "type": "debug",
        "z": "fca036ab5aa23301",
        "name": "debug 159",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1890,
        "y": 60,
        "wires": []
    },
    {
        "id": "bc35d3238047c6e4",
        "type": "debug",
        "z": "fca036ab5aa23301",
        "name": "debug 167",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1350,
        "y": 60,
        "wires": []
    },
    {
        "id": "7a6610a61178baf0",
        "type": "debug",
        "z": "fca036ab5aa23301",
        "name": "debug 165",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 987.22216796875,
        "y": 63.888877868652344,
        "wires": []
    },
    {
        "id": "93b92ac848544187",
        "type": "debug",
        "z": "fca036ab5aa23301",
        "name": "debug 158",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1170,
        "y": 100,
        "wires": []
    },
    {
        "id": "1c57d76c42e831f6",
        "type": "debug",
        "z": "fca036ab5aa23301",
        "name": "debug 163",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1430,
        "y": 600,
        "wires": []
    },
    {
        "id": "fdda318a7828b65d",
        "type": "debug",
        "z": "fca036ab5aa23301",
        "name": "debug 162",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1430,
        "y": 660,
        "wires": []
    },
    {
        "id": "b865262b1cb56950",
        "type": "debug",
        "z": "fca036ab5aa23301",
        "name": "debug 161",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1687.8887939453125,
        "y": 638.5555038452148,
        "wires": []
    },
    {
        "id": "2d89d68958642caa",
        "type": "debug",
        "z": "fca036ab5aa23301",
        "name": "debug 267",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1710,
        "y": 60,
        "wires": []
    },
    {
        "id": "a95b3eb8a3ea40dd",
        "type": "http in",
        "z": "2c4527dad914ec1c",
        "g": "1adf9a7b09d9ec3e",
        "name": "",
        "url": "ctad",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 120,
        "y": 460,
        "wires": [
            [
                "7df34bf278de232c"
            ]
        ]
    },
    {
        "id": "7df34bf278de232c",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "1adf9a7b09d9ec3e",
        "name": "Set basic parameters",
        "rules": [
            {
                "t": "set",
                "p": "study_id",
                "pt": "msg",
                "to": "payload.study_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "starttime",
                "pt": "msg",
                "to": "$now()",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "client_id",
                "pt": "msg",
                "to": "cta-automation",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "vault_domain_url",
                "pt": "msg",
                "to": "\"https://\" & payload.vault_domain",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 320,
        "y": 460,
        "wires": [
            [
                "e1528945b7b35bc5",
                "fc41e3958fc57881"
            ]
        ]
    },
    {
        "id": "e1528945b7b35bc5",
        "type": "brave-login",
        "z": "2c4527dad914ec1c",
        "g": "1adf9a7b09d9ec3e",
        "name": "",
        "x": 490,
        "y": 460,
        "wires": [
            [
                "0d04e49d871e24b5"
            ],
            [
                "d1295ce2fe20155c"
            ]
        ]
    },
    {
        "id": "d1295ce2fe20155c",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "1adf9a7b09d9ec3e",
        "name": "",
        "mode": "link",
        "links": [
            "0b4394d395558302"
        ],
        "x": 2715,
        "y": 440,
        "wires": []
    },
    {
        "id": "0d04e49d871e24b5",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "1adf9a7b09d9ec3e",
        "name": "query study",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, study_alias__c, product__v, product__vr.name__v, (select id, name__v, product__c, product__cr.name__v, product_family__c, product_family__cr.name__v, product_variant__c, product_variant__cr.name__v from clinical_study_products__cr), (select id, project__cr.name__v from project_clinical_studies__cr), (select id, name__v, therapeutic_indication__c, therapeutic_indication__cr.name__v from therapeutic_indication_clinical_studies__cr) from clinical_study__v where id='\" & study_id & \"'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 650,
        "y": 540,
        "wires": [
            [
                "1adcfc18ea193483"
            ]
        ]
    },
    {
        "id": "afd56f63ba84e193",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "1adf9a7b09d9ec3e",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "study",
                "pt": "msg",
                "to": "payload.data[0]",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1040,
        "y": 540,
        "wires": [
            [
                "89aade3fd4849cf3",
                "e52a4fe1e67ec89d"
            ]
        ]
    },
    {
        "id": "89aade3fd4849cf3",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "1adf9a7b09d9ec3e",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1230,
        "y": 500,
        "wires": []
    },
    {
        "id": "1adcfc18ea193483",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "1adf9a7b09d9ec3e",
        "name": "",
        "x": 830,
        "y": 540,
        "wires": [
            [
                "afd56f63ba84e193"
            ],
            [
                "d1295ce2fe20155c"
            ]
        ]
    },
    {
        "id": "e52a4fe1e67ec89d",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "1adf9a7b09d9ec3e",
        "name": "check study data",
        "property": "study",
        "propertyType": "msg",
        "rules": [
            {
                "t": "jsonata_exp",
                "v": "study.product__v = null",
                "vt": "jsonata"
            },
            {
                "t": "jsonata_exp",
                "v": "$count(study.clinical_study_products__cr.data) = 0",
                "vt": "jsonata"
            },
            {
                "t": "jsonata_exp",
                "v": "$distinct(study.clinical_study_products__cr.data.product_family__c) != study.product__v /* some products do not match primary product familiy */",
                "vt": "jsonata"
            },
            {
                "t": "jsonata_exp",
                "v": "$count(study.project_clinical_studies__cr.data) > 1",
                "vt": "jsonata"
            },
            {
                "t": "jsonata_exp",
                "v": "$count(study.therapeutic_indication_clinical_studies__cr.data) = 0",
                "vt": "jsonata"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 6,
        "x": 1450,
        "y": 540,
        "wires": [
            [
                "9af30450c6112b17"
            ],
            [
                "221e6a37d7438241"
            ],
            [
                "4eedfa2c0f6d5dca"
            ],
            [
                "ad3d43f8c209bac3"
            ],
            [
                "43a8f21c944f48c2"
            ],
            [
                "427c9dafee3eee2e"
            ]
        ]
    },
    {
        "id": "221e6a37d7438241",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "1adf9a7b09d9ec3e",
        "name": "no products",
        "rules": [
            {
                "t": "set",
                "p": "description",
                "pt": "msg",
                "to": "\"Study \" & study.name__v & \" \" & study.study_alias__c & \" is invalid.\"",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload.errors",
                "pt": "msg",
                "to": "[{\"type\":\"Incomplete Data\",\"message\":\"The study has no products\"}]",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1650,
        "y": 480,
        "wires": [
            [
                "d1295ce2fe20155c",
                "92a36617cc355cc4"
            ]
        ]
    },
    {
        "id": "9af30450c6112b17",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "1adf9a7b09d9ec3e",
        "name": "no product family",
        "rules": [
            {
                "t": "set",
                "p": "description",
                "pt": "msg",
                "to": "\"Study \" & study.name__v & \" \" & study.study_alias__c & \" is invalid.\"",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload.errors",
                "pt": "msg",
                "to": "[{\"type\":\"Incomplete Data\",\"message\":\"The study has no primary product family\"}]",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1670,
        "y": 440,
        "wires": [
            [
                "d1295ce2fe20155c",
                "8706a9e4bba62613"
            ]
        ]
    },
    {
        "id": "4eedfa2c0f6d5dca",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "1adf9a7b09d9ec3e",
        "name": "products don't match pf",
        "rules": [
            {
                "t": "set",
                "p": "description",
                "pt": "msg",
                "to": "\"Study \" & study.name__v & \" \" & study.study_alias__c & \" is invalid.\"",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload.errors",
                "pt": "msg",
                "to": "[{\"type\":\"Inconsistent Data\",\"message\":\"The product family of the products do not match the primary product family of the study\"}]",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1690,
        "y": 520,
        "wires": [
            [
                "d1295ce2fe20155c",
                "5543a07a1d0be52e"
            ]
        ]
    },
    {
        "id": "5543a07a1d0be52e",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "1adf9a7b09d9ec3e",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1890,
        "y": 520,
        "wires": []
    },
    {
        "id": "92a36617cc355cc4",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "1adf9a7b09d9ec3e",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1890,
        "y": 480,
        "wires": []
    },
    {
        "id": "8706a9e4bba62613",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "1adf9a7b09d9ec3e",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1890,
        "y": 440,
        "wires": []
    },
    {
        "id": "427c9dafee3eee2e",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "1adf9a7b09d9ec3e",
        "name": "query product family indications",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select therapeutic_indication__c, therapeutic_indication__cr.name__v from product_family_indication__c where status__v='active__v' and product_family__c='\" & study.product__v & \"'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1710,
        "y": 640,
        "wires": [
            [
                "ace69593860de565"
            ]
        ]
    },
    {
        "id": "ace69593860de565",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "1adf9a7b09d9ec3e",
        "name": "",
        "x": 1950,
        "y": 640,
        "wires": [
            [
                "00fdcb9a7b7f71e2"
            ],
            [
                "d1295ce2fe20155c"
            ]
        ]
    },
    {
        "id": "00fdcb9a7b7f71e2",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "1adf9a7b09d9ec3e",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "indications",
                "pt": "msg",
                "to": "payload.data",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2150,
        "y": 640,
        "wires": [
            [
                "05a3105881a36074"
            ]
        ]
    },
    {
        "id": "05a3105881a36074",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "1adf9a7b09d9ec3e",
        "name": "check indications",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "jsonata_exp",
                "v": "$reduce(\t   study.therapeutic_indication_clinical_studies__cr.data.therapeutic_indication__c,\t   function($a, $v) {\t       $a and $v in indications.therapeutic_indication__c\t   },\t   true\t)",
                "vt": "jsonata"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 2370,
        "y": 640,
        "wires": [
            [
                "ec1a25f9388786d7"
            ],
            [
                "7d76dabf1f75f67d"
            ]
        ]
    },
    {
        "id": "7d76dabf1f75f67d",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "1adf9a7b09d9ec3e",
        "name": "indications don't match pf",
        "rules": [
            {
                "t": "set",
                "p": "description",
                "pt": "msg",
                "to": "\"Study \" & study.name__v & \" \" & study.study_alias__c & \" is invalid.\"",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload.errors",
                "pt": "msg",
                "to": "[{\"type\":\"Inconsistent Data\",\"message\":\"At least one indication of the clinical study is not valid for the primary product family.\"}]",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2610,
        "y": 640,
        "wires": [
            [
                "d1295ce2fe20155c"
            ]
        ]
    },
    {
        "id": "127f606ce23423fd",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "create event",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"event__rim\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t   {\t       \"object_type__vr.api_name__v\": \"clinical_study_event__c\",\t       \"applicable_product_type__v\": \"drug__v\",\t       \"event_description__c\": params.event_description__c !=\"\" ? params.event_description__c : \"N/A\" & (params.shelf_life !=\"\" ? \"; Shelf life: \" & params.shelf_life : \"\"),\t       \"keywords__c\": \"clinical_initial_cta__c\",\t       \"rec__c\": rec_id,\t       \"global_application__v\": global_application,\t       \"content_plan_template__v\": \"0EP00000004B425\",\t       \"project_id__c\": study.project_clinical_studies__cr.data[0].project__c\t       \t   }\t]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 130,
        "y": 1520,
        "wires": [
            [
                "5eaedb53b36ae3ba"
            ]
        ]
    },
    {
        "id": "09acfdce79ce877b",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "store result",
        "rules": [
            {
                "t": "set",
                "p": "event_id",
                "pt": "msg",
                "to": "payload.data[0].data.id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 650,
        "y": 1520,
        "wires": [
            [
                "e305967f4ea2cf17",
                "ac182d7b69f0f86a"
            ]
        ]
    },
    {
        "id": "1125ca63681257a8",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "link to product family",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"event_product_family__c\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t   {\t       \"name__v\": event_id & \"_\" & study.product__v,\t       \"event__c\": event_id,\t       \"product_family__c\": study.product__v\t    }\t]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 160,
        "y": 1640,
        "wires": [
            [
                "643f9f0f66032d88"
            ]
        ]
    },
    {
        "id": "e81f7d4c11cd8c6f",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "link to products",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"event_drug_product__rim\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t    study.clinical_study_products__cr.data.{\t       \"event__rim\": $$.event_id,\t       \"product_family__c\": product_family__c,\t       \"drug_product__rim\": product__c,\t       \"product_detail__rim\": product_variant__c\t    }\t]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 140,
        "y": 1700,
        "wires": [
            [
                "99b2acd236550eec"
            ]
        ]
    },
    {
        "id": "f57054fb3844241f",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "link to study",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"event_clinical_study__v\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t   {\t       \"event__v\": event_id,\t       \"clinical_study__v\": study_id,\t       \"impd_version_quality_part__c\": params.impd_version_quality_part__c,\t       \"impd_version_nonquality_part__c\": params.impd_version_nonquality_part__c,\t       \"protocol_version__c\": params.protocol_version__c,\t       \"ib_version__c\": params.ib_version__c\t    }\t]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 130,
        "y": 1760,
        "wires": [
            [
                "53f08c6da7acde3e"
            ]
        ]
    },
    {
        "id": "e305967f4ea2cf17",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 870,
        "y": 1520,
        "wires": []
    },
    {
        "id": "780bdf10996d5dd7",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 870,
        "y": 1640,
        "wires": []
    },
    {
        "id": "9059fa56b54821ca",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 850,
        "y": 1700,
        "wires": []
    },
    {
        "id": "52e92467706337e4",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 870,
        "y": 1760,
        "wires": []
    },
    {
        "id": "5eaedb53b36ae3ba",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "",
        "x": 380,
        "y": 1520,
        "wires": [
            [
                "09acfdce79ce877b"
            ],
            [
                "3916d23c39b50211"
            ]
        ]
    },
    {
        "id": "643f9f0f66032d88",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "",
        "x": 380,
        "y": 1640,
        "wires": [
            [
                "e81f7d4c11cd8c6f",
                "780bdf10996d5dd7"
            ],
            [
                "3916d23c39b50211"
            ]
        ]
    },
    {
        "id": "99b2acd236550eec",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "",
        "x": 380,
        "y": 1700,
        "wires": [
            [
                "9059fa56b54821ca",
                "f57054fb3844241f"
            ],
            [
                "3916d23c39b50211"
            ]
        ]
    },
    {
        "id": "53f08c6da7acde3e",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "",
        "x": 380,
        "y": 1760,
        "wires": [
            [
                "52e92467706337e4",
                "08dcb3332d416a46"
            ],
            [
                "3916d23c39b50211"
            ]
        ]
    },
    {
        "id": "3916d23c39b50211",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "",
        "mode": "link",
        "links": [
            "0b4394d395558302"
        ],
        "x": 685,
        "y": 1680,
        "wires": []
    },
    {
        "id": "08dcb3332d416a46",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "link to indications",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"event_indication__rim\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t   study.therapeutic_indication_clinical_studies__cr.data.{\t       \"product_family__c\": $$.study.product__v,\t       \"indication__rim\": therapeutic_indication__c,\t       \"event__rim\": $$.event_id\t    }\t]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 150,
        "y": 1820,
        "wires": [
            [
                "20c245ddd5dc2999"
            ]
        ]
    },
    {
        "id": "20c245ddd5dc2999",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "",
        "x": 380,
        "y": 1820,
        "wires": [
            [
                "bda7c5f6b4546054",
                "9430be7746db98ea"
            ],
            [
                "3916d23c39b50211"
            ]
        ]
    },
    {
        "id": "bda7c5f6b4546054",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 870,
        "y": 1820,
        "wires": []
    },
    {
        "id": "cb1e931c1520a0a2",
        "type": "http in",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "",
        "url": "cta-event",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 160,
        "y": 1280,
        "wires": [
            [
                "d982ee4112ccfb11",
                "e9daca4394c17dc9"
            ]
        ]
    },
    {
        "id": "e9daca4394c17dc9",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "store parameters",
        "rules": [
            {
                "t": "set",
                "p": "study_id",
                "pt": "msg",
                "to": "payload.study_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "params",
                "pt": "msg",
                "to": "payload",
                "tot": "msg",
                "dc": true
            },
            {
                "t": "set",
                "p": "job.job_scope",
                "pt": "msg",
                "to": "payload.job_scope",
                "tot": "msg",
                "dc": true
            },
            {
                "t": "set",
                "p": "job.job_type",
                "pt": "msg",
                "to": "payload.job_type",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 410,
        "y": 1280,
        "wires": [
            [
                "7c44e24c5afad6c7",
                "43b7bc103c77a4ea"
            ]
        ]
    },
    {
        "id": "43b7bc103c77a4ea",
        "type": "brave-login",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "",
        "x": 630,
        "y": 1280,
        "wires": [
            [
                "8ed76db6b0e4920e"
            ],
            [
                "3916d23c39b50211"
            ]
        ]
    },
    {
        "id": "7c44e24c5afad6c7",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 630,
        "y": 1240,
        "wires": []
    },
    {
        "id": "9430be7746db98ea",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "restart CTA creation",
        "rules": [
            {
                "t": "set",
                "p": "headers",
                "pt": "msg",
                "to": "{\t   \"location\":\"/nodes/cta/execute?study_id=\" & study_id & \"&event_id=\" & event_id & \"&job_type=\" & job.job_type & \"&job_scope=\" & job.job_scope\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "statusCode",
                "pt": "msg",
                "to": "303",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 150,
        "y": 1880,
        "wires": [
            [
                "05d9e73aaf4a53f9"
            ]
        ]
    },
    {
        "id": "d982ee4112ccfb11",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 390,
        "y": 1240,
        "wires": []
    },
    {
        "id": "8ed76db6b0e4920e",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "query study",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, study_alias__c, product__v, product__vr.name__v, (select id, name__v, product__c, product__cr.name__v, product_family__c, product_family__cr.name__v, product_variant__c, product_variant__cr.name__v from clinical_study_products__cr), (select id, project__c, project__cr.name__v from project_clinical_studies__cr), (select id, name__v, therapeutic_indication__c, therapeutic_indication__cr.name__v from therapeutic_indication_clinical_studies__cr) from clinical_study__v where id='\" & study_id & \"'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 130,
        "y": 1340,
        "wires": [
            [
                "f8390b9b8f960aab"
            ]
        ]
    },
    {
        "id": "f8390b9b8f960aab",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "",
        "x": 370,
        "y": 1340,
        "wires": [
            [
                "fb7f6db22a82a5ce"
            ],
            [
                "3916d23c39b50211"
            ]
        ]
    },
    {
        "id": "fb7f6db22a82a5ce",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "study",
                "pt": "msg",
                "to": "payload.data[0]",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 660,
        "y": 1340,
        "wires": [
            [
                "1d834a7935beee6b",
                "eadb4a6f7d0dd4bc"
            ]
        ]
    },
    {
        "id": "1d834a7935beee6b",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 870,
        "y": 1340,
        "wires": []
    },
    {
        "id": "9bc8ca63c489f130",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "f4492470635578ae",
        "name": "link to products",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"product_application__c\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t    applications ~> $map(function($application) {\t       study.clinical_study_products__cr.data.{\t           \"application__c\": $application.id,\t           \"product_family__c\": product_family__c,\t           \"product__c\": product__c,\t           \"product_variant__c\": product_variant__c\t        }\t    }) ~> $reduce(function($accumulator, $value) {$append($accumulator, $value)})\t]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1340,
        "y": 3140,
        "wires": [
            [
                "c50f180f6dc5b7a7"
            ]
        ]
    },
    {
        "id": "0e58817144b122ca",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "f4492470635578ae",
        "name": "link to study",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"application_clinical_study__c\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "applications.{\t   \"application__c\": id,\t   \"clinical_study__c\": $$.study.id\t}[]\t",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1330,
        "y": 3080,
        "wires": [
            [
                "26ef94169b200292"
            ]
        ]
    },
    {
        "id": "beaeeede45688d8f",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "f4492470635578ae",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "application_ids",
                "pt": "msg",
                "to": "payload.data[responseStatus=\"SUCCESS\"].data.id[]",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "created_application_ids",
                "pt": "msg",
                "to": "payload.data[responseStatus=\"SUCCESS\"].data.id[]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1860,
        "y": 2900,
        "wires": [
            [
                "5ee56af170f12036",
                "0f325294ff3deaf7"
            ]
        ]
    },
    {
        "id": "0f325294ff3deaf7",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "f4492470635578ae",
        "name": "query applications",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, lead_market__rim from application__v where \" & (application_ids ~> $map(function($v) {\"id='\" & $v & \"'\"}) ~> $join(\" OR \"))",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1350,
        "y": 2960,
        "wires": [
            [
                "bcdb50eb60cfc78d"
            ]
        ]
    },
    {
        "id": "352697d0f9b3b340",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "f4492470635578ae",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "applications",
                "pt": "msg",
                "to": "payload.data",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1880,
        "y": 2960,
        "wires": [
            [
                "19e4cc04ce3ff2f3",
                "a710fd5c93105bef"
            ]
        ]
    },
    {
        "id": "5ee56af170f12036",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "f4492470635578ae",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2110,
        "y": 2900,
        "wires": []
    },
    {
        "id": "19e4cc04ce3ff2f3",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "f4492470635578ae",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2110,
        "y": 2960,
        "wires": []
    },
    {
        "id": "5569a704502d347e",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "f4492470635578ae",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2110,
        "y": 3080,
        "wires": []
    },
    {
        "id": "5f8c31a0b75604dc",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "f4492470635578ae",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2110,
        "y": 3140,
        "wires": []
    },
    {
        "id": "aeba6128dc0f5605",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "f4492470635578ae",
        "name": "",
        "x": 1580,
        "y": 2900,
        "wires": [
            [
                "beaeeede45688d8f"
            ],
            [
                "1f9e9253f0f4ed09"
            ]
        ]
    },
    {
        "id": "26ef94169b200292",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "f4492470635578ae",
        "name": "",
        "x": 1580,
        "y": 3080,
        "wires": [
            [
                "9bc8ca63c489f130",
                "5569a704502d347e"
            ],
            [
                "1f9e9253f0f4ed09"
            ]
        ]
    },
    {
        "id": "c50f180f6dc5b7a7",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "f4492470635578ae",
        "name": "",
        "x": 1580,
        "y": 3140,
        "wires": [
            [
                "5f8c31a0b75604dc",
                "c87aa0067f73b660"
            ],
            [
                "1f9e9253f0f4ed09"
            ]
        ]
    },
    {
        "id": "1f9e9253f0f4ed09",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "f4492470635578ae",
        "name": "",
        "mode": "link",
        "links": [
            "0b4394d395558302"
        ],
        "x": 1805,
        "y": 3200,
        "wires": []
    },
    {
        "id": "bcdb50eb60cfc78d",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "f4492470635578ae",
        "name": "",
        "x": 1570,
        "y": 2960,
        "wires": [
            [
                "352697d0f9b3b340"
            ],
            [
                "1f9e9253f0f4ed09"
            ]
        ]
    },
    {
        "id": "c87aa0067f73b660",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "f4492470635578ae",
        "name": "link to indications",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"application_indication__rim\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t    applications ~> $map(function($application) {\t       study.therapeutic_indication_clinical_studies__cr.data.{\t           \"therapeutic_indication__rim\": therapeutic_indication__c,\t           \"application__rim\": $application.id\t        }\t    }) ~> $reduce(function($accumulator, $value) {$append($accumulator, $value)})\t]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1350,
        "y": 3200,
        "wires": [
            [
                "f7a46ec9815bec9e"
            ]
        ]
    },
    {
        "id": "f7a46ec9815bec9e",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "f4492470635578ae",
        "name": "",
        "x": 1580,
        "y": 3200,
        "wires": [
            [
                "c316263822a4e043",
                "bbd3c599a4d4a203"
            ],
            [
                "1f9e9253f0f4ed09"
            ]
        ]
    },
    {
        "id": "c316263822a4e043",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "f4492470635578ae",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2110,
        "y": 3200,
        "wires": []
    },
    {
        "id": "f14722cf1050e3b6",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "c3cc3bc6b0b0ab38",
        "name": "query event",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v from event__rim where object_type__vr.api_name__v = 'clinical_study_event__c' and applicable_product_type__v = 'drug__v'and keywords__c = 'clinical_initial_cta__c' and id in (select id from event_clinical_studies__vr where clinical_study__v='\" & study_id & \"')\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 130,
        "y": 1080,
        "wires": [
            [
                "e1677939b436f9e1",
                "c83461d786b5f389"
            ]
        ]
    },
    {
        "id": "e1677939b436f9e1",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "c3cc3bc6b0b0ab38",
        "name": "",
        "x": 410,
        "y": 1080,
        "wires": [
            [
                "ace8a989e5fa795d",
                "bdf854e2d1181a35"
            ],
            [
                "91a1c661f7629edc"
            ]
        ]
    },
    {
        "id": "ace8a989e5fa795d",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "c3cc3bc6b0b0ab38",
        "name": "exists?",
        "property": "payload.data",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nempty"
            },
            {
                "t": "empty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 630,
        "y": 1080,
        "wires": [
            [
                "5301adb11c7b2c3a"
            ],
            [
                "c6e7a2c0aa81952d"
            ]
        ]
    },
    {
        "id": "c6e7a2c0aa81952d",
        "type": "template",
        "z": "2c4527dad914ec1c",
        "g": "c3cc3bc6b0b0ab38",
        "name": "Input Form",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "<!doctype html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"utf-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n    <title>New Clinical Study Event</title>\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css\"\n        integrity=\"sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu\" crossorigin=\"anonymous\">\n    <script src=\"https://code.jquery.com/jquery-1.12.4.min.js\"\n        integrity=\"sha384-nvAa0+6Qg9clwYCGGPpDQLVpLNn0fRaROjHqs13t4Ggj3Ez50XnGQqc/r8MhnRDZ\"\n        crossorigin=\"anonymous\"></script>\n    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js\"\n        integrity=\"sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd\"\n        crossorigin=\"anonymous\"></script>\n</head>\n\n<body>\n    <div class=\"modal fade\" id=\"modal\" tabindex=\"-1\" data-backdrop=\"static\">\n        <div class=\"modal-dialog\">\n            <div class=\"modal-content\">\n                <div class=\"modal-header\">\n                    <h4 class=\"modal-title\">Processing ...</h4>\n                </div>\n                <div class=\"modal-body\">\n                    <p>Please wait while the changes are applied.</p>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"container\">\n        <h1>New Event for Clinical Study {{study.name__v}}</h1>\n        <p>Please provide details for the new Clinical Study Event.</p>\n        <br>\n        <form class=\"form-horizontal\" method=\"post\" action=\"/nodes/cta-event\">\n            <input type=\"hidden\" name=\"study_id\" value=\"{{study_id}}\">\n            <input type=\"hidden\" name=\"job_scope\" value=\"{{job.job_scope}}\">\n            <input type=\"hidden\" name=\"job_type\" value=\"{{job.job_type}}\">\n            <div class=\"form-group\">\n                <label class=\"col-md-4 control-label\" for=\"impd_version_quality_part__c\">IMPD Version Quality Part\n                    Provided</label>\n                <div class=\"col-md-8\">\n                    <input type=\"text\" class=\"form-control\" id=\"impd_version_quality_part__c\"\n                        name=\"impd_version_quality_part__c\">\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label class=\"col-md-4 control-label\" for=\"impd_version_nonquality_part__c\">IMPD Version non- Quality\n                    Part Provided</label>\n                <div class=\"col-md-8\">\n                    <input type=\"text\" class=\"form-control\" id=\"impd_version_nonquality_part__c\"\n                        name=\"impd_version_nonquality_part__c\">\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label class=\"col-md-4 control-label\" for=\"protocol_version__c\">Protocol Version Provided</label>\n                <div class=\"col-md-8\">\n                    <input type=\"text\" class=\"form-control\" id=\"protocol_version__c\" name=\"protocol_version__c\">\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label class=\"col-md-4 control-label\" for=\"ib_version__c\">IB Version Provided</label>\n                <div class=\"col-md-8\">\n                    <input type=\"text\" class=\"form-control\" id=\"ib_version__c\" name=\"ib_version__c\">\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label class=\"col-md-4 control-label\" for=\"shelf_life\">Shelf Life</label>\n                <div class=\"col-md-8\">\n                    <input type=\"text\" class=\"form-control\" id=\"shelf_life\" name=\"shelf_life\">\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label class=\"col-md-4 control-label\" for=\"event_description__c\">Event Desciption</label>\n                <div class=\"col-md-8\">\n                    <input type=\"text\" class=\"form-control\" id=\"event_description__c\" name=\"event_description__c\">\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <div class=\"col-md-offset-4 col-md-8\">\n                    <button type=\"submit\" class=\"btn btn-primary\">Create Clinical Study Event</button>\n                </div>\n            </div>\n        </form>\n    </div>\n\n    <script>\n        $(document).ready(function(){\n            $(\"form\").submit(function() {\n                $(\"#modal\").modal(\"show\");\n            });\n        });\n    </script>\n</body>\n\n</html>",
        "output": "str",
        "x": 810,
        "y": 1120,
        "wires": [
            [
                "a21361800a8e5222"
            ]
        ]
    },
    {
        "id": "91a1c661f7629edc",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "c3cc3bc6b0b0ab38",
        "name": "",
        "mode": "link",
        "links": [
            "0b4394d395558302"
        ],
        "x": 535,
        "y": 1120,
        "wires": []
    },
    {
        "id": "0b4394d395558302",
        "type": "link in",
        "z": "2c4527dad914ec1c",
        "g": "4baa5eae6bccba26",
        "name": "Error",
        "links": [
            "2e21230765d562c0",
            "db9944eb60fbc49d",
            "c6b53c4a2748f542",
            "9256c6065eae30bf",
            "a5c49e2191c98551",
            "1f9e9253f0f4ed09",
            "ed40e4afb8f69bb1",
            "d1295ce2fe20155c",
            "3916d23c39b50211",
            "1b109bb176828d44",
            "275cac78bf29b682",
            "6a8e4f7d0f114240",
            "0b31058c8431fa69",
            "b751e69c46e6c849",
            "91a1c661f7629edc",
            "3e3e53986fc68011",
            "b5b267266e9c190a",
            "19f4967b796f2e9f",
            "e14e7058d20493e2",
            "1e2e089e5f67454c",
            "fc751c16e3989a80",
            "b7de0fe7ad66d2ca",
            "e47b4d5d5c74d6f1",
            "6dab2b9614b7b3f7",
            "af93e42bb2063079",
            "8b5fc85d413405da",
            "42424a203fc5231c",
            "ec46849d03dc97ee",
            "0acb4f725a0b3b4d",
            "e2bbf68093902dd8",
            "4cddeead6c64cd6b"
        ],
        "x": 4445,
        "y": 420,
        "wires": [
            [
                "4b18021ceb965cb3",
                "c5912362c452ad8c"
            ]
        ]
    },
    {
        "id": "4b18021ceb965cb3",
        "type": "template",
        "z": "2c4527dad914ec1c",
        "g": "4baa5eae6bccba26",
        "name": "error",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "<!doctype html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"utf-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n    <title>Error</title>\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css\"\n        integrity=\"sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu\" crossorigin=\"anonymous\">\n    <script src=\"https://code.jquery.com/jquery-1.12.4.min.js\"\n        integrity=\"sha384-nvAa0+6Qg9clwYCGGPpDQLVpLNn0fRaROjHqs13t4Ggj3Ez50XnGQqc/r8MhnRDZ\"\n        crossorigin=\"anonymous\"></script>\n    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js\"\n        integrity=\"sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd\"\n        crossorigin=\"anonymous\"></script>\n</head>\n\n<body>\n    <div class=\"container\">\n        <h2>The operation failed</h2>\n        <p>{{description}}</p>\n\n        <div class=\"table-responsive\">\n            <table id=\"selectiontable\" class=\"table table-striped table-hover\">\n                <thead>\n                    <th>Error Type</th>\n                    <th>Message</th>\n                </thead>\n                <tbody>\n                    {{#payload.errors}}\n                        <tr>\n                            <td>{{type}}</td>\n                            <td>{{message}}</td>\n                        </tr>\n                    {{/payload.errors}}\n                    {{#payload.data.errors}}\n                        <tr>\n                            <td>{{type}}</td>\n                            <td>{{message}}</td>\n                        </tr>\n                    {{/payload.data.errors}}\n                </tbody>\n            </table>\n        </div>\n    </div>\n</body>\n\n</html>",
        "output": "str",
        "x": 4570,
        "y": 420,
        "wires": [
            [
                "6be1c8357935ded8"
            ]
        ]
    },
    {
        "id": "6be1c8357935ded8",
        "type": "http response",
        "z": "2c4527dad914ec1c",
        "g": "4baa5eae6bccba26",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 4730,
        "y": 420,
        "wires": []
    },
    {
        "id": "c5912362c452ad8c",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "4baa5eae6bccba26",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 4570,
        "y": 460,
        "wires": []
    },
    {
        "id": "38c9c876683df642",
        "type": "http response",
        "z": "2c4527dad914ec1c",
        "g": "8fe7fba9478ad6c8",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 4730,
        "y": 580,
        "wires": []
    },
    {
        "id": "6e98ee16de826386",
        "type": "link in",
        "z": "2c4527dad914ec1c",
        "g": "8fe7fba9478ad6c8",
        "name": "success",
        "links": [
            "def796fcf8b7ba68",
            "6610faf99d69fa98",
            "c65594f62b66ba6c"
        ],
        "x": 4445,
        "y": 580,
        "wires": [
            [
                "25164fe0afec3d7a"
            ]
        ]
    },
    {
        "id": "25164fe0afec3d7a",
        "type": "brave-input-form",
        "z": "2c4527dad914ec1c",
        "g": "8fe7fba9478ad6c8",
        "name": "",
        "x": 4570,
        "y": 580,
        "wires": [
            [
                "38c9c876683df642"
            ]
        ]
    },
    {
        "id": "877d493c814eb116",
        "type": "template",
        "z": "2c4527dad914ec1c",
        "g": "fa41432bb855af38",
        "name": "Input Form",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "<!doctype html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"utf-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n    <title>Defining scope</title>\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css\"\n        integrity=\"sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu\" crossorigin=\"anonymous\">\n    <script src=\"https://code.jquery.com/jquery-1.12.4.min.js\"\n        integrity=\"sha384-nvAa0+6Qg9clwYCGGPpDQLVpLNn0fRaROjHqs13t4Ggj3Ez50XnGQqc/r8MhnRDZ\"\n        crossorigin=\"anonymous\"></script>\n    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js\"\n        integrity=\"sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd\"\n        crossorigin=\"anonymous\"></script>\n</head>\n\n<body>\n    <div class=\"modal fade\" id=\"modal\" tabindex=\"-1\" data-backdrop=\"static\">\n        <div class=\"modal-dialog\">\n            <div class=\"modal-content\">\n                <div class=\"modal-header\">\n                    <h4 class=\"modal-title\">Processing ...</h4>\n                </div>\n                <div class=\"modal-body\">\n                    <p>Please wait while the changes are applied.</p>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"container\">\n        <h1>Please specify if you need to create EU CTR Application for the study {{study.name__v}}</h1>\n        <p> </p>\n        <br>\n        <form class=\"form-horizontal\" method=\"post\" action=\"/nodes/cta/cms\">\n            <input type=\"hidden\" name=\"study_id\" value=\"{{study_id}}\">\n            <input type=\"hidden\" name=\"job_type\" value=\"{{job.job_type}}\">\n            <input type=\"hidden\" name=\"job_scope\" value=\"{{job.job_scope}}\">\n            <input type=\"hidden\" name=\"created_event_id\" value=\"{{created_event_id}}\">\n            <div class=\"form-group\">\n                <div class=\"col-md-offset-4 col-md-8\">\n                    <button type=\"submit\" class=\"btn btn-primary\">Yes</button>\n                </div>\n            </div>\n        </form>\n        <form class=\"form-horizontal\" method=\"post\" action=\"/nodes/cta/ctd\">\n            <input type=\"hidden\" name=\"study_id\" value=\"{{study_id}}\">\n            <input type=\"hidden\" name=\"job_type\" value=\"{{job.job_type}}\">\n            <input type=\"hidden\" name=\"job_scope\" value=\"{{job.job_scope}}\">\n            <input type=\"hidden\" name=\"created_event_id\" value=\"{{created_event_id}}\">\n            <div class=\"form-group\">\n                <div class=\"col-md-offset-4 col-md-8\">\n                    <button type=\"submit\" class=\"btn btn-primary\">No</button>\n                </div>\n            </div>\n        </form>\n    </div>\n\n    <script>\n        $(document).ready(function(){\n            $(\"form\").submit(function() {\n                $(\"#modal\").modal(\"show\");\n            });\n        });\n    </script>\n</body>\n\n</html>",
        "output": "str",
        "x": 1410,
        "y": 1020,
        "wires": [
            [
                "eaa9fadb6a229543"
            ]
        ]
    },
    {
        "id": "eaa9fadb6a229543",
        "type": "http response",
        "z": "2c4527dad914ec1c",
        "g": "fa41432bb855af38",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 1570,
        "y": 1020,
        "wires": []
    },
    {
        "id": "2bd0ad048ce6d34e",
        "type": "http in",
        "z": "2c4527dad914ec1c",
        "g": "213c3efa9b282b39",
        "name": "",
        "url": "cta/app_country",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 1380,
        "y": 2340,
        "wires": [
            [
                "dbd00f23f54f267e"
            ]
        ]
    },
    {
        "id": "529382b422e33baf",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "213c3efa9b282b39",
        "name": "query study",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, study_alias__c, product__v, product__vr.name__v, (select id, name__v, product__c, product__cr.name__v, product_family__c, product_family__cr.name__v, product_variant__c, product_variant__cr.name__v from clinical_study_products__cr), (select id, name__v, therapeutic_indication__c, therapeutic_indication__cr.name__v from therapeutic_indication_clinical_studies__cr) from clinical_study__v where id='\" & study_id & \"'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2170,
        "y": 2640,
        "wires": [
            [
                "71a35f478418d5d7"
            ]
        ]
    },
    {
        "id": "80659552c324848c",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "213c3efa9b282b39",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "study",
                "pt": "msg",
                "to": "payload.data[0]",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2620,
        "y": 2640,
        "wires": [
            [
                "5d3396e25a8c72c4",
                "1710ed53d4d37b5c"
            ]
        ]
    },
    {
        "id": "865bb03421f66f06",
        "type": "split",
        "z": "2c4527dad914ec1c",
        "g": "213c3efa9b282b39",
        "name": "for each country",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 2400,
        "y": 2520,
        "wires": [
            [
                "1179a3687c6cf5a6"
            ]
        ]
    },
    {
        "id": "5e50d16ff43a82fd",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "213c3efa9b282b39",
        "name": "store parameters",
        "rules": [
            {
                "t": "set",
                "p": "study_id",
                "pt": "msg",
                "to": "payload.study_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "countries",
                "pt": "msg",
                "to": "payload.response_full[]",
                "tot": "jsonata",
                "dc": true
            },
            {
                "t": "set",
                "p": "cms_countries_string",
                "pt": "msg",
                "to": "payload.cms_countries",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "lead_country_string",
                "pt": "msg",
                "to": "payload.lead_country",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "client_id",
                "pt": "msg",
                "to": "cta-automation",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "job.job_scope",
                "pt": "msg",
                "to": "payload.job_scope",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "job.job_type",
                "pt": "msg",
                "to": "payload.job_type",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "created_event_id",
                "pt": "msg",
                "to": "payload.created_event_id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1930,
        "y": 2340,
        "wires": [
            [
                "65e5881ebae4daa7"
            ]
        ]
    },
    {
        "id": "1179a3687c6cf5a6",
        "type": "json",
        "z": "2c4527dad914ec1c",
        "g": "213c3efa9b282b39",
        "name": "json to object",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 2170,
        "y": 2580,
        "wires": [
            [
                "886859ca7a54f7fd"
            ]
        ]
    },
    {
        "id": "886859ca7a54f7fd",
        "type": "join",
        "z": "2c4527dad914ec1c",
        "g": "213c3efa9b282b39",
        "name": "",
        "mode": "auto",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": true,
        "timeout": "",
        "count": "",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 2330,
        "y": 2580,
        "wires": [
            [
                "d6bda7745030b8a0"
            ]
        ]
    },
    {
        "id": "265347a384987222",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "213c3efa9b282b39",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2850,
        "y": 2580,
        "wires": []
    },
    {
        "id": "b44bfa5ffe29b60e",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "213c3efa9b282b39",
        "name": "parse countries",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "countries",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2180,
        "y": 2520,
        "wires": [
            [
                "865bb03421f66f06"
            ]
        ]
    },
    {
        "id": "5d3396e25a8c72c4",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "213c3efa9b282b39",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2850,
        "y": 2640,
        "wires": []
    },
    {
        "id": "d6bda7745030b8a0",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "213c3efa9b282b39",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "countries",
                "pt": "msg",
                "to": "payload",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2490,
        "y": 2580,
        "wires": [
            [
                "265347a384987222",
                "529382b422e33baf"
            ]
        ]
    },
    {
        "id": "65e5881ebae4daa7",
        "type": "brave-login",
        "z": "2c4527dad914ec1c",
        "g": "213c3efa9b282b39",
        "name": "",
        "x": 2150,
        "y": 2340,
        "wires": [
            [
                "96ab22406c6dcd7e",
                "c89d44f157d80bc4"
            ],
            [
                "b7de0fe7ad66d2ca"
            ]
        ]
    },
    {
        "id": "a5c49e2191c98551",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "213c3efa9b282b39",
        "name": "",
        "mode": "link",
        "links": [
            "0b4394d395558302"
        ],
        "x": 2565,
        "y": 2780,
        "wires": []
    },
    {
        "id": "71a35f478418d5d7",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "213c3efa9b282b39",
        "name": "",
        "x": 2390,
        "y": 2640,
        "wires": [
            [
                "80659552c324848c"
            ],
            [
                "a5c49e2191c98551"
            ]
        ]
    },
    {
        "id": "1710ed53d4d37b5c",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "213c3efa9b282b39",
        "name": "query event",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, event_description__c, (select id, impd_version_nonquality_part__c, impd_version_quality_part__c, protocol_version__c, ib_version__c from event_clinical_studies__vr) from event__rim where object_type__vr.api_name__v = 'clinical_study_event__c' and applicable_product_type__v = 'drug__v'and keywords__c = 'clinical_initial_cta__c' and id in (select id from event_clinical_studies__vr where clinical_study__v='\" & study_id & \"')\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2170,
        "y": 2700,
        "wires": [
            [
                "ebb4d9b0095025e2"
            ]
        ]
    },
    {
        "id": "ebb4d9b0095025e2",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "213c3efa9b282b39",
        "name": "",
        "x": 2390,
        "y": 2700,
        "wires": [
            [
                "5b81fc0c9cee31d0"
            ],
            [
                "a5c49e2191c98551"
            ]
        ]
    },
    {
        "id": "5b81fc0c9cee31d0",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "213c3efa9b282b39",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "event",
                "pt": "msg",
                "to": "payload.data[0]",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2620,
        "y": 2700,
        "wires": [
            [
                "98a09d8faa795864",
                "c526a83f886ee66c"
            ]
        ]
    },
    {
        "id": "98a09d8faa795864",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "213c3efa9b282b39",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2850,
        "y": 2700,
        "wires": []
    },
    {
        "id": "551b9623d7990835",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "213c3efa9b282b39",
        "name": "parse Lead country",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "lead_country_string",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1490,
        "y": 2400,
        "wires": [
            [
                "0c293fa5ea1d40ae"
            ]
        ]
    },
    {
        "id": "d63ba5dad0268d14",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "213c3efa9b282b39",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "lead_country",
                "pt": "msg",
                "to": "payload",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2200,
        "y": 2400,
        "wires": [
            [
                "6882d811cc48713f",
                "3ca6345f6ae806b8"
            ]
        ]
    },
    {
        "id": "0c293fa5ea1d40ae",
        "type": "split",
        "z": "2c4527dad914ec1c",
        "g": "213c3efa9b282b39",
        "name": "for each country",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1700,
        "y": 2400,
        "wires": [
            [
                "36831944ea231a2c"
            ]
        ]
    },
    {
        "id": "3ca6345f6ae806b8",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "213c3efa9b282b39",
        "name": "parse CMS countries",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "cms_countries_string",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1500,
        "y": 2460,
        "wires": [
            [
                "d57e93c3e4dd9068"
            ]
        ]
    },
    {
        "id": "d57e93c3e4dd9068",
        "type": "json",
        "z": "2c4527dad914ec1c",
        "g": "213c3efa9b282b39",
        "name": "json to object",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 1690,
        "y": 2460,
        "wires": [
            [
                "4931687c32f891d3"
            ]
        ]
    },
    {
        "id": "36831944ea231a2c",
        "type": "json",
        "z": "2c4527dad914ec1c",
        "g": "213c3efa9b282b39",
        "name": "json to object",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 1910,
        "y": 2400,
        "wires": [
            [
                "d63ba5dad0268d14"
            ]
        ]
    },
    {
        "id": "4931687c32f891d3",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "213c3efa9b282b39",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "cms_countries",
                "pt": "msg",
                "to": "payload",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1920,
        "y": 2460,
        "wires": [
            [
                "26ea46e253a36a17",
                "40898951895346d8"
            ]
        ]
    },
    {
        "id": "26ea46e253a36a17",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "213c3efa9b282b39",
        "name": "msg",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2410,
        "y": 2460,
        "wires": []
    },
    {
        "id": "6882d811cc48713f",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "213c3efa9b282b39",
        "name": "msg",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2410,
        "y": 2400,
        "wires": []
    },
    {
        "id": "40898951895346d8",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "213c3efa9b282b39",
        "name": "Check if non_CTR countries are selected",
        "property": "payload.countries",
        "propertyType": "msg",
        "rules": [
            {
                "t": "jsonata_exp",
                "v": "$exists(countries)",
                "vt": "jsonata"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1880,
        "y": 2520,
        "wires": [
            [
                "b44bfa5ffe29b60e"
            ],
            [
                "c47ac8ab0a1808e1"
            ]
        ]
    },
    {
        "id": "c47ac8ab0a1808e1",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "213c3efa9b282b39",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "countries",
                "pt": "msg",
                "to": "[]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1490,
        "y": 2580,
        "wires": [
            [
                "5c2196dbbf15ce94",
                "529382b422e33baf"
            ]
        ]
    },
    {
        "id": "5c2196dbbf15ce94",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "213c3efa9b282b39",
        "name": "debug 351",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1710,
        "y": 2680,
        "wires": []
    },
    {
        "id": "dbd00f23f54f267e",
        "type": "json",
        "z": "2c4527dad914ec1c",
        "g": "213c3efa9b282b39",
        "name": "resp_full",
        "property": "payload.response_full",
        "action": "obj",
        "pretty": false,
        "x": 1680,
        "y": 2340,
        "wires": [
            [
                "5e50d16ff43a82fd"
            ]
        ]
    },
    {
        "id": "e9ca3eba68b20dea",
        "type": "http response",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 2050,
        "y": 2220,
        "wires": []
    },
    {
        "id": "f3946df6e7b32134",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "set msg.application_types",
        "rules": [
            {
                "t": "set",
                "p": "application_types",
                "pt": "msg",
                "to": "$distinct(payload.data).{\t   \"country_id\": country__rim,\t   \"country_name\": `country__rimr.name__v`,\t   \"country_code\": `country__rimr.country_code__rim`,\t   \"region_id\": region__rim,\t   \"region_name\": `region__rimr.name__v`,\t   \"application_type_id\": cv_1__rim,\t   \"application_type\": `cv_1__rimr.name__v`\t} ~> $filter(function($v) {\t    $v.region_name = \"European Union\" and $v.application_type != \"CTA Regulation\" and $v.application_type != \"Paediatric Investigation Plan (PIP)\" and $v.application_type != \"Orphan Drug Designation Application\"or\t    $v.country_name = \"United States\" and $v.application_type = \"Investigational New Drug (IND)\" or\t    $v.region_name != \"European Union\" and $v.country_name != \"United States\" and $v.application_type != \"Paediatric Investigation Plan (PIP)\"\t})",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "full_application_types",
                "pt": "msg",
                "to": "application_types[country_id=null]\t/* Replace null countries with a list of all countries in that region */\t~> $map(function($t) {$.countries[region_id=$t.region_id] ~> $map(function($c) {$merge([$t,$c])})})\t/* Reduce list of lists to single list */\t~> $reduce(function($i, $v) { $append($i, $v) })\t/* Join with non-null countries */\t~> $append(application_types[country_id!=null])\t/* Filter out already existing applications */\t/* by using the Countries in Lead Country*/\t~> $filter(function($v) {$count(applications[lead_market__rim=$v.country_id and application_type__rim=$v.application_type_id])=0})\t/* by using the Countries in Application Country join*/\t~> $filter(function($v) {$count(application_countries[country__rim=$v.country_id and `application__rimr.application_type__rim`=$v.application_type_id])=0})\t/* Filter out Common (EU) and Common (GCC) */\t~> $filter(function($v) {$v.country_name != \"Common (EU)\" and $v.country_name != \"Common (GCC)\"})\t/* Sort by name */\t~> $sort(function($l, $r) {$l.country_name > $r.country_name})\t",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2110,
        "y": 2140,
        "wires": [
            [
                "078c240515b5297c",
                "b43c0eed548cafd3"
            ]
        ]
    },
    {
        "id": "1d2c66618b3e6c4f",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2590,
        "y": 2200,
        "wires": []
    },
    {
        "id": "1149f834be044e54",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "countries",
                "pt": "msg",
                "to": "payload.data.{\t   \"country_id\": id,\t   \"country_name\": name__v,\t   \"country_code\": country_code__rim,\t   \"region_id\": region__v,\t   \"region_name\": `region__vr.name__v`\t}",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2090,
        "y": 1960,
        "wires": [
            [
                "4ad7909a97e437a7",
                "bd46d5f7dd3c56b5"
            ]
        ]
    },
    {
        "id": "4ad7909a97e437a7",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2590,
        "y": 1940,
        "wires": []
    },
    {
        "id": "078c240515b5297c",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2590,
        "y": 2140,
        "wires": []
    },
    {
        "id": "9026e264d0fa9d16",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "",
        "x": 1870,
        "y": 1960,
        "wires": [
            [
                "1149f834be044e54"
            ],
            [
                "b7de0fe7ad66d2ca"
            ]
        ]
    },
    {
        "id": "5b674da7b3b3c493",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "",
        "x": 1870,
        "y": 2140,
        "wires": [
            [
                "f3946df6e7b32134"
            ],
            [
                "b7de0fe7ad66d2ca"
            ]
        ]
    },
    {
        "id": "e06fc599ded4e970",
        "type": "brave-input-form",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "",
        "x": 1870,
        "y": 2200,
        "wires": [
            [
                "e9ca3eba68b20dea",
                "1d2c66618b3e6c4f"
            ]
        ]
    },
    {
        "id": "99b5a29dc4898dc1",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "",
        "x": 1870,
        "y": 2080,
        "wires": [
            [
                "f54f30035d27303f"
            ],
            [
                "b7de0fe7ad66d2ca"
            ]
        ]
    },
    {
        "id": "f54f30035d27303f",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "applications",
                "pt": "msg",
                "to": "payload.data",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2100,
        "y": 2080,
        "wires": [
            [
                "4cbcdab4ed0ad26d",
                "ea0561a17a3e4733"
            ]
        ]
    },
    {
        "id": "ea0561a17a3e4733",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2590,
        "y": 2080,
        "wires": []
    },
    {
        "id": "7147d272c95b9b91",
        "type": "brave-login",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "",
        "x": 2350,
        "y": 1740,
        "wires": [
            [
                "a29e783cc968e8c6",
                "93250f2631c4e047"
            ],
            [
                "1e2e089e5f67454c"
            ]
        ]
    },
    {
        "id": "232035efdfcc0ede",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "store parameters",
        "rules": [
            {
                "t": "set",
                "p": "study_id",
                "pt": "msg",
                "to": "payload.study_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "event_id",
                "pt": "msg",
                "to": "payload.event_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "cms_countries_string",
                "pt": "msg",
                "to": "payload.response_full[]",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "lead_country_string",
                "pt": "msg",
                "to": "payload.lead_country",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "client_id",
                "pt": "msg",
                "to": "cta-automation",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "job.job_type",
                "pt": "msg",
                "to": "payload.job_type",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "job.job_scope",
                "pt": "msg",
                "to": "payload.job_scope",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "created_event_id",
                "pt": "msg",
                "to": "payload.created_event_id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2090,
        "y": 1740,
        "wires": [
            [
                "7147d272c95b9b91"
            ]
        ]
    },
    {
        "id": "6384e2cf76fa1a73",
        "type": "split",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "for each country",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1880,
        "y": 1800,
        "wires": [
            [
                "2a5dbf3a114a6c7f"
            ]
        ]
    },
    {
        "id": "2a5dbf3a114a6c7f",
        "type": "json",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "json to object",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 2070,
        "y": 1800,
        "wires": [
            [
                "5c5f8c6d3d14579b"
            ]
        ]
    },
    {
        "id": "5c5f8c6d3d14579b",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "lead_country",
                "pt": "msg",
                "to": "payload",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2400,
        "y": 1800,
        "wires": [
            [
                "1ce0090dbddae5e8",
                "604f50bb6db90c11"
            ]
        ]
    },
    {
        "id": "1ce0090dbddae5e8",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "msg",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2590,
        "y": 1800,
        "wires": []
    },
    {
        "id": "b1fa9325cae27f86",
        "type": "split",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "for each country",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1880,
        "y": 1860,
        "wires": [
            [
                "ea17aeeb8c17f5aa"
            ]
        ]
    },
    {
        "id": "ea17aeeb8c17f5aa",
        "type": "json",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "json to object",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 2070,
        "y": 1860,
        "wires": [
            [
                "30d0e763665a0f4f"
            ]
        ]
    },
    {
        "id": "30d0e763665a0f4f",
        "type": "join",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "",
        "mode": "auto",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": true,
        "timeout": "",
        "count": "",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 2230,
        "y": 1860,
        "wires": [
            [
                "8f4a274d1b5bd632"
            ]
        ]
    },
    {
        "id": "8f4a274d1b5bd632",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "cms_countries",
                "pt": "msg",
                "to": "payload",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2400,
        "y": 1860,
        "wires": [
            [
                "52fb1526b6af11ee",
                "4379a5a24c6d2e1a"
            ]
        ]
    },
    {
        "id": "4379a5a24c6d2e1a",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "msg",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2590,
        "y": 1860,
        "wires": []
    },
    {
        "id": "c935b2229ba86e1a",
        "type": "http in",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "",
        "url": "cta/ctd",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 1350,
        "y": 1740,
        "wires": [
            [
                "959da61bde9bb8b0"
            ]
        ]
    },
    {
        "id": "a29e783cc968e8c6",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "parse Lead country",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "lead_country_string",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1610,
        "y": 1800,
        "wires": [
            [
                "6384e2cf76fa1a73"
            ]
        ]
    },
    {
        "id": "604f50bb6db90c11",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "parse CMS countries",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "cms_countries_string",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1620,
        "y": 1860,
        "wires": [
            [
                "b1fa9325cae27f86"
            ]
        ]
    },
    {
        "id": "52fb1526b6af11ee",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "query countries",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, country_code__rim, region__v, region__vr.name__v from country__v where status__v = 'active__v' and id !='\" & $.lead_country[0].country_id & \"' AND \" & (cms_countries.country_id ~> $map(function($v) {\"id!='\" & $v & \"'\"}) ~> $join(\" AND \"))",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1600,
        "y": 1920,
        "wires": [
            [
                "9026e264d0fa9d16"
            ]
        ]
    },
    {
        "id": "bdf4c22bb3725613",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "query existing applications",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v,lead_market__rim, application_type__rim from application__v where clinical_study__c = '\" & study_id & \"'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1640,
        "y": 2080,
        "wires": [
            [
                "99b5a29dc4898dc1"
            ]
        ]
    },
    {
        "id": "4cbcdab4ed0ad26d",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "query application types",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "SELECT country__rim, country__rimr.name__v, country__rimr.country_code__rim, region__rim, region__rimr.name__v, cv_1__rim, cv_1__rimr.name__v FROM constraint__rim WHERE applicable_product_type__v = 'drug__v' AND constraint_scope__v = 'investigational__c' AND status__v = 'active__v' AND cv_1__rimr.controlled_vocabulary_type__rim = 'application_type__rim' AND cv_1__rimr.status__v = 'active__v'",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1620,
        "y": 2140,
        "wires": [
            [
                "5b674da7b3b3c493"
            ]
        ]
    },
    {
        "id": "b43c0eed548cafd3",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "set fields for input form",
        "rules": [
            {
                "t": "set",
                "p": "title",
                "pt": "msg",
                "to": "Please select the target countries for new CTAs",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "type",
                "pt": "msg",
                "to": "checkbox",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "description",
                "pt": "msg",
                "to": "\"For Study \" & flow.study.name__v & \" \" & study.study_alias__c & \". Leave empty if not applicable.\"",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "tableheader",
                "pt": "msg",
                "to": "{\"columns\":[\"Country\",\"Region\",\"Application Type\"]}",
                "tot": "json"
            },
            {
                "t": "set",
                "p": "dataarray",
                "pt": "msg",
                "to": "full_application_types.{\t   \"selection\": $string(),\t   \"columns\": [\t       country_name,\t       region_name,\t       application_type\t   ]\t}",
                "tot": "jsonata",
                "dc": true
            },
            {
                "t": "set",
                "p": "flow",
                "pt": "msg",
                "to": "nodes/cta/app_country",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "hiddenfields",
                "pt": "msg",
                "to": "[\t   {\t       \"name\": \"study_id\",\t       \"value\": study_id\t    },\t    {\t        \"name\": \"lead_country\",\t        \"value\": $string(lead_country)\t    },\t    {\t        \"name\": \"cms_countries\",\t        \"value\": $string(cms_countries)\t    },\t    {\t        \"name\": \"event_id\",\t        \"value\": event_id\t    },\t    {\t        \"name\": \"created_event_id\",\t        \"value\": created_event_id\t    },\t    {\t        \"name\": \"job_type\",\t        \"value\": job.job_type\t    },\t    {\t        \"name\": \"job_scope\",\t        \"value\": job.job_scope\t    }\t\t]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1620,
        "y": 2200,
        "wires": [
            [
                "e06fc599ded4e970"
            ]
        ]
    },
    {
        "id": "6a6c7efc7e51bf6d",
        "type": "json",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "resp_full",
        "property": "payload.response_full",
        "action": "obj",
        "pretty": false,
        "x": 1860,
        "y": 1740,
        "wires": [
            [
                "232035efdfcc0ede"
            ]
        ]
    },
    {
        "id": "b7de0fe7ad66d2ca",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "link out 8",
        "mode": "link",
        "links": [
            "0b4394d395558302"
        ],
        "x": 2265,
        "y": 2220,
        "wires": []
    },
    {
        "id": "86268d6a0b837218",
        "type": "http response",
        "z": "2c4527dad914ec1c",
        "g": "0342ae8990d4e5d0",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 2110,
        "y": 1600,
        "wires": []
    },
    {
        "id": "f8994213aa7f8399",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "0342ae8990d4e5d0",
        "name": "set msg.application_types",
        "rules": [
            {
                "t": "set",
                "p": "application_types",
                "pt": "msg",
                "to": "$distinct(payload.data).{\t   \"country_id\": country__rim,\t   \"country_name\": `country__rimr.name__v`,\t   \"country_code\": `country__rimr.country_code__rim`,\t   \"region_id\": region__rim,\t   \"region_name\": `region__rimr.name__v`,\t   \"application_type_id\": cv_1__rim,\t   \"application_type\": `cv_1__rimr.name__v`\t} ~> $filter(function($v) {\t    $v.region_name = \"European Union\" and $v.application_type = \"CTA Regulation\" and $v.country_id !=$.lead_country.country_id\t})",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "full_application_types",
                "pt": "msg",
                "to": "application_types[country_id=null]\t/* Replace null countries with a list of all countries in that region */\t~> $map(function($t) {$.countries[region_id=$t.region_id] ~> $map(function($c) {$merge([$t,$c])})})\t/* Reduce list of lists to single list */\t~> $reduce(function($i, $v) { $append($i, $v) })\t/* Join with non-null countries */\t~> $append(application_types[country_id!=null])\t/* Filter out already existing applications */\t/* by using the Countries in Lead Country*/\t~> $filter(function($v) {$count(applications[lead_market__rim=$v.country_id and application_type__rim=$v.application_type_id])=0})\t/* by using the Countries in Application Country join*/\t~> $filter(function($v) {$count(application_countries[country__rim=$v.country_id and `application__rimr.application_type__rim`=$v.application_type_id])=0})\t/* Filter out Common (EU) and Common (GCC) */\t~> $filter(function($v) {$v.country_name != \"Common (EU)\" and $v.country_name != \"Common (GCC)\"})\t/* Sort by name */\t~> $sort(function($l, $r) {$l.country_name > $r.country_name})\t",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1870,
        "y": 1500,
        "wires": [
            [
                "8f7f5b7af1e523e8",
                "97b53a3a8dd09761"
            ]
        ]
    },
    {
        "id": "97b53a3a8dd09761",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "0342ae8990d4e5d0",
        "name": "set fields for input form",
        "rules": [
            {
                "t": "set",
                "p": "title",
                "pt": "msg",
                "to": "Please select all the participating countries of the CTR process",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "type",
                "pt": "msg",
                "to": "checkbox",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "description",
                "pt": "msg",
                "to": "\"Lead Country is set as European Union for new CTR for Study \" & study.name__v & \" \" & study.study_alias__c",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "tableheader",
                "pt": "msg",
                "to": "{\"columns\":[\"Country\",\"Region\",\"Application Type\"]}",
                "tot": "json"
            },
            {
                "t": "set",
                "p": "dataarray",
                "pt": "msg",
                "to": "full_application_types.{\t   \"selection\": $string(),\t   \"columns\": [\t       country_name,\t       region_name,\t       application_type\t   ]\t}",
                "tot": "jsonata",
                "dc": true
            },
            {
                "t": "set",
                "p": "flow",
                "pt": "msg",
                "to": "nodes/cta/ctd",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "hiddenfields",
                "pt": "msg",
                "to": "[\t   {\t       \"name\": \"study_id\",\t       \"value\": study_id\t    },\t    {\t       \"name\": \"lead_country\",\t       \"value\": $string(lead_country)\t    },\t    {\t        \"name\": \"event_id\",\t        \"value\": event_id\t    },\t    {\t        \"name\": \"created_event_id\",\t        \"value\": created_event_id\t    },\t    {\t        \"name\": \"job_type\",\t        \"value\": job.job_type\t    },\t    {\t        \"name\": \"job_scope\",\t        \"value\": job.job_scope\t    }\t\t]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1360,
        "y": 1560,
        "wires": [
            [
                "09ab16f41f604cb4"
            ]
        ]
    },
    {
        "id": "4cac1cf727b0ef9f",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "0342ae8990d4e5d0",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2110,
        "y": 1560,
        "wires": []
    },
    {
        "id": "3db241b53e5fc1f6",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "0342ae8990d4e5d0",
        "name": "query application types",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "SELECT country__rim, country__rimr.name__v, country__rimr.country_code__rim, region__rim, region__rimr.name__v, cv_1__rim, cv_1__rimr.name__v FROM constraint__rim WHERE applicable_product_type__v = 'drug__v' AND constraint_scope__v = 'investigational__c' AND status__v = 'active__v' AND cv_1__rimr.controlled_vocabulary_type__rim = 'application_type__rim' AND cv_1__rimr.status__v = 'active__v' AND region__rimr.name__v='European Union'",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1360,
        "y": 1500,
        "wires": [
            [
                "309297c842b780cc"
            ]
        ]
    },
    {
        "id": "f366310a370cb263",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "0342ae8990d4e5d0",
        "name": "query countries",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, country_code__rim, region__v, region__vr.name__v from country__v where status__v = 'active__v' and region__vr.name__v='European Union' and id !='\" & $.lead_country[0].country_id & \"'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1340,
        "y": 1320,
        "wires": [
            [
                "cc8836b7ba4047c6"
            ]
        ]
    },
    {
        "id": "2b6a8988be4f6aa1",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "0342ae8990d4e5d0",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "countries",
                "pt": "msg",
                "to": "payload.data.{\t   \"country_id\": id,\t   \"country_name\": name__v,\t   \"country_code\": country_code__rim,\t   \"region_id\": region__v,\t   \"region_name\": `region__vr.name__v`\t}",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1850,
        "y": 1320,
        "wires": [
            [
                "59a605b44b4e458f",
                "eabb62e6f580519c"
            ]
        ]
    },
    {
        "id": "59a605b44b4e458f",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "0342ae8990d4e5d0",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2110,
        "y": 1320,
        "wires": []
    },
    {
        "id": "8f7f5b7af1e523e8",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "0342ae8990d4e5d0",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2110,
        "y": 1500,
        "wires": []
    },
    {
        "id": "cc8836b7ba4047c6",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "0342ae8990d4e5d0",
        "name": "",
        "x": 1630,
        "y": 1320,
        "wires": [
            [
                "2b6a8988be4f6aa1"
            ],
            [
                "1e2e089e5f67454c"
            ]
        ]
    },
    {
        "id": "309297c842b780cc",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "0342ae8990d4e5d0",
        "name": "",
        "x": 1630,
        "y": 1500,
        "wires": [
            [
                "f8994213aa7f8399"
            ],
            [
                "1e2e089e5f67454c"
            ]
        ]
    },
    {
        "id": "09ab16f41f604cb4",
        "type": "brave-input-form",
        "z": "2c4527dad914ec1c",
        "g": "0342ae8990d4e5d0",
        "name": "",
        "x": 1630,
        "y": 1560,
        "wires": [
            [
                "86268d6a0b837218",
                "4cac1cf727b0ef9f"
            ]
        ]
    },
    {
        "id": "eabb62e6f580519c",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "0342ae8990d4e5d0",
        "name": "query existing applications",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v,lead_market__rim, application_type__rim from application__v where clinical_study__c = '\" & study_id & \"'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1380,
        "y": 1380,
        "wires": [
            [
                "077d32a3b26a735d"
            ]
        ]
    },
    {
        "id": "077d32a3b26a735d",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "0342ae8990d4e5d0",
        "name": "",
        "x": 1630,
        "y": 1380,
        "wires": [
            [
                "a0f6e8171e172d4a"
            ],
            [
                "1e2e089e5f67454c"
            ]
        ]
    },
    {
        "id": "a0f6e8171e172d4a",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "0342ae8990d4e5d0",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "applications",
                "pt": "msg",
                "to": "payload.data",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1860,
        "y": 1380,
        "wires": [
            [
                "f0987bd0f1eba5cc",
                "1f5889e43a4b930a"
            ]
        ]
    },
    {
        "id": "f0987bd0f1eba5cc",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "0342ae8990d4e5d0",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2110,
        "y": 1380,
        "wires": []
    },
    {
        "id": "1c94bab016a6778b",
        "type": "http in",
        "z": "2c4527dad914ec1c",
        "g": "0342ae8990d4e5d0",
        "name": "",
        "url": "cta/cms",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 1360,
        "y": 1140,
        "wires": [
            [
                "6d5e72093e4f1763"
            ]
        ]
    },
    {
        "id": "3d50cf1b7e19fa64",
        "type": "brave-login",
        "z": "2c4527dad914ec1c",
        "g": "0342ae8990d4e5d0",
        "name": "",
        "x": 1810,
        "y": 1140,
        "wires": [
            [
                "fc53ea68445af2da"
            ],
            [
                "1e2e089e5f67454c"
            ]
        ]
    },
    {
        "id": "6d5e72093e4f1763",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "0342ae8990d4e5d0",
        "name": "store parameters",
        "rules": [
            {
                "t": "set",
                "p": "study_id",
                "pt": "msg",
                "to": "payload.study_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "lead_country_string",
                "pt": "msg",
                "to": "[{\"country_id\":\"00C000000000783\",\"country_name\":\"European Union\",\"country_code\":\"EU\",\"region_id\":\"00R000000000102\",\"region_name\":\"European Union\",\"application_type_id\":\"A0V000000004004\",\"application_type\":\"CTA Regulation\"}]",
                "tot": "str",
                "dc": true
            },
            {
                "t": "set",
                "p": "client_id",
                "pt": "msg",
                "to": "cta-automation",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "event_id",
                "pt": "msg",
                "to": "payload.id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "job.job_scope",
                "pt": "msg",
                "to": "payload.job_scope",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "job.job_type",
                "pt": "msg",
                "to": "payload.job_type",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "created_event_id",
                "pt": "msg",
                "to": "payload.created_event_id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1650,
        "y": 1140,
        "wires": [
            [
                "3d50cf1b7e19fa64"
            ]
        ]
    },
    {
        "id": "62db2312adce6927",
        "type": "json",
        "z": "2c4527dad914ec1c",
        "g": "0342ae8990d4e5d0",
        "name": "json to object",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 1630,
        "y": 1200,
        "wires": [
            [
                "2b6443fc1090bbdb"
            ]
        ]
    },
    {
        "id": "2b6443fc1090bbdb",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "0342ae8990d4e5d0",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "lead_country",
                "pt": "msg",
                "to": "payload",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1860,
        "y": 1200,
        "wires": [
            [
                "380f6e75443f7e3e",
                "a53bccc1a94c03cb"
            ]
        ]
    },
    {
        "id": "2a898795a346bdae",
        "type": "split",
        "z": "2c4527dad914ec1c",
        "g": "0342ae8990d4e5d0",
        "name": "for each country",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1340,
        "y": 1200,
        "wires": [
            [
                "62db2312adce6927"
            ]
        ]
    },
    {
        "id": "fc53ea68445af2da",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "0342ae8990d4e5d0",
        "name": "parse countries",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "lead_country_string",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2080,
        "y": 1140,
        "wires": [
            [
                "2a898795a346bdae"
            ]
        ]
    },
    {
        "id": "380f6e75443f7e3e",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "0342ae8990d4e5d0",
        "name": "msg",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2110,
        "y": 1200,
        "wires": []
    },
    {
        "id": "1f5889e43a4b930a",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "0342ae8990d4e5d0",
        "name": "query existing Application Countries",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, country__rim, country__rimr.name__v, application__rim, application__rimr.name__v, application__rimr.application_type__rim from application_country__rim where application__rimr.clinical_study__c ='\" & study_id & \"'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1400,
        "y": 1440,
        "wires": [
            [
                "a6055687aa65ad2f"
            ]
        ]
    },
    {
        "id": "a6055687aa65ad2f",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "0342ae8990d4e5d0",
        "name": "",
        "x": 1630,
        "y": 1440,
        "wires": [
            [
                "a4abf52b8768caf0"
            ],
            [
                "1e2e089e5f67454c"
            ]
        ]
    },
    {
        "id": "a4abf52b8768caf0",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "0342ae8990d4e5d0",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "application_countries",
                "pt": "msg",
                "to": "payload.data",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1890,
        "y": 1440,
        "wires": [
            [
                "5945973ffe5f9e1c",
                "3db241b53e5fc1f6"
            ]
        ]
    },
    {
        "id": "5945973ffe5f9e1c",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "0342ae8990d4e5d0",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2110,
        "y": 1440,
        "wires": []
    },
    {
        "id": "1e2e089e5f67454c",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "0342ae8990d4e5d0",
        "name": "link out 9",
        "mode": "link",
        "links": [
            "0b4394d395558302"
        ],
        "x": 1785,
        "y": 1620,
        "wires": []
    },
    {
        "id": "62640940a60a1f05",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "create submissions",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"submission__v\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "applications.{\t   \"name__v\": $$.event.name__v & ' - ' & $substringBefore(name__v, \" -\"),\t   \"description__v\": $length($$.event.event_description__c) > 500 ? $substring($$.event.event_description__c,0,497) & \"...\" : $$.event.event_description__c,\t   \"application__v\": id,\t   \"object_type__vr.api_name__v\": \"investigational_submission__c\",\t   \"submission_type__rimr.name__v\": \"*Placeholder - Please Update*\"\t}[]\t",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3190,
        "y": 2300,
        "wires": [
            [
                "a77d51b53d8a6f23"
            ]
        ]
    },
    {
        "id": "898365ea0e27f9fa",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "store result",
        "rules": [
            {
                "t": "set",
                "p": "submission_ids",
                "pt": "msg",
                "to": "payload.data[responseStatus=\"SUCCESS\"].data.id[]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3670,
        "y": 2300,
        "wires": [
            [
                "fd61c358f16a025d",
                "f58d0bb835412fc4"
            ]
        ]
    },
    {
        "id": "fd61c358f16a025d",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "query submissions",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v from submission__v where \" & (submission_ids ~> $map(function($v) {\"id='\" & $v & \"'\"}) ~> $join(\" OR \"))",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3190,
        "y": 2360,
        "wires": [
            [
                "c871db4946297902"
            ]
        ]
    },
    {
        "id": "9398e7263bf82b17",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "store result",
        "rules": [
            {
                "t": "set",
                "p": "submissions",
                "pt": "msg",
                "to": "payload.data",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3670,
        "y": 2360,
        "wires": [
            [
                "b4d75ca5d1862d0d",
                "3a5fef5ba445dca6"
            ]
        ]
    },
    {
        "id": "b4d75ca5d1862d0d",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "link to products",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"submission_pharmaceutical_product__rim\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t    submissions ~> $map(\t       function($submission) {\t           study.clinical_study_products__cr.data.{\t               \"submission__rim\": $submission.id,\t               \"pharmaceutical_product__rim\": product__c,\t               \"product_detail__rim\": product_variant__c\t        }\t    }\t    ) ~> $reduce(\t       function($accumulator, $value) {$append($accumulator, $value)}\t    )\t]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3180,
        "y": 2420,
        "wires": [
            [
                "14be5b3467d426ef"
            ]
        ]
    },
    {
        "id": "19b4e65ee7032903",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "link to study",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"submission_clinical_study__rim\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "submissions.{\t   \"submission__rim\": id,\t   \"clinical_study__rim\": $$.study_id\t}[]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3170,
        "y": 2540,
        "wires": [
            [
                "857c942e1e147c0c"
            ]
        ]
    },
    {
        "id": "f58d0bb835412fc4",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3850,
        "y": 2300,
        "wires": []
    },
    {
        "id": "3a5fef5ba445dca6",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3850,
        "y": 2360,
        "wires": []
    },
    {
        "id": "8e82a3e29f089f62",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3850,
        "y": 2420,
        "wires": []
    },
    {
        "id": "7f14e480377ecb8f",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3850,
        "y": 2540,
        "wires": []
    },
    {
        "id": "a77d51b53d8a6f23",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "",
        "x": 3420,
        "y": 2300,
        "wires": [
            [
                "898365ea0e27f9fa"
            ],
            [
                "1b109bb176828d44"
            ]
        ]
    },
    {
        "id": "c871db4946297902",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "",
        "x": 3410,
        "y": 2360,
        "wires": [
            [
                "9398e7263bf82b17"
            ],
            [
                "1b109bb176828d44"
            ]
        ]
    },
    {
        "id": "14be5b3467d426ef",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "",
        "x": 3420,
        "y": 2420,
        "wires": [
            [
                "8e82a3e29f089f62",
                "675035dafe7624c4"
            ],
            [
                "1b109bb176828d44"
            ]
        ]
    },
    {
        "id": "1b109bb176828d44",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "",
        "mode": "link",
        "links": [
            "0b4394d395558302"
        ],
        "x": 3645,
        "y": 2620,
        "wires": []
    },
    {
        "id": "857c942e1e147c0c",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "",
        "x": 3420,
        "y": 2540,
        "wires": [
            [
                "7f14e480377ecb8f",
                "9e1f9abf0b7f18c2"
            ],
            [
                "1b109bb176828d44"
            ]
        ]
    },
    {
        "id": "9e1f9abf0b7f18c2",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "link to indications",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"submission_indication__rim\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t    submissions ~> $map(function($submission) {\t       study.therapeutic_indication_clinical_studies__cr.data.{\t           \"indication__rim\": therapeutic_indication__c,\t           \"submission__rim\": $submission.id\t        }\t    }) ~> $reduce(function($accumulator, $value) {$append($accumulator, $value)})\t]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3190,
        "y": 2600,
        "wires": [
            [
                "8d568405b4ec34f2"
            ]
        ]
    },
    {
        "id": "8d568405b4ec34f2",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "",
        "x": 3420,
        "y": 2600,
        "wires": [
            [
                "a951ef41ea04daa1",
                "38c9f670c6aad425"
            ],
            [
                "1b109bb176828d44"
            ]
        ]
    },
    {
        "id": "a951ef41ea04daa1",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3850,
        "y": 2600,
        "wires": []
    },
    {
        "id": "675035dafe7624c4",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "link to event",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"event_submission__rim\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "submissions.{\t   \"submission__rim\": id,\t   \"event__rim\": $$.event.id\t}[]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3170,
        "y": 2480,
        "wires": [
            [
                "a6fdd8a4c088efcd"
            ]
        ]
    },
    {
        "id": "a6fdd8a4c088efcd",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "",
        "x": 3420,
        "y": 2480,
        "wires": [
            [
                "91c1fc453443a8e3",
                "19b4e65ee7032903"
            ],
            [
                "1b109bb176828d44"
            ]
        ]
    },
    {
        "id": "91c1fc453443a8e3",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3850,
        "y": 2480,
        "wires": []
    },
    {
        "id": "ea8fd3395ae5fd49",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "7dbb9c6933b0187b",
        "name": "create ros",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"regulatory_objective__rim\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "applications.{\t   \"name__v\": $$.event.name__v & ' - ' & $substringBefore(name__v, \" -\"),\t   \"description_of_change__rim\": $$.event.event_description__c,\t   \"application__rim\": id,\t   \"object_type__vr.api_name__v\": \"investigational_regulatory_objective__c\",\t   \"safetyrelated__c\": \"no__c\",\t   \"regulatory_objective_type_global__c\": $$.ro_type\t}[]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3160,
        "y": 2800,
        "wires": [
            [
                "d054a08aba76294a"
            ]
        ]
    },
    {
        "id": "ea3dfeb51546e24a",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "7dbb9c6933b0187b",
        "name": "store result",
        "rules": [
            {
                "t": "set",
                "p": "ro_ids",
                "pt": "msg",
                "to": "payload.data[responseStatus=\"SUCCESS\"].data.id[]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3650,
        "y": 2800,
        "wires": [
            [
                "449abf85b0dfeb5a",
                "f36d5ec80cec5d8f"
            ]
        ]
    },
    {
        "id": "7282d98b9aebfd65",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "7dbb9c6933b0187b",
        "name": "link to products",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"regulatory_objective_drug_product__v\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t    ros ~> $map(\t       function($ro) {\t           study.clinical_study_products__cr.data.{\t               \"regulatory_objective__v\": $ro.id,\t               \"drug_product__v\": product__c,\t               \"product_detail__v\": product_variant__c\t        }\t    }\t    ) ~> $reduce(\t       function($accumulator, $value) {$append($accumulator, $value)}\t    )\t]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3180,
        "y": 2920,
        "wires": [
            [
                "f44a6fefd13d1c10"
            ]
        ]
    },
    {
        "id": "449abf85b0dfeb5a",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "7dbb9c6933b0187b",
        "name": "query ros",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v from regulatory_objective__rim where \" & (ro_ids ~> $map(function($v) {\"id='\" & $v & \"'\"}) ~> $join(\" OR \"))",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3160,
        "y": 2860,
        "wires": [
            [
                "33574cd26d86b730"
            ]
        ]
    },
    {
        "id": "4f666270c6fff25d",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "7dbb9c6933b0187b",
        "name": "store result",
        "rules": [
            {
                "t": "set",
                "p": "ros",
                "pt": "msg",
                "to": "payload.data",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3650,
        "y": 2860,
        "wires": [
            [
                "7282d98b9aebfd65",
                "9104486cb4f058e0"
            ]
        ]
    },
    {
        "id": "dda0db44b7fc76a2",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "7dbb9c6933b0187b",
        "name": "link to study",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"regulatory_objective_clinical_study__v\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "ros.{\t   \"regulatory_objective__v\": id,\t   \"clinical_study__v\": $$.study_id,\t   \"impd_version_nonquality_part__c\": $$.event.event_clinical_studies__vr.data.impd_version_nonquality_part__c,\t   \"impd_version_quality_part__c\": $$.event.event_clinical_studies__vr.data.impd_version_quality_part__c,\t   \"protocol_version__c\": $$.event.event_clinical_studies__vr.data.protocol_version__c,\t   \"ib_version__c\": $$.event.event_clinical_studies__vr.data.ib_version__c\t}[]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3170,
        "y": 3040,
        "wires": [
            [
                "dd1397594a408f05"
            ]
        ]
    },
    {
        "id": "92ab0d09bc0a2257",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "7dbb9c6933b0187b",
        "name": "link to submissions",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"submission_regulatory_objective__v\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "submissions#$i.{\t   \"regulatory_objective__v\": $$.ros[$i].id,\t   \"submission__v\": id\t}[]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3190,
        "y": 3100,
        "wires": [
            [
                "ac4deb9539f1fb55"
            ]
        ]
    },
    {
        "id": "50129e1a7a69e488",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "7dbb9c6933b0187b",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3850,
        "y": 2740,
        "wires": []
    },
    {
        "id": "f36d5ec80cec5d8f",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "7dbb9c6933b0187b",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3850,
        "y": 2800,
        "wires": []
    },
    {
        "id": "9104486cb4f058e0",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "7dbb9c6933b0187b",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3850,
        "y": 2860,
        "wires": []
    },
    {
        "id": "acaa1af7a2c60d83",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "7dbb9c6933b0187b",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3850,
        "y": 2920,
        "wires": []
    },
    {
        "id": "1a0e3c813639d7e8",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "7dbb9c6933b0187b",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3850,
        "y": 3040,
        "wires": []
    },
    {
        "id": "38c9f670c6aad425",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "7dbb9c6933b0187b",
        "name": "query ro type",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "select id from controlled_vocabulary__rim where controlled_vocabulary_type__rim = 'regulatory_objective_type_global__c' and name__v = 'New Clinical Trial' and status__v = 'active__v'",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3170,
        "y": 2740,
        "wires": [
            [
                "9e0fbc59446d769b"
            ]
        ]
    },
    {
        "id": "be244ca4d55bdd38",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "7dbb9c6933b0187b",
        "name": "store result",
        "rules": [
            {
                "t": "set",
                "p": "ro_type",
                "pt": "msg",
                "to": "payload.data[0].id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3650,
        "y": 2740,
        "wires": [
            [
                "ea8fd3395ae5fd49",
                "50129e1a7a69e488"
            ]
        ]
    },
    {
        "id": "2e6605503e1d4370",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "7dbb9c6933b0187b",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3850,
        "y": 3100,
        "wires": []
    },
    {
        "id": "9e0fbc59446d769b",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "7dbb9c6933b0187b",
        "name": "",
        "x": 3410,
        "y": 2740,
        "wires": [
            [
                "be244ca4d55bdd38"
            ],
            [
                "275cac78bf29b682"
            ]
        ]
    },
    {
        "id": "d054a08aba76294a",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "7dbb9c6933b0187b",
        "name": "",
        "x": 3420,
        "y": 2800,
        "wires": [
            [
                "ea3dfeb51546e24a"
            ],
            [
                "275cac78bf29b682"
            ]
        ]
    },
    {
        "id": "33574cd26d86b730",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "7dbb9c6933b0187b",
        "name": "",
        "x": 3410,
        "y": 2860,
        "wires": [
            [
                "4f666270c6fff25d"
            ],
            [
                "275cac78bf29b682"
            ]
        ]
    },
    {
        "id": "f44a6fefd13d1c10",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "7dbb9c6933b0187b",
        "name": "",
        "x": 3420,
        "y": 2920,
        "wires": [
            [
                "acaa1af7a2c60d83",
                "2fee73769422c35f"
            ],
            [
                "275cac78bf29b682"
            ]
        ]
    },
    {
        "id": "dd1397594a408f05",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "7dbb9c6933b0187b",
        "name": "",
        "x": 3420,
        "y": 3040,
        "wires": [
            [
                "92ab0d09bc0a2257",
                "1a0e3c813639d7e8"
            ],
            [
                "275cac78bf29b682"
            ]
        ]
    },
    {
        "id": "275cac78bf29b682",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "7dbb9c6933b0187b",
        "name": "",
        "mode": "link",
        "links": [
            "0b4394d395558302"
        ],
        "x": 3605,
        "y": 2940,
        "wires": []
    },
    {
        "id": "ac4deb9539f1fb55",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "7dbb9c6933b0187b",
        "name": "",
        "x": 3420,
        "y": 3100,
        "wires": [
            [
                "2e6605503e1d4370",
                "aa47eed378c684f0"
            ],
            [
                "275cac78bf29b682"
            ]
        ]
    },
    {
        "id": "aa47eed378c684f0",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "7dbb9c6933b0187b",
        "name": "link to indications",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"regulatory_objective_indication__v\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t    ros ~> $map(function($ro) {\t       study.therapeutic_indication_clinical_studies__cr.data.{\t           \"indication__v\": therapeutic_indication__c,\t           \"regulatory_objective__v\": $ro.id\t        }\t    }) ~> $reduce(function($accumulator, $value) {$append($accumulator, $value)})\t]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3190,
        "y": 3160,
        "wires": [
            [
                "991415f1a79cd20a"
            ]
        ]
    },
    {
        "id": "991415f1a79cd20a",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "7dbb9c6933b0187b",
        "name": "",
        "x": 3420,
        "y": 3160,
        "wires": [
            [
                "f6465cef2e0631c0",
                "bc4bea3fd22cd07b"
            ],
            [
                "275cac78bf29b682"
            ]
        ]
    },
    {
        "id": "f6465cef2e0631c0",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "7dbb9c6933b0187b",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3850,
        "y": 3160,
        "wires": []
    },
    {
        "id": "1ad0402c6eac4a81",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "5e4f497cc3eacc9e",
        "name": "link out 10",
        "mode": "link",
        "links": [
            "c3df4ccf459db19f"
        ],
        "x": 3845,
        "y": 3240,
        "wires": []
    },
    {
        "id": "2fee73769422c35f",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "7dbb9c6933b0187b",
        "name": "link to event",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"event_regulatory_objective__v\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "ros.{\t   \"regulatory_objective__v\": id,\t   \"event__v\": $$.event.id\t}[]\t\t",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3170,
        "y": 2980,
        "wires": [
            [
                "a539cc3ec7312d9d"
            ]
        ]
    },
    {
        "id": "a539cc3ec7312d9d",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "7dbb9c6933b0187b",
        "name": "",
        "x": 3420,
        "y": 2980,
        "wires": [
            [
                "3d776d3161996ac6",
                "dda0db44b7fc76a2"
            ],
            [
                "275cac78bf29b682"
            ]
        ]
    },
    {
        "id": "3d776d3161996ac6",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "7dbb9c6933b0187b",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3850,
        "y": 2980,
        "wires": []
    },
    {
        "id": "0571712f078a2137",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "3b0d3c603c0d1fd6",
        "name": "create application countries",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"application_country__rim\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "join_countries",
                "pt": "msg",
                "to": "$append(cms_countries,countries)",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "cms_countries@$i.ha@$h[$i.country_id=$h.country__rim].{\t   \"country__rim\": $i.country_id,\t   \"health_authority__c\": $h.health_authority__v,\t   \"application__rim\": applications[0].id,\t   \"object_type__vr.name__v\": \"Investigational Application Country\"\t}[]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1800,
        "y": 3360,
        "wires": [
            [
                "eb1b125d55482241"
            ]
        ]
    },
    {
        "id": "eb1b125d55482241",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "3b0d3c603c0d1fd6",
        "name": "",
        "x": 2100,
        "y": 3360,
        "wires": [
            [
                "22075ff5491384ec",
                "80c81f840d3d8bf8"
            ],
            [
                "e47b4d5d5c74d6f1"
            ]
        ]
    },
    {
        "id": "22075ff5491384ec",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "3b0d3c603c0d1fd6",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2410,
        "y": 3360,
        "wires": []
    },
    {
        "id": "bbd3c599a4d4a203",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "3b0d3c603c0d1fd6",
        "name": "query HA",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "select id, country__rim, country__rimr.name__v, object_type__v, object_type__vr.name__v, health_authority__v, health_authority__vr.name__v from constraint__rim where object_type__vr.name__v='Health Authority'",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1320,
        "y": 3300,
        "wires": [
            [
                "b9d002f72c39627d"
            ]
        ]
    },
    {
        "id": "b9d002f72c39627d",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "3b0d3c603c0d1fd6",
        "name": "",
        "x": 1570,
        "y": 3300,
        "wires": [
            [
                "646ee80e0e3c6a5f"
            ],
            [
                "e47b4d5d5c74d6f1"
            ]
        ]
    },
    {
        "id": "fc7d31296cf7b12f",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "3b0d3c603c0d1fd6",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "ha",
                "pt": "msg",
                "to": "payload.data",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1330,
        "y": 3360,
        "wires": [
            [
                "8dd59e74376d6937"
            ]
        ]
    },
    {
        "id": "d43907b12f64f459",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "3b0d3c603c0d1fd6",
        "name": "",
        "x": 2100,
        "y": 3420,
        "wires": [
            [
                "00c17791fffdd382",
                "9a87a1f173d5e53f"
            ],
            [
                "e47b4d5d5c74d6f1"
            ]
        ]
    },
    {
        "id": "00c17791fffdd382",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "3b0d3c603c0d1fd6",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2410,
        "y": 3420,
        "wires": []
    },
    {
        "id": "90e528859987db49",
        "type": "function",
        "z": "2c4527dad914ec1c",
        "g": "3b0d3c603c0d1fd6",
        "name": "Remove duplicate by country",
        "func": "var prev = null;\n\nmsg.payload.data = msg.payload.data.filter((item) => {\n    var keep = (item.country__rim !== prev);\n    prev = item.country__rim;\n    return keep;\n});\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2140,
        "y": 3300,
        "wires": [
            [
                "fc7d31296cf7b12f",
                "66ccba17afd6cf21"
            ]
        ]
    },
    {
        "id": "66ccba17afd6cf21",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "3b0d3c603c0d1fd6",
        "name": "debug 353",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 2430,
        "y": 3300,
        "wires": []
    },
    {
        "id": "646ee80e0e3c6a5f",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "3b0d3c603c0d1fd6",
        "name": "Order the HA by Country",
        "rules": [
            {
                "t": "set",
                "p": "payload.data",
                "pt": "msg",
                "to": "payload.data\t~>$sort(function($l, $r) {$l.country__rim > $r.country__rim})",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1790,
        "y": 3300,
        "wires": [
            [
                "90e528859987db49"
            ]
        ]
    },
    {
        "id": "e47b4d5d5c74d6f1",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "3b0d3c603c0d1fd6",
        "name": "",
        "mode": "link",
        "links": [
            "0b4394d395558302"
        ],
        "x": 1805,
        "y": 3480,
        "wires": []
    },
    {
        "id": "4e0728471558a67e",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "a7a8a74946229b91",
        "name": "If Event creation needed and which type",
        "property": "job",
        "propertyType": "msg",
        "rules": [
            {
                "t": "jsonata_exp",
                "v": "job.job_type=\"1\" and $contains(job.job_scope,\"Event\") and $not($exists(event_id))",
                "vt": "jsonata"
            },
            {
                "t": "jsonata_exp",
                "v": "job.job_type=\"2\" and $contains(job.job_scope,\"Event\") and $not($exists(event_id))",
                "vt": "jsonata"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 3,
        "x": 1040,
        "y": 820,
        "wires": [
            [
                "19967e71170ecd73"
            ],
            [
                "d046d19b53dad465"
            ],
            [
                "0b5e993385abdbaf"
            ]
        ]
    },
    {
        "id": "0b5e993385abdbaf",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "a7a8a74946229b91",
        "name": "If Application creation needed",
        "property": "job",
        "propertyType": "msg",
        "rules": [
            {
                "t": "jsonata_exp",
                "v": "$contains(job.job_scope,\"Country\")",
                "vt": "jsonata"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1790,
        "y": 840,
        "wires": [
            [
                "3d2f1bb1ca763691"
            ],
            [
                "b3626201f7983f76",
                "115701a7b00b4c46"
            ]
        ]
    },
    {
        "id": "b3626201f7983f76",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "a7a8a74946229b91",
        "name": "If record creation needed and which type",
        "property": "job",
        "propertyType": "msg",
        "rules": [
            {
                "t": "jsonata_exp",
                "v": "job.job_type=\"1\" and $contains(job.job_scope,\"Related\")",
                "vt": "jsonata"
            },
            {
                "t": "jsonata_exp",
                "v": "job.job_type=\"2\" and $contains(job.job_scope,\"Related\")",
                "vt": "jsonata"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 3,
        "x": 2600,
        "y": 840,
        "wires": [
            [
                "4b8eadec1c5671af",
                "eefb2eeedd415df4"
            ],
            [
                "4b8eadec1c5671af",
                "eefb2eeedd415df4"
            ],
            [
                "eefb2eeedd415df4",
                "8bda251317c47732"
            ]
        ]
    },
    {
        "id": "c65594f62b66ba6c",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "cf3f4fcb8dc2573a",
        "name": "link out 13",
        "mode": "link",
        "links": [
            "6e98ee16de826386"
        ],
        "x": 3995,
        "y": 560,
        "wires": []
    },
    {
        "id": "eb998f707cad852f",
        "type": "comment",
        "z": "2c4527dad914ec1c",
        "name": "testing in scratchbox 01",
        "info": "",
        "x": 120,
        "y": 20,
        "wires": []
    },
    {
        "id": "413d0d4919352499",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "1adf9a7b09d9ec3e",
        "name": "debug 354",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2650,
        "y": 520,
        "wires": []
    },
    {
        "id": "cd510823c811d7c4",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "a7a8a74946229b91",
        "name": "debug 355",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1630,
        "y": 740,
        "wires": []
    },
    {
        "id": "64a2d7cc0f15b947",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "a7a8a74946229b91",
        "name": "debug 356",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1630,
        "y": 780,
        "wires": []
    },
    {
        "id": "19967e71170ecd73",
        "type": "link call",
        "z": "2c4527dad914ec1c",
        "g": "a7a8a74946229b91",
        "name": "Create CTA Event",
        "links": [
            "82f3a1c97692584d"
        ],
        "linkType": "static",
        "timeout": "10000",
        "x": 1330,
        "y": 760,
        "wires": [
            [
                "0b5e993385abdbaf",
                "cd510823c811d7c4"
            ]
        ]
    },
    {
        "id": "82f3a1c97692584d",
        "type": "link in",
        "z": "2c4527dad914ec1c",
        "g": "c3cc3bc6b0b0ab38",
        "name": "link in 3",
        "links": [],
        "x": 85,
        "y": 1020,
        "wires": [
            [
                "f14722cf1050e3b6"
            ]
        ]
    },
    {
        "id": "d046d19b53dad465",
        "type": "link call",
        "z": "2c4527dad914ec1c",
        "g": "a7a8a74946229b91",
        "name": "Create Amendment Event",
        "links": [
            "e4914f34cdb1e255"
        ],
        "linkType": "static",
        "timeout": "300000",
        "x": 1350,
        "y": 800,
        "wires": [
            [
                "0b5e993385abdbaf",
                "64a2d7cc0f15b947"
            ]
        ]
    },
    {
        "id": "3d2f1bb1ca763691",
        "type": "link call",
        "z": "2c4527dad914ec1c",
        "g": "a7a8a74946229b91",
        "name": "Create Application",
        "links": [
            "eece97d5539892a0"
        ],
        "linkType": "static",
        "timeout": "10000",
        "x": 2070,
        "y": 800,
        "wires": [
            [
                "b3626201f7983f76"
            ]
        ]
    },
    {
        "id": "5301adb11c7b2c3a",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "c3cc3bc6b0b0ab38",
        "name": "link out 14",
        "mode": "return",
        "links": [],
        "x": 785,
        "y": 1060,
        "wires": []
    },
    {
        "id": "05d9e73aaf4a53f9",
        "type": "http response",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 350,
        "y": 1880,
        "wires": []
    },
    {
        "id": "bdf854e2d1181a35",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "c3cc3bc6b0b0ab38",
        "name": "debug 357",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 650,
        "y": 1020,
        "wires": []
    },
    {
        "id": "115701a7b00b4c46",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "a7a8a74946229b91",
        "name": "debug 358",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2050,
        "y": 880,
        "wires": []
    },
    {
        "id": "959da61bde9bb8b0",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "CTR?",
        "property": "payload.lead_country",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nnull"
            },
            {
                "t": "null"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1570,
        "y": 1740,
        "wires": [
            [
                "6a6c7efc7e51bf6d"
            ],
            [
                "4f6dbedf8f6e524e"
            ]
        ]
    },
    {
        "id": "93250f2631c4e047",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "debug 362",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2610,
        "y": 1740,
        "wires": []
    },
    {
        "id": "4f6dbedf8f6e524e",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "store parameters",
        "rules": [
            {
                "t": "set",
                "p": "study_id",
                "pt": "msg",
                "to": "payload.study_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "cms_countries_string",
                "pt": "msg",
                "to": "payload.response_full[]",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "lead_country_string",
                "pt": "msg",
                "to": "payload.lead_country",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "client_id",
                "pt": "msg",
                "to": "cta-automation",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "job.job_scope",
                "pt": "msg",
                "to": "payload.job_scope",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "job.job_type",
                "pt": "msg",
                "to": "payload.job_type",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "created_event_id",
                "pt": "msg",
                "to": "payload.created_event_id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1350,
        "y": 1860,
        "wires": [
            [
                "b219b669e1aa3a1f"
            ]
        ]
    },
    {
        "id": "b219b669e1aa3a1f",
        "type": "brave-login",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "",
        "x": 1310,
        "y": 1980,
        "wires": [
            [
                "7e622617fec07ddd"
            ],
            [
                "1e2e089e5f67454c"
            ]
        ]
    },
    {
        "id": "7e622617fec07ddd",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "query countries",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, country_code__rim, region__v, region__vr.name__v from country__v where status__v = 'active__v'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1600,
        "y": 1960,
        "wires": [
            [
                "9026e264d0fa9d16"
            ]
        ]
    },
    {
        "id": "c526a83f886ee66c",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "f4492470635578ae",
        "name": "create applications",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"application__v\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "Application_country",
                "pt": "msg",
                "to": "$append(lead_country,countries)",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Application_country.{\t   \"name__v\": \"cta_\" & $millis() & \"_\" & country_code,\t   \"object_type__vr.api_name__v\": \"investigational_application__c\",\t   \"domain__vr.name__v\": \"Human use\",\t   \"lead_market__rim\": country_id,\t   \"region__v\": region_id,\t   \"product__v\": $$.study.product__v,\t   \"applicable_product_type__v\": \"drug__v\",\t   \"application_type__rim\": application_type_id,\t   \"clinical_study__c\": $$.study.id,\t   \"publishing_hub__c\": \"ctis_submission_management__c\"\t}[]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1350,
        "y": 2900,
        "wires": [
            [
                "aeba6128dc0f5605"
            ]
        ]
    },
    {
        "id": "9a87a1f173d5e53f",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "3b0d3c603c0d1fd6",
        "name": "link out 16",
        "mode": "link",
        "links": [
            "0e57f11a59848a31"
        ],
        "x": 2375,
        "y": 3480,
        "wires": []
    },
    {
        "id": "80c81f840d3d8bf8",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "3b0d3c603c0d1fd6",
        "name": "create non-CTR application countries",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"application_country__rim\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "applications@$i.ha@$h[$i.lead_market__rim != \"00C000000000783\" and $i.lead_market__rim=$h.country__rim].{\t   \"country__rim\": $i.lead_market__rim,\t   \"health_authority__c\": $h.health_authority__v,\t   \"application__rim\": $i.id,\t   \"object_type__vr.name__v\": \"Investigational Application Country\"\t}[]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1830,
        "y": 3420,
        "wires": [
            [
                "d43907b12f64f459"
            ]
        ]
    },
    {
        "id": "f5854a7cc17c0aa7",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "",
        "x": 3670,
        "y": 2120,
        "wires": [
            [
                "9ef56b03101f70be"
            ],
            [
                "1b109bb176828d44"
            ]
        ]
    },
    {
        "id": "b89f95ec9abb8084",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "query study",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, study_alias__c, product__v, product__vr.name__v, (select id, name__v, product__c, product__cr.name__v, product_family__c, product_family__cr.name__v, product_variant__c, product_variant__cr.name__v from clinical_study_products__cr), (select id, name__v, therapeutic_indication__c, therapeutic_indication__cr.name__v from therapeutic_indication_clinical_studies__cr) from clinical_study__v where id='\" & study_id & \"'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3410,
        "y": 2120,
        "wires": [
            [
                "f5854a7cc17c0aa7"
            ]
        ]
    },
    {
        "id": "d8d634dbb1feb7f0",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "query event",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, event_description__c, (select id, impd_version_nonquality_part__c, impd_version_quality_part__c, protocol_version__c, ib_version__c from event_clinical_studies__vr) from event__rim where object_type__vr.api_name__v = 'clinical_study_event__c' and applicable_product_type__v = 'drug__v'and keywords__c = 'clinical_initial_cta__c' and id in (select id from event_clinical_studies__vr where clinical_study__v='\" & study_id & \"')\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3170,
        "y": 2240,
        "wires": [
            [
                "2a00af4ef68684ee"
            ]
        ]
    },
    {
        "id": "2a00af4ef68684ee",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "",
        "x": 3410,
        "y": 2240,
        "wires": [
            [
                "b3093d1ee9de67e1"
            ],
            [
                "1b109bb176828d44"
            ]
        ]
    },
    {
        "id": "9ef56b03101f70be",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "study",
                "pt": "msg",
                "to": "payload.data[0]",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3880,
        "y": 2120,
        "wires": [
            [
                "9bf734a0d565b0b0"
            ]
        ]
    },
    {
        "id": "b3093d1ee9de67e1",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "event",
                "pt": "msg",
                "to": "payload.data[0]",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3680,
        "y": 2240,
        "wires": [
            [
                "71e04109ad804aa3",
                "62640940a60a1f05"
            ]
        ]
    },
    {
        "id": "71e04109ad804aa3",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3850,
        "y": 2240,
        "wires": []
    },
    {
        "id": "7827ec475b7c8da5",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3850,
        "y": 2180,
        "wires": []
    },
    {
        "id": "ec1a25f9388786d7",
        "type": "template",
        "z": "2c4527dad914ec1c",
        "g": "1adf9a7b09d9ec3e",
        "name": "application type selection",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "<!DOCTYPE html>\n\n<html lang=\"en\">\n\n    <head>\n\n        <meta charset=\"UTF-8\">\n\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n\n        <meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\">\n\n        <title>{{title}}</title>\n\n        <link  href=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css\" rel=\"stylesheet\" id=\"bootstrap-css\">\n\n        <script src=\"https://code.jquery.com/jquery-1.11.1.min.js\"></script>\n\n        <script src=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js\"></script>\n\n\n\n\n        <style>\n\n           .tabs {\n\n                width: 400px;\n\n                margin: 30px auto;\n\n                background-color: #FFF;\n\n               /* border: 500px solid #C0DCC0;\n\n                /*box-sizing: border-box;*/\n\n                display: inline;\n\n                }\n\n           \n\n            .tabs nav {\n\n                width:400px;\n\n                height: 40px;\n\n                text-align: center;\n\n                line-height: 40px;\n\n                overflow: hidden;\n\n                background-color: #C0DCC0;\n\n                /* 伸缩盒模型 */\n\n                display: flex;\n\n                }\n\n\n\n\n            nav a {\n\n                display: block;\n\n                width: 400px;\n\n                border-right: 1px solid #FFF;\n\n                color: #000;\n\n                text-decoration: none;\n\n                }\n\n           \n\n            nav a:last-child {\n\n                border-right: none;\n\n                }\n\n\n\n\n            nav a.active {\n\n                background-color: #9BAF9B;\n\n                }\n\n\n\n\n            .cont {\n\n                overflow: hidden;\n\n                display: none;\n\n                }\n\n\n\n\n            .cont ol {\n\n                line-height: 300px;\n\n                }\n\n            p#back-to-top{\n\n                cursor:pointer;\n\n                position:fixed;\n\n                display:none;\n\n                bottom:100px;\n\n                right:40px;\n\n            }\n\n            #myBtn {\n\n                display: none; /* Hidden by default */\n\n                position: fixed; /* Fixed/sticky position */\n\n                bottom: 20px; /* Place the button at the bottom of the page */\n\n                right: 30px; /* Place the button 30px from the right */\n\n                z-index: 99; /* Make sure it does not overlap */\n\n                border: none; /* Remove borders */\n\n                outline: none; /* Remove outline */\n\n                background-color: #33D1FF; /* Set a background color */\n\n                color: white; /* Text color */\n\n                cursor: pointer; /* Add a mouse pointer on hover */\n\n                padding: 15px; /* Some padding */\n\n                border-radius: 10px; /* Rounded corners */\n\n                font-size: 18px; /* Increase font size */\n\n            }\n\n\n\n\n            #myBtn:hover {\n\n                background-color: #555; /* Add a dark-grey background on hover */\n\n                }\n\n\n\n\n            .searchTerm {\n\n                width: 25%;\n\n                border: 3px solid #00B4CC;\n\n                padding: 5px;\n\n                height: 30px;\n\n                border-radius: 5px 5px 5px 5px;\n\n                outline: none;\n\n                color: #9DBFAF;\n\n            }\n\n\n\n\n            .searchTerm:focus{\n\n                color: #00B4CC;\n\n                }\n\n\n\n\n                /*Resize the wrap to see the search bar change!*/\n\n            .wrap{\n\n                width: 30%;\n\n                position: absolute;\n\n                top: 50%;\n\n                left: 50%;\n\n                right:50%;\n\n                transform: translate(-50%, -50%);\n\n                }\n\n    </style>\n\n   \n\n    </head>\n\n    <body>\n\n   \n\n    <div class=\"container\">\n\n        <div class=\"row\">\n\n            <div class=\"col-md-12\">\n\n                <h2>Please define scope of the request for study</h2>\n\n                <p>{{ study.name__v  }}  {{ study.study_alias__c  }}</p>\n\n           \n\n            <div class=\"tabs\">\n\n                   <nav id=\"tab\">\n\n                       <a id=\"tabCTA\" href=\"javascript:;\"  style=\"text-decoration: none;\" data-cont=\"CTA\" class=\"active\">CTA Application</a>\n\n                    <a id=\"tabCTD\" href=\"javascript:;\" style=\"text-decoration: none;\" data-cont=\"CTAD\">CTA Amendment</a>\n\n                  </nav>\n\n                    <br/>\n\n \n\n                    <section class=\"cont\" id =\"CTA\" style=\"display:block\">\n\n                        <div class=\"table-responsive\">\n\n                            <form method=\"post\" action=\"/nodes/cta/execute\">\n\n                            <input type=\"hidden\" id=\"applicationType\" name=\"job_scope\" value=\"\" />\n\n                            <input type=\"hidden\" id=\"jobType\" name=\"job_type\" value=\"0\" />\n\n                       {{#hiddenfields}}\n\n                            <input type=\"hidden\" name=\"{{name}}\" value=\"{{value}}\" />\n\n                        {{/hiddenfields}}\n\n                              <tr>\n\n                                    <td>\n\n                                     <input id=\"submitCTA\" type=\"submit\" style=\"width:70px;height:30px\" value=\"Next\" class=\"btn btn-primary\" disabled=\"true\">\n\n                                 </td>\n\n\n\n\n                                        <td>\n\n                                     <button id=\"cancelCTA\" onclick=\"window.history.go(-{{ . }})\" class=\"btn btn-primary\" style=\"width:70px;height:30px\" value=\"Cancel\">Cancel</button>\n\n                                 </td>\n\n\n\n\n                              </tr>\n\n                                <br/>\n\n                                <tr> CTA Application: </tr>\n\n                                <br/>\n\n                                <div>\n\n                                    <tr>&nbsp;&nbsp;&nbsp;\n\n                                       <td><input type=\"checkbox\" value=\"CreateEvent\" name=\"CreateEvent\" class=\"CreateEvent\">&nbsp;Planning phase – Create Event and CTA Content Plan <span style=\"color:blue\"> (The first step to create tracking objects for a CTA is the creation of Event(s). When IMPD information is available or At time of document collection, the Event and Content Plan can be created)</span></td>\n\n                                    </tr>\n\n                                    <br/> <br/>\n\n                                     <tr>&nbsp;&nbsp;&nbsp;\n\n                                       <td><input type=\"checkbox\" value=\"CreateCountry\" name=\"CreateCountry\" class=\"CreateCountry\">&nbsp;Preparation phase – Create Country Application(s) <span style=\"color:blue\"> (Applications would only be created if not yet available. Therefore, it is strongly recommended to  <span style=\"font-weight:bold;\">first conduct a search for already existing applications. The corresponding CTA Amendment Event is needed to perform this action.</span>)</span></td>\n\n                                    </tr>\n\n                                     <br/> <br/>\n\n                                     <tr>&nbsp;&nbsp;&nbsp;\n\n                                       <td><input type=\"checkbox\" value=\"CreateRelated\" name=\"CreateRelated\" class=\"CreateRelated\">&nbsp;Preparation phase – Create Related Records <span style=\"color:blue\"> (When the final core package is ready for dispatch, Regulatory Objective and Submission records must be created to track the submission process. <span style=\"font-weight:bold;\">The corresponding CTA Amendment Event and Application(s) of the involved countries are needed to perform this action.</span>)</span></td>\n\n                                    </tr>\n\n                                </div>\n\n                                 <br/>\n\n                            </form>\n\n                        </div>\n\n                    </section>\n\n                    <section class=\"cont\" id=\"CTAD\">\n\n                        <div class=\"table-responsive\">\n\n                        <form method=\"post\" action=\"/nodes/cta/execute\">\n\n                         <input type=\"hidden\" id=\"applicationADType\" name=\"job_scope\" value=\"\" />\n\n                         <input type=\"hidden\" id=\"jobADType\" name=\"job_type\" value=\"0\" />\n\n                         {{#hiddenfields}}\n\n                         <input type=\"hidden\" name=\"{{name}}\" value=\"{{value}}\" />\n\n                         {{/hiddenfields}}\n\n                              <tr>\n\n                                    <td>\n\n                                     <input id=\"submitCTAD\" type=\"submit\" style=\"width:70px;height:30px\" value=\"Next\" class=\"btn btn-primary\" disabled=\"true\">\n\n                                 </td>\n\n\n\n\n                                        <td>\n\n                                     <button id=\"cancelCTAD\" onclick=\"window.history.go(-{{ . }})\" class=\"btn btn-primary\" style=\"width:70px;height:30px\" value=\"Cancel\">Cancel</button>\n\n                                 </td>\n\n\n\n\n                              </tr>\n\n                                <br/>\n\n                                <tr> CTA Amendment: </tr>\n\n                                <br/>\n\n                                <div>\n\n                                    <tr>&nbsp;&nbsp;&nbsp;\n\n                                       <td><input type=\"checkbox\" value=\"CreateADEvent\" name=\"CreateADEvent\" class=\"CreateADEvent\">&nbsp;Planning phase – Create Event and CTA Content Plan <span style=\"color:blue\"> (The first step to create tracking objects for a CTA is the creation of Event(s). Under Event you can set the scope of the to be changed details for all impacted countries.)</span></td>\n\n                                    </tr>\n\n                                    <br/> <br/>\n\n                                     <tr>&nbsp;&nbsp;&nbsp;\n\n                                       <td><input type=\"checkbox\" value=\"CreateADCountry\" name=\"CreateADCountry\" class=\"CreateADCountry\">&nbsp;Preparation phase – Create Country Application(s)  <span style=\"color:blue\"> (Usually the applications are only needed when first CTA application and only need to be created if not ye available. Therefore, it is strongly recommended to  <span style=\"font-weight:bold;\">first conduct a search for already existing applications. The corresponding CTA Application Event is needed to perform this action.</span>)</span></td>\n\n                                    </tr>\n\n                                     <br/> <br/>\n\n                                     <tr>&nbsp;&nbsp;&nbsp;\n\n                                       <td><input type=\"checkbox\" value=\"CreateADRelated\" name=\"CreateADRelated\" class=\"CreateADRelated\">&nbsp;Preparation phase – Create Related Records  <span style=\"color:blue\"> (When the final core package is ready for dispatch, Regulatory Objective and Submission records have to be created to track the submission process. <span style=\"font-weight:bold;\">The corresponding CTA Amendment Event and Application(s) of the involved countries are needed to perform this action.</span>)</span></td>\n\n                                    </tr>\n\n                                </div>\n\n                                 <br/>\n\n                            </form>\n\n                        </div>\n\n                       </section>\n\n                </div>\n\n            </div>\n\n        </div>\n\n    </div>\n\n    </body>\n\n</html>\n\n\n\n\n<script>\n\n    $(function(){\n\n          var aArr=document.querySelectorAll('a');\n\n          for(var i=0;i<aArr.length;i++){\n\n          aArr[i].onclick=function(){\n\n        var active=document.querySelector(\".active\");\n\n        active.classList.remove(\"active\");\n\n        this.classList.add(\"active\");\n\n        var name=this.getAttribute(\"data-cont\");\n\n        var section=document.getElementById(name);\n\n        var cont = document.getElementsByClassName(\"cont\");\n\n        for(var i=0;i<cont.length;i++){\n\n        cont[i].style.display=\"none\";\n\n\n\n\n        }\n\n        section.style.display=\"block\";\n\n\n\n\n\n          }\n\n      }\n\n    })\n\n</script>\n\n<script>\n\n    $(\"#CTAD\").change(function(){\n\n        var createEvent = document.getElementsByClassName('CreateADEvent');\n\n        var createCountry = document.getElementsByClassName('CreateADCountry');\n\n        var createRelated = document.getElementsByClassName('CreateADRelated');\n\n        var applicationType = document.getElementById('applicationADType').value.toString();\n\n           if(applicationType.startsWith('_'))\n\n            applicationType = applicationType.substring(1);\n\n     \n\n        var checkedcta = 0\n\n        for(let i=0; i<createEvent.length; i++){\n\n            if(createEvent[i].checked){\n\n               checkedcta = 1\n\n                 if(!applicationType.includes(\"CreateADEvent\"))\n\n                  applicationType=applicationType+'_CreateADEvent'\n\n               document.getElementById('applicationADType').value = applicationType\n\n            } else {\n\n                newType = applicationType.replace(\"CreateADEvent\", \"\")\n\n                newType = newType.replace(\"__\", \"_\")\n\n\n\n\n                applicationType = newType\n\n                document.getElementById('applicationADType').value = newType\n\n            }\n\n        }\n\n\n\n\n        for(let i=0; i<createCountry.length; i++){\n\n            if(createCountry[i].checked){\n\n               checkedcta = 1\n\n            if(!applicationType.includes(\"CreateADCountry\"))\n\n                  applicationType=applicationType+'_CreateADCountry'\n\n               document.getElementById('applicationADType').value = applicationType\n\n            } else {\n\n                newType = applicationType.replace(\"CreateADCountry\", \"\")\n\n                newType = newType.replace(\"__\", \"_\")\n\n\n\n\n                applicationType = newType\n\n                document.getElementById('applicationADType').value = newType\n\n            }\n\n        }\n\n\n\n\n        for(let i=0; i<createRelated.length; i++){\n\n            if(createRelated[i].checked){\n\n               checkedcta = 1\n\n                if(!applicationType.includes(\"CreateADRelated\"))\n\n                   applicationType=applicationType+'_CreateADRelated'\n\n               document.getElementById('applicationADType').value = applicationType\n\n            } else {\n\n                newType = applicationType.replace(\"CreateADRelated\", \"\")\n\n                newType = newType.replace(\"__\", \"_\")\n\n\n\n\n                applicationType = newType\n\n                document.getElementById('applicationADType').value = newType\n\n            }\n\n        }\n\n        if(checkedcta == 0){\n\n            document.getElementById('submitCTAD').disabled= true\n\n            document.getElementById('tabCTA').style = \"text-decoration: none;\"\n\n        }\n\n        if(checkedcta !== 0){\n\n           document.getElementById('submitCTAD').disabled= false\n\n           document.getElementById('tabCTA').style = \"pointer-events: none;\"\n\n           document.getElementById('jobADType').value = 2\n\n        }\n\n        console.log(checkedcta)\n\n    })\n\n</script>\n\n<script>\n\n    $(\"#CTA\").change(function(){\n\n        var createEvent = document.getElementsByClassName('CreateEvent');\n\n        var createCountry = document.getElementsByClassName('CreateCountry');\n\n        var createRelated = document.getElementsByClassName('CreateRelated');\n\n        var applicationType = document.getElementById('applicationType').value.toString();\n\n\n\n\n        if(applicationType.startsWith('_'))\n\n            applicationType = applicationType.substring(1);\n\n           \n\n\n\n\n        var checkedcta = 0\n\n        for(let i=0; i<createEvent.length; i++){\n\n            if(createEvent[i].checked){\n\n                console.log(\"--- clicked\")\n\n               checkedcta = 1\n\n               if(!applicationType.includes(\"CreateEvent\"))\n\n                  applicationType=applicationType+'_CreateEvent'\n\n               document.getElementById('applicationType').value = applicationType\n\n            } else {\n\n                newType = applicationType.replace(\"CreateEvent\", \"\")\n\n                newType = newType.replace(\"__\", \"_\")\n\n\n\n\n                applicationType = newType\n\n                document.getElementById('applicationType').value = newType\n\n            }\n\n        }\n\n\n\n\n        for(let i=0; i<createCountry.length; i++){\n\n            if(createCountry[i].checked){\n\n               checkedcta = 1\n\n               if(!applicationType.includes(\"CreateCountry\"))\n\n                  applicationType=applicationType+'_CreateCountry'\n\n               document.getElementById('applicationType').value = applicationType\n\n            } else {\n\n                newType = applicationType.replace(\"CreateCountry\", \"\")\n\n                newType = newType.replace(\"__\", \"_\")\n\n\n\n\n                applicationType = newType\n\n\n\n\n                document.getElementById('applicationType').value = newType\n\n            }\n\n        }\n\n\n\n\n        for(let i=0; i<createRelated.length; i++){\n\n            if(createRelated[i].checked){\n\n               checkedcta = 1\n\n               if(!applicationType.includes(\"createRelated\"))\n\n                   applicationType=applicationType+'_createRelated'\n\n               document.getElementById('applicationType').value = applicationType\n\n            } else {\n\n                newType = applicationType.replace(\"createRelated\", \"\")\n\n                newType = newType.replace(\"__\", \"_\")\n\n\n\n\n                applicationType = newType\n\n                document.getElementById('applicationType').value = newType\n\n            }\n\n        }\n\n        if(checkedcta == 0){\n\n            //document.getElementById('submitCTA').style.display='none'\n\n            document.getElementById('submitCTA').disabled= true\n\n            document.getElementById('tabCTD').style = \"text-decoration: none;\"\n\n           \n\n        }\n\n        if(checkedcta !== 0){\n\n           document.getElementById('submitCTA').disabled= false\n\n           document.getElementById('tabCTD').style = \"pointer-events: none;\"\n\n           document.getElementById('jobType').value = 1\n\n        }\n\n        console.log(checkedcta)\n\n    })\n\n</script>",
        "output": "str",
        "x": 2390,
        "y": 580,
        "wires": [
            [
                "413d0d4919352499",
                "ecd1f9618322385c"
            ]
        ]
    },
    {
        "id": "ecd1f9618322385c",
        "type": "http response",
        "z": "2c4527dad914ec1c",
        "g": "1adf9a7b09d9ec3e",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 2630,
        "y": 580,
        "wires": []
    },
    {
        "id": "1f4c810a5b6057fd",
        "type": "http in",
        "z": "2c4527dad914ec1c",
        "g": "a7a8a74946229b91",
        "name": "",
        "url": "cta/execute",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 150,
        "y": 820,
        "wires": [
            [
                "120256ee19425fdd"
            ]
        ]
    },
    {
        "id": "43a8f21c944f48c2",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "1adf9a7b09d9ec3e",
        "name": "No Indication",
        "rules": [
            {
                "t": "set",
                "p": "hiddenfields",
                "pt": "msg",
                "to": "[\t   {\t       \"name\": \"study_id\",\t       \"value\": study_id    \t   },\t   {\t       \"name\": \"client_id\",\t       \"value\": \"cta-automation\"    \t   },\t   {\t       \"name\": \"vault_domain_url\",\t       \"value\": vault_domain_url\t   },\t   {\t       \"name\": \"session_id\",\t       \"value\": session_id\t   }\t]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1650,
        "y": 600,
        "wires": [
            [
                "ec1a25f9388786d7"
            ]
        ]
    },
    {
        "id": "120256ee19425fdd",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "a7a8a74946229b91",
        "name": "Store parameters",
        "rules": [
            {
                "t": "set",
                "p": "study_id",
                "pt": "msg",
                "to": "payload.study_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "client_id",
                "pt": "msg",
                "to": "payload.client_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "vault_domain_url",
                "pt": "msg",
                "to": "payload.vault_domain_url",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "session_id",
                "pt": "msg",
                "to": "payload.session_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "vault_api",
                "pt": "msg",
                "to": "vault_domain_url & \"/api/\"",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "event_id",
                "pt": "msg",
                "to": "payload.event_id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 370,
        "y": 820,
        "wires": [
            [
                "a69633711211e86e"
            ]
        ]
    },
    {
        "id": "a21361800a8e5222",
        "type": "http response",
        "z": "2c4527dad914ec1c",
        "g": "c3cc3bc6b0b0ab38",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 910,
        "y": 1080,
        "wires": []
    },
    {
        "id": "a69633711211e86e",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "a7a8a74946229b91",
        "name": "payload.job exists?",
        "property": "$exists(payload.job)",
        "propertyType": "jsonata",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 590,
        "y": 820,
        "wires": [
            [
                "bfd4c5ba48630dad"
            ],
            [
                "f8af263b4577eb60"
            ]
        ]
    },
    {
        "id": "f8af263b4577eb60",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "a7a8a74946229b91",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "job.job_type",
                "pt": "msg",
                "to": "payload.job_type",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "job.job_scope",
                "pt": "msg",
                "to": "payload.job_scope",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 780,
        "y": 840,
        "wires": [
            [
                "4e0728471558a67e"
            ]
        ]
    },
    {
        "id": "bfd4c5ba48630dad",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "a7a8a74946229b91",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "job",
                "pt": "msg",
                "to": "payload.job",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 770,
        "y": 800,
        "wires": [
            [
                "4e0728471558a67e"
            ]
        ]
    },
    {
        "id": "806db9d17f47a16f",
        "type": "http in",
        "z": "2c4527dad914ec1c",
        "g": "a7a8a74946229b91",
        "name": "",
        "url": "cta/execute",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 1120,
        "y": 880,
        "wires": [
            [
                "6517fc922a6908a8"
            ]
        ]
    },
    {
        "id": "6517fc922a6908a8",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "a7a8a74946229b91",
        "name": "Store parameters",
        "rules": [
            {
                "t": "set",
                "p": "study_id",
                "pt": "msg",
                "to": "payload.study_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "client_id",
                "pt": "msg",
                "to": "cta-automation",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "created_event_id",
                "pt": "msg",
                "to": "payload.event_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "event_id",
                "pt": "msg",
                "to": "payload.event_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "job.job_type",
                "pt": "msg",
                "to": "payload.job_type",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "job.job_scope",
                "pt": "msg",
                "to": "payload.job_scope",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1330,
        "y": 880,
        "wires": [
            [
                "edf88ee6c1a5aee3"
            ]
        ]
    },
    {
        "id": "c83461d786b5f389",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "c3cc3bc6b0b0ab38",
        "name": "debug 370",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 410,
        "y": 1020,
        "wires": []
    },
    {
        "id": "edf88ee6c1a5aee3",
        "type": "brave-login",
        "z": "2c4527dad914ec1c",
        "g": "a7a8a74946229b91",
        "name": "",
        "x": 1490,
        "y": 880,
        "wires": [
            [
                "0b5e993385abdbaf"
            ],
            [
                "ec46849d03dc97ee"
            ]
        ]
    },
    {
        "id": "69470779e142a87f",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "",
        "x": 380,
        "y": 1460,
        "wires": [
            [
                "8fde7159b4debb7a"
            ],
            [
                "3916d23c39b50211"
            ]
        ]
    },
    {
        "id": "8c22964409200907",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "create REC",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"regulatory_event_code__c\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t   {\t       \t   }\t]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 130,
        "y": 1460,
        "wires": [
            [
                "69470779e142a87f"
            ]
        ]
    },
    {
        "id": "73d1b1cc1b17b0a8",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "debug 379",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 890,
        "y": 1460,
        "wires": []
    },
    {
        "id": "8fde7159b4debb7a",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "store result",
        "rules": [
            {
                "t": "set",
                "p": "rec_id",
                "pt": "msg",
                "to": "payload.data[0].data.id",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 650,
        "y": 1460,
        "wires": [
            [
                "73d1b1cc1b17b0a8",
                "127f606ce23423fd"
            ]
        ]
    },
    {
        "id": "ac182d7b69f0f86a",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "Create Global Content Plan",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "vault_api & \"v22.2/vobjects/event__rim/\" & event_id &\"/actions/Objectlifecyclestateuseraction.event__rim.planned_state__c.create_global_content_plan_useraction__c\"",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "headers",
                "pt": "msg",
                "to": "{\t   \"Authorization\": session_id,\t   \"Accept\": \"application/json\",\t   \"Content-Type\": \"application/x-www-form-urlencoded\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 180,
        "y": 1580,
        "wires": [
            [
                "fd63e95672fb41ae"
            ]
        ]
    },
    {
        "id": "8cfa0940562a9266",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "debug 380",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 870,
        "y": 1580,
        "wires": []
    },
    {
        "id": "fd63e95672fb41ae",
        "type": "http request",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 430,
        "y": 1580,
        "wires": [
            [
                "8cfa0940562a9266",
                "1125ca63681257a8"
            ]
        ]
    },
    {
        "id": "eadb4a6f7d0dd4bc",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "query global application",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, product__v, product__vr.name__v from application__v where object_type__vr.api_name__v='global_application__v' and product__v='\" & study.product__v & \"'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 170,
        "y": 1400,
        "wires": [
            [
                "5872344ca0191238"
            ]
        ]
    },
    {
        "id": "5872344ca0191238",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "",
        "x": 370,
        "y": 1400,
        "wires": [
            [
                "b2a1451aac0e94f7"
            ],
            [
                "3916d23c39b50211"
            ]
        ]
    },
    {
        "id": "b2a1451aac0e94f7",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "global_application",
                "pt": "msg",
                "to": "payload.data[0].id",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 700,
        "y": 1400,
        "wires": [
            [
                "1e68c40c7d454e51",
                "8c22964409200907"
            ]
        ]
    },
    {
        "id": "1e68c40c7d454e51",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "e40195be7e014804",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 910,
        "y": 1400,
        "wires": []
    },
    {
        "id": "34ea1cc0751f076c",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "create event",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"event__rim\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t   {\t       \"object_type__vr.api_name__v\": \"clinical_study_event__c\",\t       \"applicable_product_type__v\": \"drug__v\",\t       \"event_description__c\": (params.event_description__c !=\"\" ? params.event_description__c : \"N/A\" )& (params.shelf_life !=\"\" ? \"; Shelf life: \" & params.shelf_life : \"\"),\t       \"keywords__c\": event_keywords_name,\t       \"rec__c\": rec_id,\t       \"global_application__v\": global_application,\t       \"content_plan_template__v\": \"0EP00000004B425\",\t       \"project_id__c\": study.project_clinical_studies__cr.data[0].project__c\t\t   }\t]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 130,
        "y": 2980,
        "wires": [
            [
                "66ee8a94fb2d7adc"
            ]
        ]
    },
    {
        "id": "9ffd347dc28797f2",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "store result",
        "rules": [
            {
                "t": "set",
                "p": "event_id",
                "pt": "msg",
                "to": "payload.data[0].data.id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 650,
        "y": 2980,
        "wires": [
            [
                "4fca64c6e5d7ed76",
                "d75de5f5f81a0adc"
            ]
        ]
    },
    {
        "id": "37089233c845847c",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "link to product family",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"event_product_family__c\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t   {\t       \"name__v\": event_id & \"_\" & study.product__v,\t       \"event__c\": event_id,\t       \"product_family__c\": study.product__v\t    }\t]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 160,
        "y": 3100,
        "wires": [
            [
                "bc0bf892de0b4278"
            ]
        ]
    },
    {
        "id": "0b502743c2105427",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "link to products",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"event_drug_product__rim\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t    study.clinical_study_products__cr.data.{\t       \"event__rim\": $$.event_id,\t       \"product_family__c\": product_family__c,\t       \"drug_product__rim\": product__c,\t       \"product_detail__rim\": product_variant__c\t    }\t]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 140,
        "y": 3160,
        "wires": [
            [
                "5451e2d8fb92f9f3"
            ]
        ]
    },
    {
        "id": "b8f295cb419ef511",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "link to study",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"event_clinical_study__v\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t   {\t       \"event__v\": event_id,\t       \"clinical_study__v\": study_id,\t       \"impd_version_quality_part__c\": params.impd_version_quality_part__c,\t       \"impd_version_nonquality_part__c\": params.impd_version_nonquality_part__c,\t       \"protocol_version__c\": params.protocol_version__c,\t       \"ib_version__c\": params.ib_version__c\t    }\t]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 130,
        "y": 3220,
        "wires": [
            [
                "9a5044524de15b1f"
            ]
        ]
    },
    {
        "id": "4fca64c6e5d7ed76",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 910,
        "y": 2980,
        "wires": []
    },
    {
        "id": "7afeedf6bafee44a",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 910,
        "y": 3100,
        "wires": []
    },
    {
        "id": "c407710e5c667233",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 910,
        "y": 3160,
        "wires": []
    },
    {
        "id": "463d51c07d96306f",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 910,
        "y": 3220,
        "wires": []
    },
    {
        "id": "66ee8a94fb2d7adc",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "",
        "x": 440,
        "y": 2980,
        "wires": [
            [
                "9ffd347dc28797f2"
            ],
            [
                "8b5fc85d413405da"
            ]
        ]
    },
    {
        "id": "bc0bf892de0b4278",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "",
        "x": 440,
        "y": 3100,
        "wires": [
            [
                "0b502743c2105427",
                "7afeedf6bafee44a"
            ],
            [
                "8b5fc85d413405da"
            ]
        ]
    },
    {
        "id": "5451e2d8fb92f9f3",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "",
        "x": 440,
        "y": 3160,
        "wires": [
            [
                "c407710e5c667233",
                "b8f295cb419ef511"
            ],
            [
                "8b5fc85d413405da"
            ]
        ]
    },
    {
        "id": "9a5044524de15b1f",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "",
        "x": 440,
        "y": 3220,
        "wires": [
            [
                "463d51c07d96306f",
                "7a6a4a210e0afacd"
            ],
            [
                "8b5fc85d413405da"
            ]
        ]
    },
    {
        "id": "8b5fc85d413405da",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "",
        "mode": "link",
        "links": [
            "0b4394d395558302"
        ],
        "x": 685,
        "y": 3140,
        "wires": []
    },
    {
        "id": "7a6a4a210e0afacd",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "link to indications",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"event_indication__rim\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t   study.therapeutic_indication_clinical_studies__cr.data.{\t       \"product_family__c\": $$.study.product__v,\t       \"indication__rim\": therapeutic_indication__c,\t       \"event__rim\": $$.event_id\t    }\t]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 150,
        "y": 3280,
        "wires": [
            [
                "c87ff740f015c7a0"
            ]
        ]
    },
    {
        "id": "c87ff740f015c7a0",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "",
        "x": 440,
        "y": 3280,
        "wires": [
            [
                "156170586af1680b",
                "b3fb81e7e5885281"
            ],
            [
                "8b5fc85d413405da"
            ]
        ]
    },
    {
        "id": "156170586af1680b",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 910,
        "y": 3280,
        "wires": []
    },
    {
        "id": "4a5932fab86abe01",
        "type": "http in",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "",
        "url": "cta/amend_event",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 190,
        "y": 2680,
        "wires": [
            [
                "c936f98b296593d4",
                "677b8bbeb3897d59"
            ]
        ]
    },
    {
        "id": "677b8bbeb3897d59",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "store parameters",
        "rules": [
            {
                "t": "set",
                "p": "study_id",
                "pt": "msg",
                "to": "payload.study_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "params",
                "pt": "msg",
                "to": "payload",
                "tot": "msg",
                "dc": true
            },
            {
                "t": "set",
                "p": "job.job_scope",
                "pt": "msg",
                "to": "payload.job_scope",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "job.job_type",
                "pt": "msg",
                "to": "payload.job_type",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "event_keywords_name",
                "pt": "msg",
                "to": "payload.event_keywords_name",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 450,
        "y": 2680,
        "wires": [
            [
                "286d257af08d6582",
                "18edec20a999d8ea"
            ]
        ]
    },
    {
        "id": "18edec20a999d8ea",
        "type": "brave-login",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "",
        "x": 930,
        "y": 2740,
        "wires": [
            [
                "adbccecc70ccc1de"
            ],
            [
                "8b5fc85d413405da"
            ]
        ]
    },
    {
        "id": "286d257af08d6582",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 630,
        "y": 2640,
        "wires": []
    },
    {
        "id": "b3fb81e7e5885281",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "restart CTA creation",
        "rules": [
            {
                "t": "set",
                "p": "headers",
                "pt": "msg",
                "to": "{\t   \"location\":\"/nodes/cta/execute?study_id=\" & study_id & \"&event_id=\" & event_id & \"&job_type=\" & job.job_type & \"&job_scope=\" & job.job_scope\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "statusCode",
                "pt": "msg",
                "to": "303",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 150,
        "y": 3340,
        "wires": [
            [
                "ea80771e71258993"
            ]
        ]
    },
    {
        "id": "c936f98b296593d4",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 390,
        "y": 2640,
        "wires": []
    },
    {
        "id": "adbccecc70ccc1de",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "query study",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, study_alias__c, product__v, product__vr.name__v, (select id, name__v, product__c, product__cr.name__v, product_family__c, product_family__cr.name__v, product_variant__c, product_variant__cr.name__v from clinical_study_products__cr), (select id, project__c, project__cr.name__v from project_clinical_studies__cr), (select id, name__v, therapeutic_indication__c, therapeutic_indication__cr.name__v from therapeutic_indication_clinical_studies__cr) from clinical_study__v where id='\" & study_id & \"'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 130,
        "y": 2800,
        "wires": [
            [
                "57f50ef402c17c23"
            ]
        ]
    },
    {
        "id": "57f50ef402c17c23",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "",
        "x": 430,
        "y": 2800,
        "wires": [
            [
                "6f439a7a79524586"
            ],
            [
                "8b5fc85d413405da"
            ]
        ]
    },
    {
        "id": "6f439a7a79524586",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "study",
                "pt": "msg",
                "to": "payload.data[0]",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 660,
        "y": 2800,
        "wires": [
            [
                "6c02ed1e44e31e22",
                "65c358887f4e068f"
            ]
        ]
    },
    {
        "id": "6c02ed1e44e31e22",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 910,
        "y": 2800,
        "wires": []
    },
    {
        "id": "ea80771e71258993",
        "type": "http response",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 410,
        "y": 3340,
        "wires": []
    },
    {
        "id": "d3885638377c2c4a",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "create REC",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t   \"object_name\": \"regulatory_event_code__c\",\t   \"keep\": \"false\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[\t   {\t       \t   }\t]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 130,
        "y": 2920,
        "wires": [
            [
                "1dd759108b42270b"
            ]
        ]
    },
    {
        "id": "1dd759108b42270b",
        "type": "brave-create-vobject",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "",
        "x": 440,
        "y": 2920,
        "wires": [
            [
                "67d9ed8e3673348f"
            ],
            [
                "8b5fc85d413405da"
            ]
        ]
    },
    {
        "id": "55ba323f168715bb",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "debug 381",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 930,
        "y": 2920,
        "wires": []
    },
    {
        "id": "67d9ed8e3673348f",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "store result",
        "rules": [
            {
                "t": "set",
                "p": "rec_id",
                "pt": "msg",
                "to": "payload.data[0].data.id",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 650,
        "y": 2920,
        "wires": [
            [
                "55ba323f168715bb",
                "34ea1cc0751f076c"
            ]
        ]
    },
    {
        "id": "d75de5f5f81a0adc",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "Create Global Content Plan",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "vault_api & \"v22.2/vobjects/event__rim/\" & event_id &\"/actions/Objectlifecyclestateuseraction.event__rim.planned_state__c.create_global_content_plan_useraction__c\"",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "headers",
                "pt": "msg",
                "to": "{\t   \"Authorization\": session_id,\t   \"Accept\": \"application/json\",\t   \"Content-Type\": \"application/x-www-form-urlencoded\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 180,
        "y": 3040,
        "wires": [
            [
                "74f2aa2cafa46f84"
            ]
        ]
    },
    {
        "id": "c4dd41f3d158cecd",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "debug 382",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 930,
        "y": 3040,
        "wires": []
    },
    {
        "id": "74f2aa2cafa46f84",
        "type": "http request",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 430,
        "y": 3040,
        "wires": [
            [
                "c4dd41f3d158cecd",
                "37089233c845847c"
            ]
        ]
    },
    {
        "id": "65c358887f4e068f",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "query global application",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, product__v, product__vr.name__v from application__v where object_type__vr.api_name__v='global_application__v' and product__v='\" & study.product__v & \"'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 170,
        "y": 2860,
        "wires": [
            [
                "2eae4c60b1476596"
            ]
        ]
    },
    {
        "id": "37f99f391a826882",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 910,
        "y": 2860,
        "wires": []
    },
    {
        "id": "b9c7b78dd7d44017",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "global_application",
                "pt": "msg",
                "to": "payload.data[0].id",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 700,
        "y": 2860,
        "wires": [
            [
                "37f99f391a826882",
                "d3885638377c2c4a"
            ]
        ]
    },
    {
        "id": "2eae4c60b1476596",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "",
        "x": 430,
        "y": 2860,
        "wires": [
            [
                "b9c7b78dd7d44017"
            ],
            [
                "8b5fc85d413405da"
            ]
        ]
    },
    {
        "id": "e4914f34cdb1e255",
        "type": "link in",
        "z": "2c4527dad914ec1c",
        "g": "77a95a28986a8bfc",
        "name": "link in 6",
        "links": [],
        "x": 75,
        "y": 2380,
        "wires": [
            [
                "25d332512d7867b8"
            ]
        ]
    },
    {
        "id": "82d495ca62c54a03",
        "type": "http response",
        "z": "2c4527dad914ec1c",
        "g": "77a95a28986a8bfc",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 620,
        "y": 2380,
        "wires": []
    },
    {
        "id": "1a580dd7501928eb",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "77a95a28986a8bfc",
        "name": "set fields for input form",
        "rules": [
            {
                "t": "set",
                "p": "title",
                "pt": "msg",
                "to": "\"Creating Event for Study \" & study.name__v & \" \" & study.study_alias__c",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "type",
                "pt": "msg",
                "to": "checkbox",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "description",
                "pt": "msg",
                "to": "Please select Event Keywords.",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "tableheader",
                "pt": "msg",
                "to": "{\"columns\":[\"Event Keyword\"]}",
                "tot": "json"
            },
            {
                "t": "set",
                "p": "dataarray",
                "pt": "msg",
                "to": "Event_Keywords.{\t   \"selection\": $string(),\t   \"columns\": \t   [\t       Title\t       ]\t}",
                "tot": "jsonata",
                "dc": true
            },
            {
                "t": "set",
                "p": "flow",
                "pt": "msg",
                "to": "nodes/cta/event_info",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "hiddenfields",
                "pt": "msg",
                "to": "[\t   {\t       \"name\": \"study_id\",\t       \"value\": study_id\t    },\t    {\t        \"name\": \"job_type\",\t        \"value\": job.job_type\t    },\t    {\t        \"name\": \"job_scope\",\t        \"value\": job.job_scope\t    }\t]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 230,
        "y": 2380,
        "wires": [
            [
                "20db1f0318099f37"
            ]
        ]
    },
    {
        "id": "20db1f0318099f37",
        "type": "brave-input-form",
        "z": "2c4527dad914ec1c",
        "g": "77a95a28986a8bfc",
        "name": "",
        "x": 450,
        "y": 2380,
        "wires": [
            [
                "82d495ca62c54a03"
            ]
        ]
    },
    {
        "id": "745c1f28d5453c5b",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "event_keywords_string",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 660,
        "y": 2680,
        "wires": [
            [
                "359d517b2871831f"
            ]
        ]
    },
    {
        "id": "c52cd54c453f4f22",
        "type": "json",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "json to object",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 130,
        "y": 2740,
        "wires": [
            [
                "0ed372e867cabe51"
            ]
        ]
    },
    {
        "id": "c9dd85cca0928b83",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "Event Keyword to string",
        "rules": [
            {
                "t": "set",
                "p": "event_keywords_name",
                "pt": "msg",
                "to": "payload.Name ~>\t$reduce(function($i,$j){$i & \",\" & $j})",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 690,
        "y": 2740,
        "wires": [
            [
                "9f0baf50744a8972",
                "18edec20a999d8ea"
            ]
        ]
    },
    {
        "id": "9f0baf50744a8972",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "debug 383",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 990,
        "y": 2660,
        "wires": []
    },
    {
        "id": "359d517b2871831f",
        "type": "split",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 830,
        "y": 2680,
        "wires": [
            [
                "c52cd54c453f4f22"
            ]
        ]
    },
    {
        "id": "0ed372e867cabe51",
        "type": "join",
        "z": "2c4527dad914ec1c",
        "g": "4efce2b6e1fdfe62",
        "name": "",
        "mode": "auto",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": true,
        "timeout": "",
        "count": "",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 410,
        "y": 2740,
        "wires": [
            [
                "c9dd85cca0928b83"
            ]
        ]
    },
    {
        "id": "ceb33ad242526776",
        "type": "http in",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "",
        "url": "cta/create_records",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 3230,
        "y": 2000,
        "wires": [
            [
                "383eedb90d0b8b41"
            ]
        ]
    },
    {
        "id": "ec46849d03dc97ee",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "a7a8a74946229b91",
        "name": "link out 17",
        "mode": "link",
        "links": [
            "0b4394d395558302"
        ],
        "x": 1685,
        "y": 880,
        "wires": []
    },
    {
        "id": "e92dbdab8eb4e6f5",
        "type": "http response",
        "z": "2c4527dad914ec1c",
        "g": "eb7523f05c7170f0",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 3610,
        "y": 1840,
        "wires": []
    },
    {
        "id": "3575399d43c70958",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "eb7523f05c7170f0",
        "name": "set fields for input form",
        "rules": [
            {
                "t": "set",
                "p": "title",
                "pt": "msg",
                "to": "\"Creating records for Study \" & study.name__v & \" \" & study.study_alias__c",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "type",
                "pt": "msg",
                "to": "checkbox",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "description",
                "pt": "msg",
                "to": "Please select the Applications for which RO and Submission would be created.",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "tableheader",
                "pt": "msg",
                "to": "{\"columns\":[\"Application Name\",\"Lead Country\",\"Created Date\"]}",
                "tot": "json"
            },
            {
                "t": "set",
                "p": "dataarray",
                "pt": "msg",
                "to": "applications.{\t   \"selection\": $string(),\t   \"columns\": \t   [\t       name__v, \t       lead_market__rimr.data[0].name__v,\t       created_date__v\t       ]\t}",
                "tot": "jsonata",
                "dc": true
            },
            {
                "t": "set",
                "p": "flow",
                "pt": "msg",
                "to": "nodes/cta/create_records",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "hiddenfields",
                "pt": "msg",
                "to": "[\t   {\t       \"name\": \"study_id\",\t       \"value\": study_id\t    },\t    {\t        \"name\": \"job_type\",\t        \"value\": job.job_type\t    },\t    {\t        \"name\": \"job_scope\",\t        \"value\": job.job_scope\t    },\t    {\t        \"name\": \"event_id\",\t        \"value\": event_id\t    },\t    {\t        \"name\": \"created_application_ids\",\t        \"value\": created_application_ids\t    },\t    {\t        \"name\": \"created_event_id\",\t        \"value\": created_event_id\t    }\t]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3180,
        "y": 1840,
        "wires": [
            [
                "c229575af81a577a"
            ]
        ]
    },
    {
        "id": "c229575af81a577a",
        "type": "brave-input-form",
        "z": "2c4527dad914ec1c",
        "g": "eb7523f05c7170f0",
        "name": "",
        "x": 3450,
        "y": 1840,
        "wires": [
            [
                "e92dbdab8eb4e6f5"
            ]
        ]
    },
    {
        "id": "4b8eadec1c5671af",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "a7a8a74946229b91",
        "name": "link out 18",
        "mode": "link",
        "links": [
            "02de661d53928e64",
            "da23fd7381dc1b26",
            "e3d2034e8f5e2cdb"
        ],
        "x": 2925,
        "y": 820,
        "wires": []
    },
    {
        "id": "6ee4c82e5bbdfb64",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "eb7523f05c7170f0",
        "name": "query applications",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, lead_market__rim, (select name__v, region__v, reporting_region__c from lead_market__rimr), created_date__v from application__v where id in (select application__c from application_clinical_studies__cr where clinical_study__c='\" & study_id & \"') and \" & app_filter",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3170,
        "y": 1720,
        "wires": [
            [
                "baa100f75a1bdf83"
            ]
        ]
    },
    {
        "id": "baa100f75a1bdf83",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "eb7523f05c7170f0",
        "name": "",
        "x": 3450,
        "y": 1720,
        "wires": [
            [
                "69e9f2c548c72906"
            ],
            [
                "0acb4f725a0b3b4d"
            ]
        ]
    },
    {
        "id": "69e9f2c548c72906",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "eb7523f05c7170f0",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "applications",
                "pt": "msg",
                "to": "payload.data",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3660,
        "y": 1720,
        "wires": [
            [
                "dbb0938eb77fb439",
                "c5fde75660caf0e0"
            ]
        ]
    },
    {
        "id": "dbb0938eb77fb439",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "eb7523f05c7170f0",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3850,
        "y": 1720,
        "wires": []
    },
    {
        "id": "da23fd7381dc1b26",
        "type": "link in",
        "z": "2c4527dad914ec1c",
        "g": "0cad5663dc4721fe",
        "name": "link in 8",
        "links": [
            "4b8eadec1c5671af"
        ],
        "x": 3095,
        "y": 800,
        "wires": [
            [
                "6e512e1221e08cb3"
            ]
        ]
    },
    {
        "id": "f6ab8aa482d9d67f",
        "type": "http response",
        "z": "2c4527dad914ec1c",
        "g": "0cad5663dc4721fe",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 4070,
        "y": 920,
        "wires": []
    },
    {
        "id": "b6c6c4bc76a4ba53",
        "type": "brave-input-form",
        "z": "2c4527dad914ec1c",
        "g": "0cad5663dc4721fe",
        "name": "",
        "x": 3890,
        "y": 920,
        "wires": [
            [
                "f6ab8aa482d9d67f"
            ]
        ]
    },
    {
        "id": "0181e70f2a18599b",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "0cad5663dc4721fe",
        "name": "query event",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, brave_event_code__cr.name__v, event_description__c, keywords__c, state__v from event__rim where object_type__vr.api_name__v = 'clinical_study_event__c' and applicable_product_type__v = 'drug__v'and keywords__c != 'clinical_initial_cta__c' and id in (select id from event_clinical_studies__vr where clinical_study__v='\" & study_id & \"') and state__v != 'inactive_state__c' and State__v != 'cancelled_state__c'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3350,
        "y": 780,
        "wires": [
            [
                "6d26ea123b445cc9"
            ]
        ]
    },
    {
        "id": "6d26ea123b445cc9",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "0cad5663dc4721fe",
        "name": "",
        "x": 3530,
        "y": 800,
        "wires": [
            [
                "70be352a47eee3c5"
            ],
            [
                "e2bbf68093902dd8"
            ]
        ]
    },
    {
        "id": "8985a769a95830ae",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "0cad5663dc4721fe",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "event_keyword",
                "pt": "msg",
                "to": "[\t    {\t        \"Title\": \"CMC Change\",\t        \"Name\": \"clinical_cmc_change__c\"\t    },\t    {\t        \"Title\": \"End of Study\",\t        \"Name\": \"clinical_end_of_study__c\"\t    },\t    {\t        \"Title\": \"IB Amendment\",\t        \"Name\": \"clinical_ib_amendment__c\"\t    }\t]",
                "tot": "json"
            },
            {
                "t": "set",
                "p": "events",
                "pt": "msg",
                "to": "payload.data",
                "tot": "msg",
                "dc": true
            },
            {
                "t": "set",
                "p": "event",
                "pt": "msg",
                "to": "payload.data.{\t    \"event_id\": id,\t   \"event_name\": name__v,\t   \"rec\": `brave_event_code__cr.name__v` != null ? `brave_event_code__cr.name__v` : \"N/A\",\t   \"event_description\": event_description__c,\t   \"keyword\": $reduce(keywords__c[]@$kw.[$$.event_keyword[Name=$kw].Title],function($i,$j){$i & \",\" & $j}) != null ? $reduce(keywords__c[]@$kw.[$$.event_keyword[Name=$kw].Title],function($i,$j){$i & \",\" & $j}) : \"N/A\"\t\t}\t",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3900,
        "y": 800,
        "wires": [
            [
                "a1def3152347a0c1",
                "26a7680b9a307992"
            ]
        ]
    },
    {
        "id": "a1def3152347a0c1",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "0cad5663dc4721fe",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 4070,
        "y": 800,
        "wires": []
    },
    {
        "id": "b1d50aba3ccae290",
        "type": "http in",
        "z": "2c4527dad914ec1c",
        "g": "eb7523f05c7170f0",
        "name": "",
        "url": "cta/app_for_records",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 3210,
        "y": 1400,
        "wires": [
            [
                "6f594307a0362067"
            ]
        ]
    },
    {
        "id": "26a7680b9a307992",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "0cad5663dc4721fe",
        "name": "set fields for input form",
        "rules": [
            {
                "t": "set",
                "p": "title",
                "pt": "msg",
                "to": "\"Creating records for Study \" & study.name__v & \" \" & study.study_alias__c",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "type",
                "pt": "msg",
                "to": "radio",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "description",
                "pt": "msg",
                "to": "Please select the Event for which records would be created",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "tableheader",
                "pt": "msg",
                "to": "{\"columns\":[\"Event Name\",\"Regulatory Event Code\",\"Keywords\",\"Description\"]}",
                "tot": "json"
            },
            {
                "t": "set",
                "p": "dataarray",
                "pt": "msg",
                "to": "event.{\t   \"selection\": $string(),\t   \"columns\": \t   [\t       event_name,\t       rec,\t       keyword,\t       event_description\t    ]\t}",
                "tot": "jsonata",
                "dc": true
            },
            {
                "t": "set",
                "p": "flow",
                "pt": "msg",
                "to": "nodes/cta/ro_type",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "hiddenfields",
                "pt": "msg",
                "to": "[\t   {\t       \"name\": \"study_id\",\t       \"value\": study_id\t    },\t    {\t        \"name\": \"job_type\",\t        \"value\": job.job_type\t    },\t    {\t        \"name\": \"job_scope\",\t        \"value\": job.job_scope\t    },\t    {\t        \"name\": \"created_event_id\",\t        \"value\": created_event_id\t    },\t    {\t        \"name\": \"created_application_ids\",\t        \"value\": created_application_ids\t    }\t\t]\t",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3700,
        "y": 920,
        "wires": [
            [
                "b6c6c4bc76a4ba53"
            ]
        ]
    },
    {
        "id": "383eedb90d0b8b41",
        "type": "json",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "resp_full",
        "property": "payload.response_full",
        "action": "obj",
        "pretty": false,
        "x": 3440,
        "y": 2000,
        "wires": [
            [
                "521d70b563cc5942"
            ]
        ]
    },
    {
        "id": "521d70b563cc5942",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "store parameters",
        "rules": [
            {
                "t": "set",
                "p": "study_id",
                "pt": "msg",
                "to": "payload.study_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "applications",
                "pt": "msg",
                "to": "payload.response_full[]",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "lead_country_string",
                "pt": "msg",
                "to": "payload.lead_country",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "client_id",
                "pt": "msg",
                "to": "cta-automation",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "event_id",
                "pt": "msg",
                "to": "payload.event_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "job.job_scope",
                "pt": "msg",
                "to": "payload.job_scope",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "job.job_type",
                "pt": "msg",
                "to": "payload.job_type",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "created_application_ids",
                "pt": "msg",
                "to": "payload.created_application_ids",
                "tot": "msg",
                "dc": true
            },
            {
                "t": "set",
                "p": "created_event_id",
                "pt": "msg",
                "to": "payload.created_event_id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3690,
        "y": 2000,
        "wires": [
            [
                "618ef6d8cb29ffce"
            ]
        ]
    },
    {
        "id": "618ef6d8cb29ffce",
        "type": "brave-login",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "",
        "x": 3850,
        "y": 2000,
        "wires": [
            [
                "09d4586254506745"
            ],
            [
                "1b109bb176828d44"
            ]
        ]
    },
    {
        "id": "b29bd3b6b73fa3f4",
        "type": "brave-login",
        "z": "2c4527dad914ec1c",
        "g": "eb7523f05c7170f0",
        "name": "",
        "x": 3850,
        "y": 1460,
        "wires": [
            [
                "368a237cb3da03f4"
            ],
            [
                "0acb4f725a0b3b4d"
            ]
        ]
    },
    {
        "id": "96ab22406c6dcd7e",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "213c3efa9b282b39",
        "name": "debug 385",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2430,
        "y": 2340,
        "wires": []
    },
    {
        "id": "c89d44f157d80bc4",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "213c3efa9b282b39",
        "name": "",
        "property": "lead_country_string",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nempty"
            },
            {
                "t": "empty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1310,
        "y": 2400,
        "wires": [
            [
                "551b9623d7990835"
            ],
            [
                "40b6e35085a52486"
            ]
        ]
    },
    {
        "id": "40b6e35085a52486",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "213c3efa9b282b39",
        "name": "Clear lead & cms country",
        "rules": [
            {
                "t": "set",
                "p": "lead_country",
                "pt": "msg",
                "to": "[]",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "cms_countries",
                "pt": "msg",
                "to": "[]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1510,
        "y": 2520,
        "wires": [
            [
                "40898951895346d8"
            ]
        ]
    },
    {
        "id": "a53bccc1a94c03cb",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "0342ae8990d4e5d0",
        "name": "query study",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, study_alias__c, product__v, product__vr.name__v, (select id, name__v, product__c, product__cr.name__v, product_family__c, product_family__cr.name__v, product_variant__c, product_variant__cr.name__v from clinical_study_products__cr), (select id, name__v, therapeutic_indication__c, therapeutic_indication__cr.name__v from therapeutic_indication_clinical_studies__cr) from clinical_study__v where id='\" & study_id & \"'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1330,
        "y": 1260,
        "wires": [
            [
                "d0a29d4805a80d8d"
            ]
        ]
    },
    {
        "id": "d0a29d4805a80d8d",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "0342ae8990d4e5d0",
        "name": "",
        "x": 1630,
        "y": 1260,
        "wires": [
            [
                "4c13bcff35809281"
            ],
            [
                "1e2e089e5f67454c"
            ]
        ]
    },
    {
        "id": "4c13bcff35809281",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "0342ae8990d4e5d0",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "study",
                "pt": "msg",
                "to": "payload.data[0]",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1840,
        "y": 1260,
        "wires": [
            [
                "13bd5f110d29cf33",
                "f366310a370cb263"
            ]
        ]
    },
    {
        "id": "13bd5f110d29cf33",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "0342ae8990d4e5d0",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2110,
        "y": 1260,
        "wires": []
    },
    {
        "id": "bd46d5f7dd3c56b5",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "query study",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, study_alias__c, product__v, product__vr.name__v, (select id, name__v, product__c, product__cr.name__v, product_family__c, product_family__cr.name__v, product_variant__c, product_variant__cr.name__v from clinical_study_products__cr), (select id, name__v, therapeutic_indication__c, therapeutic_indication__cr.name__v from therapeutic_indication_clinical_studies__cr) from clinical_study__v where id='\" & study_id & \"'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1590,
        "y": 2020,
        "wires": [
            [
                "aabf522cbde63186"
            ]
        ]
    },
    {
        "id": "aabf522cbde63186",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "",
        "x": 1870,
        "y": 2020,
        "wires": [
            [
                "8e7df44115a60b5e"
            ],
            [
                "b7de0fe7ad66d2ca"
            ]
        ]
    },
    {
        "id": "8e7df44115a60b5e",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "study",
                "pt": "msg",
                "to": "payload.data[0]",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2080,
        "y": 2020,
        "wires": [
            [
                "9304d4da4efa5f6c",
                "bdf4c22bb3725613"
            ]
        ]
    },
    {
        "id": "9304d4da4efa5f6c",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "23b14172f95f39ef",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2590,
        "y": 2020,
        "wires": []
    },
    {
        "id": "8dd59e74376d6937",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "3b0d3c603c0d1fd6",
        "name": "",
        "property": "lead_country_string",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nempty"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1510,
        "y": 3360,
        "wires": [
            [
                "0571712f078a2137"
            ],
            [
                "80c81f840d3d8bf8"
            ]
        ]
    },
    {
        "id": "eece97d5539892a0",
        "type": "link in",
        "z": "2c4527dad914ec1c",
        "g": "fa41432bb855af38",
        "name": "To create Application",
        "links": [],
        "x": 1275,
        "y": 1020,
        "wires": [
            [
                "877d493c814eb116"
            ]
        ]
    },
    {
        "id": "0e57f11a59848a31",
        "type": "link in",
        "z": "2c4527dad914ec1c",
        "g": "a7a8a74946229b91",
        "name": "link in 9",
        "links": [
            "9a87a1f173d5e53f"
        ],
        "x": 2305,
        "y": 880,
        "wires": [
            [
                "b3626201f7983f76"
            ]
        ]
    },
    {
        "id": "eefb2eeedd415df4",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "a7a8a74946229b91",
        "name": "debug 388",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2610,
        "y": 740,
        "wires": []
    },
    {
        "id": "09d4586254506745",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "parse Application",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "applications",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3190,
        "y": 2060,
        "wires": [
            [
                "b9ecf6ddd77ad675"
            ]
        ]
    },
    {
        "id": "b9ecf6ddd77ad675",
        "type": "split",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "for each Application",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 3430,
        "y": 2060,
        "wires": [
            [
                "867650c5b98c06c8"
            ]
        ]
    },
    {
        "id": "867650c5b98c06c8",
        "type": "json",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "json to object",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 3670,
        "y": 2060,
        "wires": [
            [
                "119a9f972c38c24a"
            ]
        ]
    },
    {
        "id": "a2813cb05abc95ed",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "applications",
                "pt": "msg",
                "to": "payload",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3200,
        "y": 2120,
        "wires": [
            [
                "b89f95ec9abb8084"
            ]
        ]
    },
    {
        "id": "119a9f972c38c24a",
        "type": "join",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "",
        "mode": "auto",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": true,
        "timeout": "",
        "count": "",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 3850,
        "y": 2060,
        "wires": [
            [
                "a2813cb05abc95ed"
            ]
        ]
    },
    {
        "id": "c5fde75660caf0e0",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "eb7523f05c7170f0",
        "name": "query applications",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select application__v from submission__v where id in (select submission__rim from event_submissions__rimr where event__rim='\" & event_id & \"')\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3170,
        "y": 1780,
        "wires": [
            [
                "8ea7bea18c3a37ec"
            ]
        ]
    },
    {
        "id": "8ea7bea18c3a37ec",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "eb7523f05c7170f0",
        "name": "",
        "x": 3450,
        "y": 1780,
        "wires": [
            [
                "3e3267b7bf950552"
            ],
            [
                "0acb4f725a0b3b4d"
            ]
        ]
    },
    {
        "id": "3e3267b7bf950552",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "eb7523f05c7170f0",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "applications",
                "pt": "msg",
                "to": "applications\t~> $filter(function($v){$not($v.id in payload.data.application__v)})",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3660,
        "y": 1780,
        "wires": [
            [
                "8f6dbe66602cd363",
                "3575399d43c70958"
            ]
        ]
    },
    {
        "id": "8f6dbe66602cd363",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "eb7523f05c7170f0",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3850,
        "y": 1780,
        "wires": []
    },
    {
        "id": "9bf734a0d565b0b0",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "",
        "property": "job.job_type",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "1",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "2",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 3150,
        "y": 2180,
        "wires": [
            [
                "d8d634dbb1feb7f0"
            ],
            [
                "bfecddb23cb14652"
            ]
        ]
    },
    {
        "id": "bfecddb23cb14652",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "4a932e6034254d18",
        "name": "query event",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, event_description__c, (select id, impd_version_nonquality_part__c, impd_version_quality_part__c, protocol_version__c, ib_version__c from event_clinical_studies__vr) from event__rim where id='\" & event_id & \"'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3410,
        "y": 2180,
        "wires": [
            [
                "2a00af4ef68684ee",
                "7827ec475b7c8da5"
            ]
        ]
    },
    {
        "id": "8de992bdd38f4d75",
        "type": "http response",
        "z": "2c4527dad914ec1c",
        "g": "2258a8ecc4d06406",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 3990,
        "y": 1220,
        "wires": []
    },
    {
        "id": "ea2ff3f91e64e1c8",
        "type": "brave-input-form",
        "z": "2c4527dad914ec1c",
        "g": "2258a8ecc4d06406",
        "name": "",
        "x": 3770,
        "y": 1220,
        "wires": [
            [
                "8de992bdd38f4d75"
            ]
        ]
    },
    {
        "id": "322b77670ebfbc73",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "2258a8ecc4d06406",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3990,
        "y": 1260,
        "wires": []
    },
    {
        "id": "6dae2eeabda1866b",
        "type": "http in",
        "z": "2c4527dad914ec1c",
        "g": "2258a8ecc4d06406",
        "name": "",
        "url": "/cta/ro_type",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 3190,
        "y": 1100,
        "wires": [
            [
                "d4315b2a2c87f603",
                "35a584fdbbbf184c"
            ]
        ]
    },
    {
        "id": "e18582e1e6af8a27",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "2258a8ecc4d06406",
        "name": "set fields for input form",
        "rules": [
            {
                "t": "set",
                "p": "title",
                "pt": "msg",
                "to": "Please define the Regulatory Objective Type",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "type",
                "pt": "msg",
                "to": "radio",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "description",
                "pt": "msg",
                "to": "\"for Study \" & study.name__v & \" \" & study.study_alias__c",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "tableheader",
                "pt": "msg",
                "to": "{\"columns\":[\"Type\",\"Applicable region\"]}",
                "tot": "json"
            },
            {
                "t": "set",
                "p": "dataarray",
                "pt": "msg",
                "to": "RO_type.{\t   \"selection\": $string(),\t   \"columns\": [\t       Type,\t       Region\t   ]\t}",
                "tot": "jsonata",
                "dc": true
            },
            {
                "t": "set",
                "p": "flow",
                "pt": "msg",
                "to": "nodes/cta/app_for_records",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "hiddenfields",
                "pt": "msg",
                "to": "[\t   {\t       \"name\": \"study_id\",\t       \"value\": study_id\t    },\t    {\t       \"name\": \"lead_country\",\t       \"value\": $string(lead_country)\t    },\t    {\t        \"name\": \"job_type\",\t        \"value\": job.job_type\t    },\t    {\t        \"name\": \"job_scope\",\t        \"value\": job.job_scope\t    },\t    {\t        \"name\": \"created_event_id\",\t        \"value\": created_event_id\t    },\t    {\t        \"name\": \"created_application_ids\",\t        \"value\": created_application_ids\t    },\t    {\t        \"name\": \"event_id\",\t        \"value\": event_id\t    }\t\t]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3460,
        "y": 1220,
        "wires": [
            [
                "ea2ff3f91e64e1c8",
                "322b77670ebfbc73"
            ]
        ]
    },
    {
        "id": "35a584fdbbbf184c",
        "type": "json",
        "z": "2c4527dad914ec1c",
        "g": "2258a8ecc4d06406",
        "name": "resp_full",
        "property": "payload.response_full",
        "action": "obj",
        "pretty": false,
        "x": 3580,
        "y": 1100,
        "wires": [
            [
                "bdd066564c6ce95f"
            ]
        ]
    },
    {
        "id": "bdd066564c6ce95f",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "2258a8ecc4d06406",
        "name": "Store parameters",
        "rules": [
            {
                "t": "set",
                "p": "study_id",
                "pt": "msg",
                "to": "payload.study_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "client_id",
                "pt": "msg",
                "to": "cta-automation",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "event_id",
                "pt": "msg",
                "to": "payload.event_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "job.job_type",
                "pt": "msg",
                "to": "payload.job_type",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "job.job_scope",
                "pt": "msg",
                "to": "payload.job_scope",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "event",
                "pt": "msg",
                "to": "payload.response_full[0]",
                "tot": "jsonata",
                "dc": true
            },
            {
                "t": "set",
                "p": "created_event_id",
                "pt": "msg",
                "to": "payload.created_event_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "created_application_ids",
                "pt": "msg",
                "to": "payload.created_application_ids",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3790,
        "y": 1100,
        "wires": [
            [
                "48df2f80a99d8b29"
            ]
        ]
    },
    {
        "id": "48df2f80a99d8b29",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "2258a8ecc4d06406",
        "name": "parse Event",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "event",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 4010,
        "y": 1100,
        "wires": [
            [
                "4034cdfe618d83a5"
            ]
        ]
    },
    {
        "id": "4034cdfe618d83a5",
        "type": "split",
        "z": "2c4527dad914ec1c",
        "g": "2258a8ecc4d06406",
        "name": "Event",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 3570,
        "y": 1160,
        "wires": [
            [
                "627236e68743463c"
            ]
        ]
    },
    {
        "id": "627236e68743463c",
        "type": "json",
        "z": "2c4527dad914ec1c",
        "g": "2258a8ecc4d06406",
        "name": "json to object",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 3770,
        "y": 1160,
        "wires": [
            [
                "e7d6e3c82350409a"
            ]
        ]
    },
    {
        "id": "e7d6e3c82350409a",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "2258a8ecc4d06406",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "event",
                "pt": "msg",
                "to": "payload",
                "tot": "msg",
                "dc": true
            },
            {
                "t": "set",
                "p": "event_id",
                "pt": "msg",
                "to": "payload.event_id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 4020,
        "y": 1160,
        "wires": [
            [
                "364df53d72877480"
            ]
        ]
    },
    {
        "id": "6f594307a0362067",
        "type": "json",
        "z": "2c4527dad914ec1c",
        "g": "eb7523f05c7170f0",
        "name": "resp_full",
        "property": "payload.response_full",
        "action": "obj",
        "pretty": false,
        "x": 3440,
        "y": 1400,
        "wires": [
            [
                "d224372d0f77adba"
            ]
        ]
    },
    {
        "id": "d224372d0f77adba",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "eb7523f05c7170f0",
        "name": "store parameters",
        "rules": [
            {
                "t": "set",
                "p": "study_id",
                "pt": "msg",
                "to": "payload.study_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "created_application_ids",
                "pt": "msg",
                "to": "payload.created_application_ids",
                "tot": "msg",
                "dc": true
            },
            {
                "t": "set",
                "p": "created_event_id",
                "pt": "msg",
                "to": "payload.created_event_id",
                "tot": "msg",
                "dc": true
            },
            {
                "t": "set",
                "p": "client_id",
                "pt": "msg",
                "to": "cta-automation",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "event_id",
                "pt": "msg",
                "to": "$filter (payload.event_id, function ($v) { $v != \"\" })",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "job.job_scope",
                "pt": "msg",
                "to": "payload.job_scope",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "job.job_type",
                "pt": "msg",
                "to": "payload.job_type",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "ro_type",
                "pt": "msg",
                "to": "payload.response_full[]",
                "tot": "jsonata",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3670,
        "y": 1400,
        "wires": [
            [
                "9e24def7b8e1ed20"
            ]
        ]
    },
    {
        "id": "9e24def7b8e1ed20",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "eb7523f05c7170f0",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "ro_type",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3880,
        "y": 1400,
        "wires": [
            [
                "56bb3f2ede4357d3"
            ]
        ]
    },
    {
        "id": "56bb3f2ede4357d3",
        "type": "split",
        "z": "2c4527dad914ec1c",
        "g": "eb7523f05c7170f0",
        "name": "for RO Type",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 3150,
        "y": 1460,
        "wires": [
            [
                "63b1e190539c60d6"
            ]
        ]
    },
    {
        "id": "63b1e190539c60d6",
        "type": "json",
        "z": "2c4527dad914ec1c",
        "g": "eb7523f05c7170f0",
        "name": "json to object",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 3330,
        "y": 1460,
        "wires": [
            [
                "2d30c1a1b88ffd77"
            ]
        ]
    },
    {
        "id": "2d30c1a1b88ffd77",
        "type": "join",
        "z": "2c4527dad914ec1c",
        "g": "eb7523f05c7170f0",
        "name": "",
        "mode": "auto",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": true,
        "timeout": "",
        "count": "",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 3510,
        "y": 1460,
        "wires": [
            [
                "9e67043bce8e07ce"
            ]
        ]
    },
    {
        "id": "9e67043bce8e07ce",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "eb7523f05c7170f0",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "ro_type",
                "pt": "msg",
                "to": "payload[0].ID",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "ro_region",
                "pt": "msg",
                "to": "payload[0].Region",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3680,
        "y": 1460,
        "wires": [
            [
                "b29bd3b6b73fa3f4"
            ]
        ]
    },
    {
        "id": "6e441cc056e5c53b",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "cf3f4fcb8dc2573a",
        "name": "Set the result page",
        "rules": [
            {
                "t": "set",
                "p": "applications",
                "pt": "msg",
                "to": "$append(ctrapplications,applications)",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "ros",
                "pt": "msg",
                "to": "$append(ctrros,ros)",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "submissions",
                "pt": "msg",
                "to": "$append(ctrsubmissions,submissions)",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "title",
                "pt": "msg",
                "to": "The operation was successful",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "description",
                "pt": "msg",
                "to": "\"<h5>The following Vault objects are now available for study \" & \"<a href=\\\"https://\" & req.cookies.vault_domain & \"/ui/#t/0TB000000000B26/0CT/\" & study_id & \"\\\" target=\\\"_blank\\\"\"&\"\\\">\" & study.name__v & \"</a><br><br></h5> It would take a while for the Submission Content Plan to be created and there would be a BRAVE notification after the completion.\"",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "unescaped",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "httpcalls",
                "pt": "msg",
                "to": "3",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "dataarray",
                "pt": "msg",
                "to": "[\t    {\t       \"selection\": created_event,\t       \"columns\": [\t           \"Event\",\t           \"<a href=\\\"https://\" & req.cookies.vault_domain & \"/ui/#t/0TB000000000B03/A0Z/\" &\t          created_event.id & \"\\\" target=\\\"_blank\\\"\"&\"\\\">\"& created_event.name__v & \"</a>\"\t        ]\t    },\t    created_applications@$vl. {\t        \"selection\": \"n/a\",\t         \"columns\": [\t            \"Application\",\t            \"<a href=\\\"https://\" & req.cookies.vault_domain & \"/ui/#t/0TB000000000B21/00A/\" & $vl.id & \"\\\" target=\\\"_blank\\\"\"&\"\\\">\"& $vl.name__v & \"</a>\"\t        ]\t    },\t    ros@$vl. {\t        \"selection\": \"n/a\",\t         \"columns\": [\t            \"Regulatory Objective\",\t            \"<a href=\\\"https://\" & req.cookies.vault_domain & \"/ui/#t/0TB000000000K01/OBH/\" & $vl.id & \"\\\" target=\\\"_blank\\\"\"&\"\\\">\"& $vl.name__v & \"</a>\"\t        ]\t    },\t    submissions@$vl. {\t        \"selection\": \"n/a\",\t         \"columns\": [\t            \"Submission\",\t            \"<a href=\\\"https://\" & req.cookies.vault_domain & \"/ui/#t/0TB000000000B22/00S/\" & $vl.id & \"\\\" target=\\\"_blank\\\"\"&\"\\\">\"& $vl.name__v & \"</a>\"\t        ]\t    }\t]\t\t",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "tableheader",
                "pt": "msg",
                "to": "{\t   \"columns\": \t    [\t        \"Type\",\t        \"Name\"\t    ]\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "flow",
                "pt": "msg",
                "to": "nodes/cta",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3850,
        "y": 560,
        "wires": [
            [
                "c65594f62b66ba6c",
                "dc179569b9799870"
            ]
        ]
    },
    {
        "id": "c3df4ccf459db19f",
        "type": "link in",
        "z": "2c4527dad914ec1c",
        "g": "cf3f4fcb8dc2573a",
        "name": "link in 10",
        "links": [
            "1ad0402c6eac4a81",
            "8bda251317c47732"
        ],
        "x": 3045,
        "y": 440,
        "wires": [
            [
                "3875450d706f6724"
            ]
        ]
    },
    {
        "id": "e3f83d8d0cbdf4a4",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "cf3f4fcb8dc2573a",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "query_ids",
                "pt": "msg",
                "to": "created_application_ids ~> $map(function($v) {\"id='\" & $v & \"'\"}) ~> $join(\" OR \")",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3370,
        "y": 440,
        "wires": [
            [
                "82a34d65142c7d1e",
                "e0c1393bdfa1865e"
            ]
        ]
    },
    {
        "id": "e0c1393bdfa1865e",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "cf3f4fcb8dc2573a",
        "name": "query created applications",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v from application__v where \" & query_ids",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3600,
        "y": 440,
        "wires": [
            [
                "908a3e8352298a3f",
                "25277f4f1f618498"
            ]
        ]
    },
    {
        "id": "908a3e8352298a3f",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "cf3f4fcb8dc2573a",
        "name": "",
        "x": 3820,
        "y": 440,
        "wires": [
            [
                "8a97172448094a63"
            ],
            [
                "e2bbf68093902dd8"
            ]
        ]
    },
    {
        "id": "8a97172448094a63",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "cf3f4fcb8dc2573a",
        "name": "store result",
        "rules": [
            {
                "t": "set",
                "p": "created_applications",
                "pt": "msg",
                "to": "payload.data",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 4000,
        "y": 440,
        "wires": [
            [
                "e465505a38c646ab",
                "f913b67552863c67"
            ]
        ]
    },
    {
        "id": "dd8e0450df6db078",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "cf3f4fcb8dc2573a",
        "name": "query created event",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v from event__rim where id='\" & created_event_id & \"'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3590,
        "y": 500,
        "wires": [
            [
                "21345e0676e23ae3",
                "b286a0092acfd283"
            ]
        ]
    },
    {
        "id": "21345e0676e23ae3",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "cf3f4fcb8dc2573a",
        "name": "",
        "x": 3820,
        "y": 500,
        "wires": [
            [
                "133e012f4802a9b2"
            ],
            [
                "e2bbf68093902dd8"
            ]
        ]
    },
    {
        "id": "133e012f4802a9b2",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "cf3f4fcb8dc2573a",
        "name": "store result",
        "rules": [
            {
                "t": "set",
                "p": "created_event",
                "pt": "msg",
                "to": "payload.data",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 4000,
        "y": 500,
        "wires": [
            [
                "e4d80dada213b37f",
                "6e441cc056e5c53b"
            ]
        ]
    },
    {
        "id": "82a34d65142c7d1e",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "cf3f4fcb8dc2573a",
        "name": "debug 400",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3800,
        "y": 380,
        "wires": []
    },
    {
        "id": "25277f4f1f618498",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "cf3f4fcb8dc2573a",
        "name": "debug 401",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 4180,
        "y": 380,
        "wires": []
    },
    {
        "id": "e465505a38c646ab",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "cf3f4fcb8dc2573a",
        "name": "debug 402",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 4180,
        "y": 440,
        "wires": []
    },
    {
        "id": "e4d80dada213b37f",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "cf3f4fcb8dc2573a",
        "name": "debug 403",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 4180,
        "y": 500,
        "wires": []
    },
    {
        "id": "dc179569b9799870",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "cf3f4fcb8dc2573a",
        "name": "debug 404",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 4180,
        "y": 620,
        "wires": []
    },
    {
        "id": "b286a0092acfd283",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "cf3f4fcb8dc2573a",
        "name": "debug 405",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 4180,
        "y": 560,
        "wires": []
    },
    {
        "id": "3875450d706f6724",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "cf3f4fcb8dc2573a",
        "name": "",
        "property": "created_application_ids",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nnull"
            },
            {
                "t": "null"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 3180,
        "y": 440,
        "wires": [
            [
                "e3f83d8d0cbdf4a4"
            ],
            [
                "f913b67552863c67"
            ]
        ]
    },
    {
        "id": "f913b67552863c67",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "cf3f4fcb8dc2573a",
        "name": "",
        "property": "created_event_id",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nnull"
            },
            {
                "t": "null"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 3320,
        "y": 500,
        "wires": [
            [
                "dd8e0450df6db078"
            ],
            [
                "6e441cc056e5c53b"
            ]
        ]
    },
    {
        "id": "ca1ba41a3b00c448",
        "type": "template",
        "z": "2c4527dad914ec1c",
        "g": "0cad5663dc4721fe",
        "name": "Input Form",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "<!doctype html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"utf-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n    <title>Defining scope</title>\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css\"\n        integrity=\"sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu\" crossorigin=\"anonymous\">\n    <script src=\"https://code.jquery.com/jquery-1.12.4.min.js\"\n        integrity=\"sha384-nvAa0+6Qg9clwYCGGPpDQLVpLNn0fRaROjHqs13t4Ggj3Ez50XnGQqc/r8MhnRDZ\"\n        crossorigin=\"anonymous\"></script>\n    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js\"\n        integrity=\"sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd\"\n        crossorigin=\"anonymous\"></script>\n</head>\n\n<body>\n    <div class=\"modal fade\" id=\"modal\" tabindex=\"-1\" data-backdrop=\"static\">\n        <div class=\"modal-dialog\">\n            <div class=\"modal-content\">\n                <div class=\"modal-header\">\n                    <h4 class=\"modal-title\">Processing ...</h4>\n                </div>\n                <div class=\"modal-body\">\n                    <p>Please wait while the changes are applied.</p>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"container\">\n        <h1>Records would be created for the Event {{created_event.name__v}}</h1>\n        <p> </p>\n        <br>\n        <form class=\"form-horizontal\" method=\"post\" action=\"/nodes/cta/ro_type\">\n            <input type=\"hidden\" name=\"study_id\" value=\"{{study_id}}\">\n            <input type=\"hidden\" name=\"job_type\" value=\"{{job.job_type}}\">\n            <input type=\"hidden\" name=\"job_scope\" value=\"{{job.job_scope}}\">\n            <input type=\"hidden\" name=\"created_event\" value=\"{{created_event}}\">\n            <input type=\"hidden\" name=\"created_application_ids\" value=\"{{created_application_ids}}\">\n\n            <div class=\"form-group\">\n                <div class=\"col-md-offset-4 col-md-8\">\n                    <button type=\"submit\" class=\"btn btn-primary\">Yes</button>\n                </div>\n            </div>\n        </form>\n    </div>\n\n    <script>\n        $(document).ready(function(){\n            $(\"form\").submit(function() {\n                $(\"#modal\").modal(\"show\");\n            });\n        });\n    </script>\n</body>\n\n</html>",
        "output": "str",
        "x": 3890,
        "y": 980,
        "wires": [
            [
                "35bf7c98624a0247"
            ]
        ]
    },
    {
        "id": "35bf7c98624a0247",
        "type": "http response",
        "z": "2c4527dad914ec1c",
        "g": "0cad5663dc4721fe",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 4070,
        "y": 980,
        "wires": []
    },
    {
        "id": "8bda251317c47732",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "a7a8a74946229b91",
        "name": "link out 19",
        "mode": "link",
        "links": [
            "c3df4ccf459db19f"
        ],
        "x": 2925,
        "y": 860,
        "wires": []
    },
    {
        "id": "28d47a2b92d9acde",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "0cad5663dc4721fe",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "created_event",
                "pt": "msg",
                "to": "payload.data[0]",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3700,
        "y": 980,
        "wires": [
            [
                "ca1ba41a3b00c448"
            ]
        ]
    },
    {
        "id": "787961bfe48f9c3f",
        "type": "template",
        "z": "2c4527dad914ec1c",
        "g": "e1b7d81d3cd06a62",
        "name": "Input Form",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "<!doctype html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"utf-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n    <title>New Clinical Study Event</title>\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css\"\n        integrity=\"sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu\" crossorigin=\"anonymous\">\n    <script src=\"https://code.jquery.com/jquery-1.12.4.min.js\"\n        integrity=\"sha384-nvAa0+6Qg9clwYCGGPpDQLVpLNn0fRaROjHqs13t4Ggj3Ez50XnGQqc/r8MhnRDZ\"\n        crossorigin=\"anonymous\"></script>\n    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js\"\n        integrity=\"sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd\"\n        crossorigin=\"anonymous\"></script>\n</head>\n\n<body>\n    <div class=\"modal fade\" id=\"modal\" tabindex=\"-1\" data-backdrop=\"static\">\n        <div class=\"modal-dialog\">\n            <div class=\"modal-content\">\n                <div class=\"modal-header\">\n                    <h4 class=\"modal-title\">Processing ...</h4>\n                </div>\n                <div class=\"modal-body\">\n                    <p>Please wait while the changes are applied.</p>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"container\">\n        <h1>New Event for Clinical Study {{study.name__v}}</h1>\n        <p>Please provide details for the new Clinical Study Event.</p>\n        <br>\n        <form class=\"form-horizontal\" method=\"post\" action=\"/nodes/cta/amend_event\">\n            <input type=\"hidden\" name=\"study_id\" value=\"{{study_id}}\">\n            <input type=\"hidden\" name=\"job_scope\" value=\"{{job.job_scope}}\">\n            <input type=\"hidden\" name=\"job_type\" value=\"{{job.job_type}}\">\n            <input type=\"hidden\" name=\"event_keywords_name\" value=\"{{event_keywords_name}}\">\n            \n            <div class=\"form-group\">\n                <label class=\"col-md-4 control-label\" for=\"impd_version_quality_part__c\">IMPD Version Quality Part\n                    Provided</label>\n                <div class=\"col-md-8\">\n                    <input type=\"text\" class=\"form-control\" id=\"impd_version_quality_part__c\"\n                        name=\"impd_version_quality_part__c\">\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label class=\"col-md-4 control-label\" for=\"impd_version_nonquality_part__c\">IMPD Version non- Quality\n                    Part Provided</label>\n                <div class=\"col-md-8\">\n                    <input type=\"text\" class=\"form-control\" id=\"impd_version_nonquality_part__c\"\n                        name=\"impd_version_nonquality_part__c\">\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label class=\"col-md-4 control-label\" for=\"protocol_version__c\">Protocol Version Provided</label>\n                <div class=\"col-md-8\">\n                    <input type=\"text\" class=\"form-control\" id=\"protocol_version__c\" name=\"protocol_version__c\">\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label class=\"col-md-4 control-label\" for=\"ib_version__c\">IB Version Provided</label>\n                <div class=\"col-md-8\">\n                    <input type=\"text\" class=\"form-control\" id=\"ib_version__c\" name=\"ib_version__c\">\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label class=\"col-md-4 control-label\" for=\"shelf_life\">Shelf Life</label>\n                <div class=\"col-md-8\">\n                    <input type=\"text\" class=\"form-control\" id=\"shelf_life\" name=\"shelf_life\">\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label class=\"col-md-4 control-label\" for=\"event_description__c\">Event Desciption</label>\n                <div class=\"col-md-8\">\n                    <input type=\"text\" class=\"form-control\" id=\"event_description__c\" name=\"event_description__c\">\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <div class=\"col-md-offset-4 col-md-8\">\n                    <button type=\"submit\" class=\"btn btn-primary\">Create Clinical Study Event</button>\n                </div>\n            </div>\n        </form>\n    </div>\n\n    <script>\n        $(document).ready(function(){\n            $(\"form\").submit(function() {\n                $(\"#modal\").modal(\"show\");\n            });\n        });\n    </script>\n</body>\n\n</html>",
        "output": "str",
        "x": 750,
        "y": 2540,
        "wires": [
            [
                "5ec534431ecdbbc3"
            ]
        ]
    },
    {
        "id": "5ec534431ecdbbc3",
        "type": "http response",
        "z": "2c4527dad914ec1c",
        "g": "e1b7d81d3cd06a62",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 930,
        "y": 2540,
        "wires": []
    },
    {
        "id": "6d77e6da0d189a2f",
        "type": "http in",
        "z": "2c4527dad914ec1c",
        "g": "e1b7d81d3cd06a62",
        "name": "",
        "url": "cta/event_info",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 180,
        "y": 2480,
        "wires": [
            [
                "9c10197129e36e22"
            ]
        ]
    },
    {
        "id": "83bfb2c8803ef98a",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "e1b7d81d3cd06a62",
        "name": "store parameters",
        "rules": [
            {
                "t": "set",
                "p": "study_id",
                "pt": "msg",
                "to": "payload.study_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "params",
                "pt": "msg",
                "to": "payload",
                "tot": "msg",
                "dc": true
            },
            {
                "t": "set",
                "p": "job.job_scope",
                "pt": "msg",
                "to": "payload.job_scope",
                "tot": "msg",
                "dc": true
            },
            {
                "t": "set",
                "p": "job.job_type",
                "pt": "msg",
                "to": "payload.job_type",
                "tot": "msg",
                "dc": true
            },
            {
                "t": "set",
                "p": "event_keywords_string",
                "pt": "msg",
                "to": "payload.response_full",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 570,
        "y": 2480,
        "wires": [
            [
                "1c245cad2a9ec068",
                "aec7dcad5b069c99"
            ]
        ]
    },
    {
        "id": "1c245cad2a9ec068",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "e1b7d81d3cd06a62",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "event_keywords_string",
                "tot": "msg",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 760,
        "y": 2480,
        "wires": [
            [
                "23fa5da47fb79950"
            ]
        ]
    },
    {
        "id": "23fa5da47fb79950",
        "type": "split",
        "z": "2c4527dad914ec1c",
        "g": "e1b7d81d3cd06a62",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 930,
        "y": 2480,
        "wires": [
            [
                "b05a3d51f61273c5"
            ]
        ]
    },
    {
        "id": "b05a3d51f61273c5",
        "type": "json",
        "z": "2c4527dad914ec1c",
        "g": "e1b7d81d3cd06a62",
        "name": "json to object",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 190,
        "y": 2540,
        "wires": [
            [
                "fede6ae32eca8534"
            ]
        ]
    },
    {
        "id": "fede6ae32eca8534",
        "type": "join",
        "z": "2c4527dad914ec1c",
        "g": "e1b7d81d3cd06a62",
        "name": "",
        "mode": "auto",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": true,
        "timeout": "",
        "count": "",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 350,
        "y": 2540,
        "wires": [
            [
                "0eab635811c284a9"
            ]
        ]
    },
    {
        "id": "0eab635811c284a9",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "e1b7d81d3cd06a62",
        "name": "Event Keyword to string",
        "rules": [
            {
                "t": "set",
                "p": "event_keywords_name",
                "pt": "msg",
                "to": "payload.Name ~>\t$reduce(function($i,$j){$i & \",\" & $j})",
                "tot": "jsonata",
                "dc": true
            },
            {
                "t": "set",
                "p": "event_keywords_title",
                "pt": "msg",
                "to": "payload.Title ~>\t$reduce(function($i,$j){$i & \",\" & $j})",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 550,
        "y": 2540,
        "wires": [
            [
                "787961bfe48f9c3f",
                "2d6057ae01606945"
            ]
        ]
    },
    {
        "id": "0acb4f725a0b3b4d",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "eb7523f05c7170f0",
        "name": "",
        "mode": "link",
        "links": [
            "0b4394d395558302"
        ],
        "x": 3995,
        "y": 1780,
        "wires": []
    },
    {
        "id": "e2bbf68093902dd8",
        "type": "link out",
        "z": "2c4527dad914ec1c",
        "g": "0cad5663dc4721fe",
        "name": "",
        "mode": "link",
        "links": [
            "0b4394d395558302"
        ],
        "x": 3545,
        "y": 920,
        "wires": []
    },
    {
        "id": "a40d8680471a2479",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "2258a8ecc4d06406",
        "name": "",
        "property": "payload.created_event_id",
        "propertyType": "msg",
        "rules": [
            {
                "t": "null"
            },
            {
                "t": "nnull"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 3350,
        "y": 1160,
        "wires": [
            [
                "35a584fdbbbf184c"
            ],
            [
                "5d06a3bf7e00b740"
            ]
        ]
    },
    {
        "id": "5d06a3bf7e00b740",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "2258a8ecc4d06406",
        "name": "Store parameters",
        "rules": [
            {
                "t": "set",
                "p": "study_id",
                "pt": "msg",
                "to": "payload.study_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "client_id",
                "pt": "msg",
                "to": "cta-automation",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "event_id",
                "pt": "msg",
                "to": "payload.created_event_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "job.job_type",
                "pt": "msg",
                "to": "payload.job_type",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "job.job_scope",
                "pt": "msg",
                "to": "payload.job_scope",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "created_event",
                "pt": "msg",
                "to": "payload.created_event",
                "tot": "msg",
                "dc": true
            },
            {
                "t": "set",
                "p": "created_application_ids",
                "pt": "msg",
                "to": "payload.created_application_ids",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "created_event_id",
                "pt": "msg",
                "to": "payload.created_event_id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3170,
        "y": 1220,
        "wires": [
            [
                "e18582e1e6af8a27",
                "015ffbdc35752fd2"
            ]
        ]
    },
    {
        "id": "015ffbdc35752fd2",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "2258a8ecc4d06406",
        "name": "debug 406",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3250,
        "y": 1260,
        "wires": []
    },
    {
        "id": "d4315b2a2c87f603",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "2258a8ecc4d06406",
        "name": "debug 407",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3190,
        "y": 1140,
        "wires": []
    },
    {
        "id": "aec7dcad5b069c99",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "025d03bac4a1308c",
        "name": "debug 408",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 970,
        "y": 2380,
        "wires": []
    },
    {
        "id": "2d6057ae01606945",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "025d03bac4a1308c",
        "name": "debug 409",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1030,
        "y": 2340,
        "wires": []
    },
    {
        "id": "9c10197129e36e22",
        "type": "json",
        "z": "2c4527dad914ec1c",
        "g": "e1b7d81d3cd06a62",
        "name": "resp_full",
        "property": "payload.response_full",
        "action": "obj",
        "pretty": false,
        "x": 380,
        "y": 2480,
        "wires": [
            [
                "83bfb2c8803ef98a"
            ]
        ]
    },
    {
        "id": "de5518a5c2dcf534",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "1adf9a7b09d9ec3e",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1890,
        "y": 560,
        "wires": []
    },
    {
        "id": "ad3d43f8c209bac3",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "1adf9a7b09d9ec3e",
        "name": "more than one Project",
        "rules": [
            {
                "t": "set",
                "p": "description",
                "pt": "msg",
                "to": "\"Study \" & study.name__v & \" \" & study.study_alias__c & \" is invalid.\"",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload.errors",
                "pt": "msg",
                "to": "[{\"type\":\"Inconsistent Data\",\"message\":\"There are more than one Project connected with the study\"}]",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1680,
        "y": 560,
        "wires": [
            [
                "de5518a5c2dcf534",
                "d1295ce2fe20155c"
            ]
        ]
    },
    {
        "id": "70be352a47eee3c5",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "0cad5663dc4721fe",
        "name": "If any event exists",
        "property": "$count(payload.data)!=0",
        "propertyType": "jsonata",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 3710,
        "y": 800,
        "wires": [
            [
                "8985a769a95830ae"
            ],
            [
                "6134dde92e85f832"
            ]
        ]
    },
    {
        "id": "6134dde92e85f832",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "0cad5663dc4721fe",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload.errors",
                "pt": "msg",
                "to": "[\t   {\t       \"type\":\"Incomplete Data\",\t       \"message\":\"The study has no existing Event. Please confirm.\"\t   }\t]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3920,
        "y": 860,
        "wires": [
            [
                "e2bbf68093902dd8"
            ]
        ]
    },
    {
        "id": "6e512e1221e08cb3",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "0cad5663dc4721fe",
        "name": "",
        "property": "job.job_type",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "2",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "1",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 3190,
        "y": 800,
        "wires": [
            [
                "0181e70f2a18599b"
            ],
            [
                "55f7361f6ff3d3c0"
            ]
        ]
    },
    {
        "id": "55f7361f6ff3d3c0",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "0cad5663dc4721fe",
        "name": "query event",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, brave_event_code__cr.name__v, event_description__c, keywords__c from event__rim where object_type__vr.api_name__v = 'clinical_study_event__c' and applicable_product_type__v = 'drug__v'and keywords__c = 'clinical_initial_cta__c' and id in (select id from event_clinical_studies__vr where clinical_study__v='\" & study_id & \"')\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3350,
        "y": 820,
        "wires": [
            [
                "6d26ea123b445cc9"
            ]
        ]
    },
    {
        "id": "368a237cb3da03f4",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "eb7523f05c7170f0",
        "name": "check RO Type region",
        "property": "ro_region",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "EU",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Non-EU",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Japan",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "United States",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "All Regions",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 5,
        "x": 3180,
        "y": 1560,
        "wires": [
            [
                "f7b29bb7055e0a74"
            ],
            [
                "f2ae517ed12d39ef"
            ],
            [
                "a1ea860eacff14bf"
            ],
            [
                "6b4365514871b2fa"
            ],
            [
                "acbf802c7351198d"
            ]
        ]
    },
    {
        "id": "f7b29bb7055e0a74",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "eb7523f05c7170f0",
        "name": "app filter - EU",
        "rules": [
            {
                "t": "set",
                "p": "app_filter",
                "pt": "msg",
                "to": "lead_market__rimr.region__v='00R000000000102'",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3440,
        "y": 1500,
        "wires": [
            [
                "6ee4c82e5bbdfb64"
            ]
        ]
    },
    {
        "id": "f2ae517ed12d39ef",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "eb7523f05c7170f0",
        "name": "app filter - Non-EU",
        "rules": [
            {
                "t": "set",
                "p": "app_filter",
                "pt": "msg",
                "to": "lead_market__rimr.region__v!='00R000000000102'",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3450,
        "y": 1540,
        "wires": [
            [
                "6ee4c82e5bbdfb64"
            ]
        ]
    },
    {
        "id": "6b4365514871b2fa",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "eb7523f05c7170f0",
        "name": "app filter - US",
        "rules": [
            {
                "t": "set",
                "p": "app_filter",
                "pt": "msg",
                "to": "lead_market__rim='00C000000000752'",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3440,
        "y": 1620,
        "wires": [
            [
                "6ee4c82e5bbdfb64"
            ]
        ]
    },
    {
        "id": "a1ea860eacff14bf",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "eb7523f05c7170f0",
        "name": "app filter - JP",
        "rules": [
            {
                "t": "set",
                "p": "app_filter",
                "pt": "msg",
                "to": "lead_market__rim=' 00C000000000808'",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3430,
        "y": 1580,
        "wires": [
            [
                "6ee4c82e5bbdfb64"
            ]
        ]
    },
    {
        "id": "752081a41b761d79",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "0cad5663dc4721fe",
        "name": "",
        "x": 3490,
        "y": 980,
        "wires": [
            [
                "28d47a2b92d9acde"
            ],
            [
                "e2bbf68093902dd8"
            ]
        ]
    },
    {
        "id": "c20f0786cf488681",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "0cad5663dc4721fe",
        "name": "query event",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"select id, name__v, brave_event_code__cr.name__v, event_description__c, keywords__c from event__rim where id='\" & created_event_id & \"'\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3310,
        "y": 980,
        "wires": [
            [
                "752081a41b761d79"
            ]
        ]
    },
    {
        "id": "bc4bea3fd22cd07b",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "5e4f497cc3eacc9e",
        "name": "Dispatch content plan",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "vault_api & \"v22.2/vobjects/event__rim/\" & event_id & \"/actions/Objectlifecyclestateuseraction.event__rim.planned_state__c.dispatch_global_content_plan_useraction__c\"",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "headers",
                "pt": "msg",
                "to": "{\t   \"Authorization\": session_id,\t   \"Accept\": \"application/json\",\t   \"Content-Type\": \"application/x-www-form-urlencoded\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3200,
        "y": 3260,
        "wires": [
            [
                "a653f834e329c411"
            ]
        ]
    },
    {
        "id": "a653f834e329c411",
        "type": "http request",
        "z": "2c4527dad914ec1c",
        "g": "5e4f497cc3eacc9e",
        "name": "",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 3410,
        "y": 3260,
        "wires": [
            [
                "cb29e4ac6ff2c120",
                "85b44eefc472890b"
            ]
        ]
    },
    {
        "id": "cb29e4ac6ff2c120",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "5e4f497cc3eacc9e",
        "name": "",
        "property": "payload.responseStatus",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "SUCCESS",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 3570,
        "y": 3260,
        "wires": [
            [
                "1ad0402c6eac4a81"
            ],
            [
                "65a57ac386b4858f"
            ]
        ]
    },
    {
        "id": "65a57ac386b4858f",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "5e4f497cc3eacc9e",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload.errors",
                "pt": "msg",
                "to": "[\t   {\t       \"type\":\"Incomplete Data\",\t       \"message\":\"Unable to create Submission Content Plan\"\t   }\t]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3760,
        "y": 3280,
        "wires": [
            [
                "275cac78bf29b682"
            ]
        ]
    },
    {
        "id": "85b44eefc472890b",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "name": "debug 420",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3650,
        "y": 3380,
        "wires": []
    },
    {
        "id": "fc41e3958fc57881",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "1adf9a7b09d9ec3e",
        "name": "debug 417",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 430,
        "y": 520,
        "wires": []
    },
    {
        "id": "117c0f6f88e040c0",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "cb0a933960ea0f9e",
        "name": "Retrieve configs in BRAVE",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t    \"settings_name\":\"cta_record_creation\",\t    \"attachment_name\":\"cta_creation_config.json\"\t}",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 260,
        "y": 3760,
        "wires": [
            [
                "ce992dda59cd12c9"
            ]
        ]
    },
    {
        "id": "1e48e22392c2fe29",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "cb0a933960ea0f9e",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "Event_Keywords",
                "pt": "msg",
                "to": "payload[0].event_keywords",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 670,
        "y": 4000,
        "wires": [
            []
        ]
    },
    {
        "id": "ce992dda59cd12c9",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "cb0a933960ea0f9e",
        "name": "get automation configuration settings object id",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"SELECT id, name__v\"\t&\" FROM automation_configuration__c\" \t&\" WHERE name__v = '\"\t& args.settings_name\t&\"' AND status__v = 'active__v'\"\t",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 320,
        "y": 3820,
        "wires": [
            [
                "8eb3b09584070d7f"
            ]
        ]
    },
    {
        "id": "a169c2eecb19ccd4",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "cb0a933960ea0f9e",
        "name": "prepare request attachments",
        "rules": [
            {
                "t": "set",
                "p": "args.object_name",
                "pt": "msg",
                "to": "automation_configuration__c",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "args.object_record_id",
                "pt": "msg",
                "to": "payload.data[0].id",
                "tot": "msg",
                "dc": true
            },
            {
                "t": "set",
                "p": "args.keep",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 260,
        "y": 3880,
        "wires": [
            [
                "64d86b206d8d30b7"
            ]
        ]
    },
    {
        "id": "3d77d5e044dee056",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "cb0a933960ea0f9e",
        "name": "Set attachments to attachment_name",
        "rules": [
            {
                "t": "set",
                "p": "args.attachment_id",
                "pt": "msg",
                "to": "payload.data[filename__v=$$.args.attachment_name].id",
                "tot": "jsonata",
                "dc": true
            },
            {
                "t": "set",
                "p": "args.keep",
                "pt": "msg",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 290,
        "y": 3940,
        "wires": [
            [
                "36289c1d83b7740e"
            ]
        ]
    },
    {
        "id": "8eb3b09584070d7f",
        "type": "brave-vql-query",
        "z": "2c4527dad914ec1c",
        "g": "cb0a933960ea0f9e",
        "name": "",
        "x": 630,
        "y": 3820,
        "wires": [
            [
                "a169c2eecb19ccd4"
            ],
            []
        ]
    },
    {
        "id": "64d86b206d8d30b7",
        "type": "brave-retrieve-object-record-attachments",
        "z": "2c4527dad914ec1c",
        "g": "cb0a933960ea0f9e",
        "name": "",
        "x": 700,
        "y": 3880,
        "wires": [
            [
                "3d77d5e044dee056"
            ],
            []
        ]
    },
    {
        "id": "36289c1d83b7740e",
        "type": "brave-download-object-record-attachment-file",
        "z": "2c4527dad914ec1c",
        "g": "cb0a933960ea0f9e",
        "name": "",
        "x": 720,
        "y": 3940,
        "wires": [
            [
                "6fdde1e72d7c411e"
            ],
            []
        ]
    },
    {
        "id": "6fdde1e72d7c411e",
        "type": "json",
        "z": "2c4527dad914ec1c",
        "g": "cb0a933960ea0f9e",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 190,
        "y": 4000,
        "wires": [
            [
                "1e48e22392c2fe29"
            ]
        ]
    },
    {
        "id": "2d01b3958155921c",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "RO_type",
                "pt": "msg",
                "to": "payload[0].ro_type",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 4330,
        "y": 1200,
        "wires": [
            [
                "e18582e1e6af8a27",
                "9828977331cdadbe"
            ]
        ]
    },
    {
        "id": "364df53d72877480",
        "type": "brave-login",
        "z": "2c4527dad914ec1c",
        "name": "",
        "x": 4290,
        "y": 1120,
        "wires": [
            [
                "0d1633a753414cdd"
            ],
            []
        ]
    },
    {
        "id": "3f3ba07ae696a258",
        "type": "subflow:fca036ab5aa23301",
        "z": "2c4527dad914ec1c",
        "name": "",
        "x": 470,
        "y": 2180,
        "wires": [
            [
                "eaaae11c9d0f5209"
            ],
            []
        ]
    },
    {
        "id": "eaaae11c9d0f5209",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "Event_Keywords",
                "pt": "msg",
                "to": "payload[0].event_keywords",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 190,
        "y": 2240,
        "wires": [
            [
                "82f885e754fc45bd",
                "1a580dd7501928eb"
            ]
        ]
    },
    {
        "id": "25d332512d7867b8",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "name": "Retrieve configs in BRAVE",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t    \"settings_name\":\"cta_record_creation\",\t    \"attachment_name\":\"cta_creation_config.json\"\t}",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 200,
        "y": 2180,
        "wires": [
            [
                "3f3ba07ae696a258"
            ]
        ]
    },
    {
        "id": "82f885e754fc45bd",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "name": "debug 424",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 450,
        "y": 2240,
        "wires": []
    },
    {
        "id": "816f8fd43db06c24",
        "type": "subflow:fca036ab5aa23301",
        "z": "2c4527dad914ec1c",
        "name": "",
        "x": 4630,
        "y": 1160,
        "wires": [
            [
                "2d01b3958155921c"
            ],
            []
        ]
    },
    {
        "id": "0d1633a753414cdd",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "name": "Retrieve configs in BRAVE",
        "rules": [
            {
                "t": "set",
                "p": "args",
                "pt": "msg",
                "to": "{\t    \"settings_name\":\"cta_record_creation\",\t    \"attachment_name\":\"cta_creation_config.json\"\t}",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 4360,
        "y": 1160,
        "wires": [
            [
                "816f8fd43db06c24"
            ]
        ]
    },
    {
        "id": "9828977331cdadbe",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "name": "debug 425",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 4610,
        "y": 1200,
        "wires": []
    },
    {
        "id": "a710fd5c93105bef",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "f4492470635578ae",
        "name": "rename Application",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "vault_api & \"v22.2/vobjects/application__v\"",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "headers",
                "pt": "msg",
                "to": "{\t   \"Authorization\": session_id,\t   \"Accept\": \"application/json\",\t   \"Content-Type\": \"application/json\"\t}",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "applications.{\t   \"id\": id,\t   \"name__v\": $substringBefore(name__v,\" - ##\")\t}[]",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1350,
        "y": 3020,
        "wires": [
            [
                "e1b7d959e12be6a2"
            ]
        ]
    },
    {
        "id": "e1b7d959e12be6a2",
        "type": "http request",
        "z": "2c4527dad914ec1c",
        "g": "b21a8850dadd4a12",
        "name": "",
        "method": "PUT",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 1570,
        "y": 3020,
        "wires": [
            [
                "ee0a41c3e261db60"
            ]
        ]
    },
    {
        "id": "d43cbcb95adf6c56",
        "type": "debug",
        "z": "2c4527dad914ec1c",
        "g": "f4492470635578ae",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2110,
        "y": 3020,
        "wires": []
    },
    {
        "id": "ee0a41c3e261db60",
        "type": "switch",
        "z": "2c4527dad914ec1c",
        "g": "f4492470635578ae",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "cont",
                "v": "SUCCESS",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1830,
        "y": 3020,
        "wires": [
            [
                "0e58817144b122ca",
                "d43cbcb95adf6c56"
            ],
            [
                "1f9e9253f0f4ed09"
            ]
        ]
    },
    {
        "id": "acbf802c7351198d",
        "type": "change",
        "z": "2c4527dad914ec1c",
        "g": "eb7523f05c7170f0",
        "name": "app filter - all",
        "rules": [
            {
                "t": "set",
                "p": "app_filter",
                "pt": "msg",
                "to": "lead_market__rim !=''",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3430,
        "y": 1660,
        "wires": [
            [
                "6ee4c82e5bbdfb64"
            ]
        ]
    }
]